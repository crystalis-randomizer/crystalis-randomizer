import { iters } from '../util.js';
export var ScreenFix;
(function (ScreenFix) {
    ScreenFix[ScreenFix["Unknown"] = 0] = "Unknown";
    ScreenFix[ScreenFix["GrassLongGrass"] = 1] = "GrassLongGrass";
    ScreenFix[ScreenFix["GrassLongGrassRemapping"] = 2] = "GrassLongGrassRemapping";
    ScreenFix[ScreenFix["RiverShortGrass"] = 3] = "RiverShortGrass";
    ScreenFix[ScreenFix["SeaCaveEntrance"] = 4] = "SeaCaveEntrance";
    ScreenFix[ScreenFix["SeaRocks"] = 5] = "SeaRocks";
    ScreenFix[ScreenFix["SeaMarsh"] = 6] = "SeaMarsh";
    ScreenFix[ScreenFix["SeaTrees"] = 7] = "SeaTrees";
    ScreenFix[ScreenFix["DesertShortGrass"] = 8] = "DesertShortGrass";
    ScreenFix[ScreenFix["DesertLongGrass"] = 9] = "DesertLongGrass";
    ScreenFix[ScreenFix["DesertMarsh"] = 10] = "DesertMarsh";
    ScreenFix[ScreenFix["DesertRocks"] = 11] = "DesertRocks";
    ScreenFix[ScreenFix["DesertTrees"] = 12] = "DesertTrees";
    ScreenFix[ScreenFix["DesertTownEntrance"] = 13] = "DesertTownEntrance";
    ScreenFix[ScreenFix["LabyrinthParapets"] = 14] = "LabyrinthParapets";
    ScreenFix[ScreenFix["SwampDoors"] = 15] = "SwampDoors";
    ScreenFix[ScreenFix["ExtraSpikes"] = 16] = "ExtraSpikes";
    ScreenFix[ScreenFix["CloseCaves"] = 17] = "CloseCaves";
    ScreenFix[ScreenFix["WideArenaExits"] = 18] = "WideArenaExits";
})(ScreenFix || (ScreenFix = {}));
export function withRequire(requirement, props) {
    for (const key in props) {
        props[key].requires = [requirement];
    }
    return props;
}
export function fixTilesets(rom) {
    const { desert, grass, lime, mountain, mountainRiver, river, sea, town } = rom.metatilesets;
    const $ = rom.metascreens;
    $.registerFix(ScreenFix.DesertRocks);
    desert.getTile(0x5f).copyFrom(0x5b).replaceIn($.oasisCave, $.oasisLake);
    desert.getTile(0x5a).copyFrom(0x98).setTiles([, , 0x1a, 0x18]);
    desert.getTile(0x5b).copyFrom(0x80).setTiles([0x34, 0x32, ,]);
    desert.getTile(0x5c).copyFrom(0x80).setTiles([, , 0x37, 0x35]);
    desert.getTile(0x5d).copyFrom(0x80).setTiles([, 0x37, , 0x34]);
    desert.getTile(0x5e).copyFrom(0x80).setTiles([0x35, , 0x32,]);
    $.registerFix(ScreenFix.DesertTrees);
    desert.getTile(0x63).copyFrom(0x71);
    desert.getTile(0x68).copyFrom(0x70);
    desert.getTile(0x69).copyFrom(0x60);
    desert.getTile(0x6a).copyFrom(0x65);
    desert.getTile(0x6c).copyFrom(0x70);
    desert.getTile(0x6e).copyFrom(0x76);
    desert.getTile(0x6f).copyFrom(0x78);
    $.registerFix(ScreenFix.GrassLongGrass);
    grass.getTile(0x40).copyFrom(0x51);
    grass.getTile(0x41).copyFrom(0x52);
    grass.getTile(0x42).copyFrom(0x53);
    grass.getTile(0x43).copyFrom(0x54);
    grass.getTile(0x44).copyFrom(0x55);
    grass.getTile(0x45).copyFrom(0x56);
    grass.getTile(0x46).copyFrom(0x58);
    grass.getTile(0x47).copyFrom(0x59);
    $.registerFix(ScreenFix.SeaCaveEntrance);
    sea.getTile(0xad).copyFrom(0x0a)
        .replaceIn($.beachExitN, $.lighthouseEntrance, $.oceanShrine);
    sea.getTile(0x0a).copyFrom(0xa2);
    $.boundaryN_cave.screen.set2d(0x38, [[, 0x00, 0x00],
        [, 0x0a, 0x0a],
        [, 0xf7, 0xf7],
        [0xf8, 0xf8, 0xf8, 0xf8]]);
    $.cornerSE_cave.screen.set2d(0x49, [[, 0x00, 0x00],
        [, 0x0a, 0x0a],
        [, 0xf7, 0xf7],
        [0xf8, 0xf7, 0xf7],
        [, 0xfd, 0xf7]]);
    $.cornerSE_cave.screen.set2d(0x4a, [[0x00, 0x00],
        [0x0a, 0x0a],
        [0xf7, 0xf7],
        [0xf8, 0xf7],
        [0x80, 0xfd],
        [0x80, 0xff],
        [0xfa]]);
    $.registerFix(ScreenFix.CloseCaves);
    river.getTile(0x07).copyFrom(0x01).replaceIn(...river);
    river.getTile(0x0e).copyFrom(0x02).replaceIn(...river);
    river.getTile(0x20).copyFrom(0x03).replaceIn(...river);
    river.getTile(0x21).copyFrom(0x04).replaceIn(...river);
    for (const ts of [desert, sea, mountain, mountainRiver, lime]) {
        ts.getTile(0x68).copyFrom(0x01).replaceIn(...ts);
        ts.getTile(0x83).copyFrom(0x02).replaceIn(...ts);
        ts.getTile(0x88).copyFrom(0x03).replaceIn(...ts);
        ts.getTile(0x89).copyFrom(0x04).replaceIn(...ts);
    }
    for (const ts of [town]) {
        ts.getTile(0x50).copyFrom(0x1a).replaceIn(...ts);
        ts.getTile(0x51).copyFrom(0x1b).replaceIn(...ts);
        ts.getTile(0x1a).copyFrom(0x01).replaceIn(...ts);
        ts.getTile(0x1b).copyFrom(0x02).replaceIn(...ts);
        ts.getTile(0x52).copyFrom(0x03).replaceIn(...ts);
        ts.getTile(0x57).copyFrom(0x04).replaceIn(...ts);
    }
    for (const ts of [grass, river, desert]) {
        ts.getTile(0x01).copyFrom(0xc1).setAlternative(0x00);
        ts.getTile(0x02).copyFrom(0xd7).setAlternative(0x0a);
        ts.getTile(0x03).copyFrom(0xc1).setAlternative(0x00);
        ts.getTile(0x04).copyFrom(0xd7).setAlternative(0x0a);
    }
    for (const ts of [sea]) {
        ts.getTile(0x01).copyFrom(0xc1).setAlternative(0x00);
        ts.getTile(0x02).copyFrom(0xcb).setAlternative(0x00);
        ts.getTile(0x03).copyFrom(0xc1).setAlternative(0xc0);
        ts.getTile(0x04).copyFrom(0xcb).setAlternative(0xc0);
        for (let i = 1; i < 5; i++) {
            ts.getTile(i).setTiles(grass.getTile(i).tiles);
        }
    }
    for (const ts of [town]) {
        ts.getTile(0x01).copyFrom(0x63).setAlternative(0x00);
        ts.getTile(0x02).copyFrom(0x64).setAlternative(0xd2);
        ts.getTile(0x03).copyFrom(0x63).setAlternative(0x00);
        ts.getTile(0x04).copyFrom(0x64).setAlternative(0xd2);
    }
    const closedCaves = new Set([
        $.boundaryE_cave, $.boundaryW_cave, $.exitW_cave, $.caveAbovePortoa,
        $.beachCave, $.outsideWindmill,
        $.exitS_cave, $.townExitW_cave,
        $.zombieTownBottom_caveExit,
    ]);
    const waterCaves = new Set([]);
    if ($.isFixed(ScreenFix.SeaCaveEntrance)) {
        waterCaves.add($.boundaryN_cave);
        waterCaves.add($.cornerSE_cave);
    }
    const mountainCaves = new Set([
        $.mountainDeadEndW_caveEmpty,
        $.mountainPathW_cave,
        $.mountainCave_empty,
        $.mountainPathE_cave,
        $.mountainPathN_slopeS_cave,
        $.mountainPathWE_slopeN_cave,
        $.mountainPathE_gate,
    ]);
    for (const scr of [...closedCaves, ...waterCaves]) {
        const exit = scr.data.exits.find(e => e.type === 'cave');
        const pos = Math.min(...exit.exits) - 0x10;
        const tiles = waterCaves.has(scr) ? [[3, 3], [4, 4]] : [[1, 1], [2, 2]];
        scr.screen.set2d(pos, tiles);
        scr.addCustomFlag(true);
    }
    for (const scr of [...mountainCaves]) {
        const exit = scr.data.exits.find(e => e.type === 'cave' || e.type === 'gate');
        const pos = Math.min(...exit.exits) - 0x10;
        const tiles = [[0x1a, 0x1a], [0x08, 0x09]];
        scr.screen.set2d(pos, tiles);
        scr.addCustomFlag(true);
    }
    $.outsideWindmill.screen.set2d(0x43, [[0xca, 0x82]]);
    $.townExitW_cave.screen.set2d(0x2a, [[0xca, 0x82]]);
}
export function wideArenaExits(rom) {
    var _a;
    function widen(exits) {
        exits.splice(0, exits.length, ...new Set(iters.concat(...exits.map(e => [e, e + 1, e - 1]))));
    }
    const { fortressArena_through, fortressTrap, hallNS, hallNS_arena, hallNS_arenaWall, hallNS_entrance, } = rom.metascreens;
    hallNS_arena.screen.set2d(0x04, [
        [0x97, 0x76, 0x22, 0x23, 0x23, 0x23, 0x4b, 0x95],
        [0x42, 0x48, 0x22, 0x21, 0x23, 0x23, 0x45, 0x42],
        [0x43, 0x49, 0x2e, 0x23, 0x23, 0x21, 0x46, 0x43],
        [0x44, 0x4a, 0x2e, 0x23, 0x21, 0x21, 0x47, 0x44],
    ]);
    hallNS_arena.setGridTile(' c | a | c ');
    widen(hallNS_arena.findExitByType('edge:top').exits);
    hallNS_arenaWall.screen.set2d(0x04, [
        [0x94, 0x4c, 0x22, 0x21, 0x21, 0x21, 0x4b, 0x93],
        [0x97, 0x4f, 0x00, 0x01, 0x01, 0x02, 0x50, 0x95],
    ]);
    hallNS_arenaWall.setGridTile(' c | a | c ');
    widen(hallNS_arenaWall.findExitByType('edge:top').exits);
    const abductionTrigger = rom.locations.ZebuCave.spawns.find(s => s.isTrigger() && s.id === 0x8c);
    if (abductionTrigger)
        abductionTrigger.yt += 4;
    fortressArena_through.screen.set2d(0x05, [
        [0x5f, 0x22, 0x21, 0x21, 0x21, 0x5f],
        [0xb7, 0x22, 0x21, 0x21, 0x21, 0xb5],
        [0xbf, 0x22, 0x21, 0x21, 0x21, 0xa8],
    ]);
    fortressArena_through.setGridTile(' c | a | w ');
    widen(fortressArena_through.findExitByType('edge:top').exits);
    fortressTrap.screen.set2d(0xc4, [
        [0x3c, 0x3d, 0x21, 0x21, 0x21, 0x21, 0x3b, 0x3c],
        [0x92, 0x4c, 0x22, 0x21, 0x21, 0x21, 0x4b, 0x90],
        [0x94, 0x4c, 0x22, 0x21, 0x21, 0x21, 0x4b, 0x93],
    ]);
    fortressTrap.setGridTile('   | x | c ');
    widen(fortressTrap.findExitByType('edge:bottom').exits);
    for (const location of rom.locations) {
        const meta = location.meta;
        for (const pos of meta.allPos()) {
            const scr = meta.get(pos);
            if (scr === hallNS_entrance && ((_a = meta.get(pos + 16)) === null || _a === void 0 ? void 0 : _a.hasFeature('arena'))) {
                meta.set(pos, hallNS);
                const row = location.screens[pos >>> 4];
                if (row)
                    row[pos & 0xf] = hallNS.sid;
            }
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NyZWVuZml4LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2pzL3JvbS9zY3JlZW5maXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLFlBQVksQ0FBQztBQUduQyxNQUFNLENBQU4sSUFBWSxTQStEWDtBQS9ERCxXQUFZLFNBQVM7SUFDbkIsK0NBQU8sQ0FBQTtJQUdQLDZEQUFjLENBQUE7SUFLZCwrRUFBdUIsQ0FBQTtJQUl2QiwrREFBZSxDQUFBO0lBS2YsK0RBQWUsQ0FBQTtJQU1mLGlEQUFRLENBQUE7SUFHUixpREFBUSxDQUFBO0lBSVIsaURBQVEsQ0FBQTtJQUdSLGlFQUFnQixDQUFBO0lBR2hCLCtEQUFlLENBQUE7SUFJZix3REFBVyxDQUFBO0lBR1gsd0RBQVcsQ0FBQTtJQUdYLHdEQUFXLENBQUE7SUFHWCxzRUFBa0IsQ0FBQTtJQUdsQixvRUFBaUIsQ0FBQTtJQUVqQixzREFBVSxDQUFBO0lBRVYsd0RBQVcsQ0FBQTtJQUVYLHNEQUFVLENBQUE7SUFHViw4REFBYyxDQUFBO0FBQ2hCLENBQUMsRUEvRFcsU0FBUyxLQUFULFNBQVMsUUErRHBCO0FBR0QsTUFBTSxVQUFVLFdBQVcsQ0FBaUIsV0FBc0IsRUFBRSxLQUFRO0lBQzFFLEtBQUssTUFBTSxHQUFHLElBQUksS0FBSyxFQUFFO1FBQ3ZCLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxRQUFRLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQztLQUNyQztJQUNELE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQztBQTRDRCxNQUFNLFVBQVUsV0FBVyxDQUFDLEdBQVE7SUFDbEMsTUFBTSxFQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxhQUFhLEVBQzVDLEtBQUssRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFDLEdBQUcsR0FBRyxDQUFDLFlBQVksQ0FBQztJQUM1QyxNQUFNLENBQUMsR0FBRyxHQUFHLENBQUMsV0FBVyxDQUFDO0lBSTFCLENBQUMsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ3JDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUV4RSxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLEFBQUQsRUFBRyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUMvRCxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLEFBQUQsRUFBSSxDQUFDLENBQUM7SUFDL0QsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxBQUFELEVBQUcsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDL0QsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsQUFBRCxFQUFHLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDL0QsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxFQUFFLEFBQUQsRUFBRyxJQUFJLEVBQUcsQ0FBQyxDQUFDO0lBRS9ELENBQUMsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ3JDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBSXBDLENBQUMsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0lBQ3hDLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25DLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25DLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25DLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25DLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25DLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25DLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25DLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBV25DLENBQUMsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0lBQ3pDLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQztTQUMzQixTQUFTLENBQUMsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsa0JBQWtCLEVBQUUsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ2xFLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBRWpDLENBQUMsQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFLLEFBQUosRUFBTSxJQUFJLEVBQUUsSUFBSSxDQUFPO1FBQ3hCLENBQUssQUFBSixFQUFNLElBQUksRUFBRSxJQUFJLENBQU87UUFDeEIsQ0FBSyxBQUFKLEVBQU0sSUFBSSxFQUFFLElBQUksQ0FBTztRQUN4QixDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNoRSxDQUFDLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBSyxBQUFKLEVBQU0sSUFBSSxFQUFFLElBQUksQ0FBQztRQUNsQixDQUFLLEFBQUosRUFBTSxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQ2xCLENBQUssQUFBSixFQUFNLElBQUksRUFBRSxJQUFJLENBQUM7UUFDbEIsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNsQixDQUFLLEFBQUosRUFBTSxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3pELENBQUMsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksQ0FBTyxDQUFDLENBQUMsQ0FBQztJQWFuRCxDQUFDLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUVwQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUN2RCxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUN2RCxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUN2RCxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUN2RCxLQUFLLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxRQUFRLEVBQUUsYUFBYSxFQUFFLElBQUksQ0FBQyxFQUFFO1FBQzdELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO0tBQ2xEO0lBQ0QsS0FBSyxNQUFNLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFO1FBTXZCLEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO0tBQ2xEO0lBRUQsS0FBSyxNQUFNLEVBQUUsSUFBSSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDLEVBQUU7UUFDdkMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3JELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNyRCxFQUFFLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDckQsRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQ3REO0lBQ0QsS0FBSyxNQUFNLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFO1FBQ3RCLEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNyRCxFQUFFLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDckQsRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3JELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUVyRCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENB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QUNoRCxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7UUFDaEQsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0tBQ2pELENBQUMsQ0FBQztJQUNILFlBQVksQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFDLENBQUM7SUFDeEMsS0FBSyxDQUFDLFlBQVksQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDLENBQUMsS0FBaUIsQ0FBQyxDQUFDO0lBSXBFLEtBQUssTUFBTSxRQUFRLElBQUksR0FBRyxDQUFDLFNBQVMsRUFBRTtRQUNwQyxNQUFNLElBQUksR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDO1FBQzNCLEtBQUssTUFBTSxHQUFHLElBQUksSUFBSSxDQUFDLE1BQU0sRUFBRSxFQUFFO1lBQy9CLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDMUIsSUFBSSxHQUFHLEtBQUssZUFBZSxXQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQywwQ0FBRSxVQUFVLENBQUMsT0FBTyxFQUFDLEVBQUU7Z0JBQ3RFLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxDQUFDO2dCQUV0QixNQUFNLEdBQUcsR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQztnQkFDeEMsSUFBSSxHQUFHO29CQUFFLEdBQUcsQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQzthQUN0QztTQUNGO0tBQ0Y7QUFDSCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUm9tIH0gZnJvbSAnLi4vcm9tLmpzJztcbmltcG9ydCB7IE1ldGFzY3JlZW4gfSBmcm9tICcuL21ldGFzY3JlZW4uanMnO1xuaW1wb3J0IHsgaXRlcnMgfSBmcm9tICcuLi91dGlsLmpzJztcblxuLy8gU2ltcGxlIHRpbGVzZXQtb25seSBmaXhlcyB0aGF0IHVubG9jayBzb21lIHNjcmVlbi10aWxlc2V0IGNvbWJpbmF0aW9uc1xuZXhwb3J0IGVudW0gU2NyZWVuRml4IHtcbiAgVW5rbm93bixcbiAgLy8gU3VwcG9ydCBcImxvbmcgZ3Jhc3NcIiByaXZlciBzY3JlZW5zIG9uIHRoZSBncmFzcyB0aWxlc2V0IGJ5IGNvcHlpbmdcbiAgLy8gc29tZSB0aWxlcyBmcm9tIDUxLi41OSBpbnRvIDQwLi40Ny5cbiAgR3Jhc3NMb25nR3Jhc3MsXG4gIC8vIEluIGFkZGl0aW9uIHRvIGp1c3QgbWFraW5nIHRoZSBuZXcgbG9uZyBncmFzcyB0aWxlcywgd2UgbmVlZCB0b1xuICAvLyBhbHNvIHJlbWFwIHRoZSBleGlzdGluZyBvbmVzIGluIHNvbWUgc2l0dWF0aW9ucyB0byBwb2ludCB0byB0aGVcbiAgLy8gbmV3IG9uZXMsIGUuZy4gZm9yIHNjcmVlbnMgMWQsMjkgdG8gd29yayBvbiByaXZlciwgd2UgbmVlZCB0byB1c2VcbiAgLy8gdGhlIDR4IHRpbGVzIGluc3RlYWQgb2YgdGhlIDV4IG9uZXMgdG8gZml4IHRoZSBzdXJyb3VuZGluZy5cbiAgR3Jhc3NMb25nR3Jhc3NSZW1hcHBpbmcsIC8vIFRPRE9cbiAgLy8gUml2ZXIgdGlsZXNldHMgZG9uJ3QgZGVmaW5lIDEwLDEyLDE0LDE2LDE3LDFhLDFiLDFjLDIyLDIzLDI0LDI1LDI2LFxuICAvLyB3aGljaCBhcmUgdXNlZCBmb3IgdGhlIFwic2hvcnQgZ3Jhc3NcIiBpbiB0aGUgZ3Jhc3MgdGlsZXNldC4gIFRoZXNlXG4gIC8vIHdvdWxkIGJlIGVhc3kgdG8gY29weSBmcm9tIHNvbWV3aGVyZSBlbHNlIHRvIG9wZW4gdXAgYSBmZXcgc2NyZWVucy5cbiAgUml2ZXJTaG9ydEdyYXNzLCAvLyBUT0RPXG4gIC8vIEFuZ3J5IHNlYSB1c2VzIDBhIG9kZGx5IGZvciBhIHNpbXBsZSBkaWFnb25hbCBiZWFjaC9tb3VudGFpbiB0aWxlLFxuICAvLyBwcmV2ZW50aW5nIHBhcml0eSB3aXRoIGdyYXNzL3JpdmVyIGNhdmUgZW50cmFuY2UgYm90dG9tcy4gIE1vdmUgdGhpc1xuICAvLyB0aWxlIGVsc2V3aGVyZSAoYWQpIGFuZCBmaXggdGhlIGdyYXBoaWNzL2VmZmVjdHMuICBOb3RlIHRoYXQgdGhlXG4gIC8vIGFjdHVhbCBmaXggaXMgbm90IGVudGlyZWx5IHNhdGlzZnlpbmcuXG4gIFNlYUNhdmVFbnRyYW5jZSxcbiAgLy8gQW5ncnkgc2VhIGRvZXMgbm90IGhhbmRsZSByb2NrcyBjb3JyZWN0bHkuICBGaXggNWEuLjVlIGZvciBwYXJpdHlcbiAgLy8gd2l0aCBncmFzcy9yaXZlciB0aWxlc2V0cy4gIFRPRE8gLSBpbXBsZW1lbnQgdGhlIGZpeCAod2UgY291bGQgbW92ZVxuICAvLyB0aGUgZXhpc3RpbmcgdGlsZXMsIHVzZWQgYnkgbW91bnRhaW4gZ2F0ZXMsIGVsc2V3aGVyZSBwcmV0dHkgZWFzaWx5LFxuICAvLyBvciBhbHRlcm5hdGl2ZWx5IG1vdmUgYWxsIHRoZSA1YS4uNWUgaW4gYWxsIG90aGVyIHRpbGVzZXRzIGludG9cbiAgLy8gODksOGEsOTAsOTksOWQsZDEsZDIgd2hpY2ggYXJlIGZyZWUgaW4gODAsOTAsOTQsOWMpLlxuICBTZWFSb2NrcywgLy8gVE9ET1xuICAvLyBBbGxvdyB0aGUgc2VhIHRvIHN1cHBvcnQgMzQsMzgsM2MuLjNmLCB1c2VkIGFzIG1hcnNoIGluIHJpdmVyIHRpbGVzZXQuXG4gIC8vIFRoZXNlIHdvdWxkIG5lZWQgdG8gbWFwIHRvIHNpbXBsZSBvY2VhbiB0aWxlcy4gIFRPRE8gLSBpbXBsZW1lbnQuXG4gIFNlYU1hcnNoLCAvLyBUT0RPXG4gIC8vIFN1cHBvcnQgNngsN3ggdGlsZXMgKHRyZWVzKSBvbiBhbmdyeSBzZWEuICBQcm9iYWJseSBub3Qgd29ydGggaXQuXG4gIC8vIFdvdWxkIG5lZWQgdG8gbW92ZSAoZS5nLikgTGltZSBUcmVlIExha2UgdG8gYSB0b3RhbGx5IGRpZmZlcmVudCB0aWxlc2V0XG4gIC8vIHRvIGZyZWUgdXAgdGhlIG1ldGF0aWxlcy5cbiAgU2VhVHJlZXMsIC8vIFRPRE9cbiAgLy8gRml4aW5nIFJpdmVyU2hvcnRHcmFzcyBmb3IgZGVzZXJ0IGlzIGEgbG90IGhhcmRlciBiZWNhdXNlIGl0IHRvdWNoZXMgYVxuICAvLyBidW5jaCBvZiB0aWxlcyB1c2VkIGJ5IHRoZSBtb3VudGFpblJpdmVyIHRpbGVzZXQgKDEwLDE0LDJ4KS5cbiAgRGVzZXJ0U2hvcnRHcmFzcywgLy8gVE9ET1xuICAvLyBGaXhpbmcgR3Jhc3NMb25nR3Jhc3MgZm9yIGRlc2VydCBpcyBkaWZmaWN1bHQgYmVjYXVzZSB0aGUgNHggdGlsZXNcbiAgLy8gYXJlIHVzZWQgYnkgbW91bnRhaW5SaXZlci5cbiAgRGVzZXJ0TG9uZ0dyYXNzLCAvLyBUT0RPXG4gIC8vIERlc2VydCBkb2Vzbid0IHN1cHBvcnQgdGhlIDN4IG1hcnNoIHRpbGVzIChjbGFzaCB3aXRoIG1vdW50YWluUml2ZXIpLlxuICAvLyBJdCdzIHByb2JhYmx5IG5vdCBmZWFzaWJsZSB0byBhZGQgc3VwcG9ydCAtIGl0IHdvdWxkIGFsbG93IHNjcmVlbiAzMyxcbiAgLy8gYnV0IHRoZXJlJ3MgYSBzaW1pbGFyIHNvdXRoLWVkZ2UtZXhpdCBzY3JlZW4gd2l0aCBEZXNlcnRUb3duRW50cmFuY2UuXG4gIERlc2VydE1hcnNoLCAvLyBUT0RPXG4gIC8vIEZpeCA1YS4uNWUgdG8gYmUgY29tcGF0aWJsZSB3aXRoIGdyYXNzL3JpdmVyLiAgNWIgaXMgYWxyZWFkeSBpbiB1c2VcbiAgLy8gb24gdGhlIHR3byBvYXNpcyBzY3JlZW5zLCBzbyB0aGF0IHRpbGUgaXMgbW92ZWQgdG8gNWYgdG8gbWFrZSBzcGFjZS5cbiAgRGVzZXJ0Um9ja3MsXG4gIC8vIEFkZCBzb21lIG1pc3NpbmcgdHJlZSB0aWxlcyBpbiA2Myw2OCw2OSw2YSw2Yyw2ZSw2ZiwgcmVxdWlyZWQgZm9yXG4gIC8vIHBhcml0eSB3aXRoIHNvbWUgcml2ZXIgc2NyZWVucy5cbiAgRGVzZXJ0VHJlZXMsXG4gIC8vIFNvdXRoLWZhY2luZyB0b3duIGVudHJhbmNlcyB1c2UgMDcgZm9yIHRoZSB0b3Agb2YgdGhlIHRvd24gd2FsbC5cbiAgLy8gVGhpcyBjb3VsZCBiZSByZXBsYWNlZCB3aXRoIChlLmcuIDhjKSBvciBtYXliZSBzb21ldGhpbmcgYmV0dGVyLlxuICBEZXNlcnRUb3duRW50cmFuY2UsIC8vIFRPRE9cbiAgLy8gTGFieXJpbnRoIHBhcmFwZXRzIGNhbiBiZSBibG9ja2VkL3VuYmxvY2tlZCB3aXRoIGEgZmxhZy4gIFJlZ2lzdGVyZWRcbiAgLy8gaW4gbWF6ZS9nb2EuXG4gIExhYnlyaW50aFBhcmFwZXRzLFxuICAvLyBBZGRzIGZsYWdnYWJsZSBkb29ycyB0byB2YXJpb3VzIHNjcmVlbnMuXG4gIFN3YW1wRG9vcnMsIC8vIFRPRE8gKHNlZSBtYXplL3N3YW1wKVxuICAvLyBBZGRzIHNvbWUgZXh0cmEgc3Bpa2Ugc2NyZWVucy5cbiAgRXh0cmFTcGlrZXMsIC8vIFRPRE9cbiAgLy8gTWFrZSBjYXZlcyBjbG9zZWFibGUuXG4gIENsb3NlQ2F2ZXMsXG4gIC8vIE1ha2VzIHRoZSB0b3AgZXhpdHMgb2YgYXJlbmFzIGZ1bGwtc2l6ZSByYXRoZXIgdGhhbiBuYXJyb3csIGdpdmluZ1xuICAvLyBtb3JlIGZsZXhpYmlsaXR5IHdpdGggd2hhdCBjYW4gZ28gdGhlcmUuXG4gIFdpZGVBcmVuYUV4aXRzLFxufVxuXG50eXBlIFJlcXMgPSBSZWNvcmQ8YW55LCB7cmVxdWlyZXM/OiBTY3JlZW5GaXhbXX0+XG5leHBvcnQgZnVuY3Rpb24gd2l0aFJlcXVpcmU8VCBleHRlbmRzIFJlcXM+KHJlcXVpcmVtZW50OiBTY3JlZW5GaXgsIHByb3BzOiBUKSB7XG4gIGZvciAoY29uc3Qga2V5IGluIHByb3BzKSB7XG4gICAgcHJvcHNba2V5XS5yZXF1aXJlcyA9IFtyZXF1aXJlbWVudF07XG4gIH1cbiAgcmV0dXJuIHByb3BzO1xufVxuXG5cbiAgLy8gLy8gQWRkcyBhYmlsaXR5IHRvIGNsb3NlIGNhdmVzLlxuICAvLyBDbG9zZUNhdmVzLFxuXG5cbi8vIC8qKiBBZGRzIGEgJ0Nsb3NlQ2F2ZXMnIHJlcXVpcmVtZW50IG9uIGFsbCB0aGUgcHJvcGVydGllcy4gKi9cbi8vIGZ1bmN0aW9uIGNsb3NlQ2F2ZXM8VCBleHRlbmRzIFJlY29yZDxhbnksIHtyZXF1aXJlczogU2NyZWVuRml4W119Pj4ocHJvcHM6IFQpIHtcbi8vICAgZm9yIChjb25zdCBrZXkgaW4gcHJvcHMpIHtcbi8vICAgICBwcm9wc1trZXldLnJlcXVpcmVzID0gW1NjcmVlbkZpeC5DbG9zZUNhdmVzXTtcbi8vICAgfVxuLy8gICByZXR1cm4gcHJvcHM7XG4vLyB9XG5cblxuLy8gTk9URTogTGlzdGluZyBleHBsaWNpdCBmbGFncyBkb2Vzbid0IHF1aXRlIHdvcmsuXG4vLyBlbnVtIEZsYWcge1xuLy8gICBBbHdheXMgPSAweDJmMCxcbi8vICAgV2luZG1pbGwgPSAweDJlZSxcbi8vICAgUHJpc29uID0gMHgyZDgsXG4vLyAgIENhbG0gPSAweDI4Myxcbi8vICAgU3R5eCA9IDB4MmIwLFxuLy8gICBEcmF5Z29uMSA9IDB4MjhmLFxuLy8gICBEcmF5Z29uMiA9IDB4MjhkLFxuLy8gfVxuXG4vLyBjb25zdCBHUkFTUyA9IDB4ODA7XG4vLyBjb25zdCBUT1dOID0gMHg4NDtcbi8vIGNvbnN0IENBVkUgPSAweDg4O1xuLy8gY29uc3QgUFlSQU1JRCA9IDB4OGM7XG4vLyBjb25zdCBSSVZFUiA9IDB4OTA7XG4vLyBjb25zdCBNT1VOVEFJTiA9IDB4OTQ7XG4vLyBjb25zdCBTRUEgPSAweDk0O1xuLy8gY29uc3QgU0hSSU5FID0gMHg5ODtcbi8vIGNvbnN0IERFU0VSVCA9IDB4OWM7XG4vLyBjb25zdCBNT1VOVEFJTl9SSVZFUiA9IDB4OWM7XG4vLyBjb25zdCBTV0FNUCA9IDB4YTA7XG4vLyBjb25zdCBIT1VTRSA9IDB4YTA7XG4vLyBjb25zdCBGT1JUUkVTUyA9IDB4YTQ7XG4vLyBjb25zdCBJQ0VfQ0FWRSA9IDB4YTg7XG4vLyBjb25zdCBUT1dFUiA9IDB4YWM7XG5cbi8qKiBBcHBseSBzdGFuZGFyZCB0aWxlc2V0IGZpeGVzLiAgT3RoZXJzIG1heSBiZSBhcHBsaWVkIGxhdGVyLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZpeFRpbGVzZXRzKHJvbTogUm9tKSB7XG4gIGNvbnN0IHtkZXNlcnQsIGdyYXNzLCBsaW1lLCBtb3VudGFpbiwgbW91bnRhaW5SaXZlcixcbiAgICAgICAgIHJpdmVyLCBzZWEsIHRvd259ID0gcm9tLm1ldGF0aWxlc2V0cztcbiAgY29uc3QgJCA9IHJvbS5tZXRhc2NyZWVucztcblxuICAvLyBTZXZlcmFsIG9mIHRoZSBncmFzcy9yaXZlciBzY3JlZW5zIHdpdGggZm9yZXN0IHRpbGVzIGRvbid0IHdvcmsgb25cbiAgLy8gZGVzZXJ0LiAgRml4IHRoZW0gYnkgbWFraW5nIDVhLi42ZiB3b3JrIGNvcnJlY3RseS5cbiAgJC5yZWdpc3RlckZpeChTY3JlZW5GaXguRGVzZXJ0Um9ja3MpO1xuICBkZXNlcnQuZ2V0VGlsZSgweDVmKS5jb3B5RnJvbSgweDViKS5yZXBsYWNlSW4oJC5vYXNpc0NhdmUsICQub2FzaXNMYWtlKTtcblxuICBkZXNlcnQuZ2V0VGlsZSgweDVhKS5jb3B5RnJvbSgweDk4KS5zZXRUaWxlcyhbLCAsIDB4MWEsIDB4MThdKTtcbiAgZGVzZXJ0LmdldFRpbGUoMHg1YikuY29weUZyb20oMHg4MCkuc2V0VGlsZXMoWzB4MzQsIDB4MzIsICwgXSk7XG4gIGRlc2VydC5nZXRUaWxlKDB4NWMpLmNvcHlGcm9tKDB4ODApLnNldFRpbGVzKFssICwgMHgzNywgMHgzNV0pO1xuICBkZXNlcnQuZ2V0VGlsZSgweDVkKS5jb3B5RnJvbSgweDgwKS5zZXRUaWxlcyhbLCAweDM3LCAsIDB4MzRdKTtcbiAgZGVzZXJ0LmdldFRpbGUoMHg1ZSkuY29weUZyb20oMHg4MCkuc2V0VGlsZXMoWzB4MzUsICwgMHgzMiwgXSk7XG5cbiAgJC5yZWdpc3RlckZpeChTY3JlZW5GaXguRGVzZXJ0VHJlZXMpO1xuICBkZXNlcnQuZ2V0VGlsZSgweDYzKS5jb3B5RnJvbSgweDcxKTtcbiAgZGVzZXJ0LmdldFRpbGUoMHg2OCkuY29weUZyb20oMHg3MCk7XG4gIGRlc2VydC5nZXRUaWxlKDB4NjkpLmNvcHlGcm9tKDB4NjApO1xuICBkZXNlcnQuZ2V0VGlsZSgweDZhKS5jb3B5RnJvbSgweDY1KTtcbiAgZGVzZXJ0LmdldFRpbGUoMHg2YykuY29weUZyb20oMHg3MCk7XG4gIGRlc2VydC5nZXRUaWxlKDB4NmUpLmNvcHlGcm9tKDB4NzYpO1xuICBkZXNlcnQuZ2V0VGlsZSgweDZmKS5jb3B5RnJvbSgweDc4KTtcblxuICAvLyBMb25nIGdyYXNzIHNjcmVlbnMgZG9uJ3Qgd29yayBvbiBncmFzcyB0aWxlc2V0cyBiZWNhdXNlIG9mIGEgZmV3XG4gIC8vIGRpZmZlcmVudCB0aWxlcyAtIGNvcHkgdGhlbSB3aGVyZSB0aGV5IG5lZWQgdG8gZ28uXG4gICQucmVnaXN0ZXJGaXgoU2NyZWVuRml4LkdyYXNzTG9uZ0dyYXNzKTtcbiAgZ3Jhc3MuZ2V0VGlsZSgweDQwKS5jb3B5RnJvbSgweDUxKTtcbiAgZ3Jhc3MuZ2V0VGlsZSgweDQxKS5jb3B5RnJvbSgweDUyKTtcbiAgZ3Jhc3MuZ2V0VGlsZSgweDQyKS5jb3B5RnJvbSgweDUzKTtcbiAgZ3Jhc3MuZ2V0VGlsZSgweDQzKS5jb3B5RnJvbSgweDU0KTtcbiAgZ3Jhc3MuZ2V0VGlsZSgweDQ0KS5jb3B5RnJvbSgweDU1KTtcbiAgZ3Jhc3MuZ2V0VGlsZSgweDQ1KS5jb3B5RnJvbSgweDU2KTtcbiAgZ3Jhc3MuZ2V0VGlsZSgweDQ2KS5jb3B5RnJvbSgweDU4KTtcbiAgZ3Jhc3MuZ2V0VGlsZSgweDQ3KS5jb3B5RnJvbSgweDU5KTtcblxuICAvLyBBbmdyeSBzZWEgdGlsZXNldCBkb2Vzbid0IHN1cHBvcnQgdGlsZSAwYSAodXNlZCBlbHNld2hlcmUgZm9yIHRoZVxuICAvLyBib3R0b20gdGlsZSBpbiBjYXZlIGVudHJhbmNlcykgYmVjYXVzZSBpdCdzIGFscmVhZHkgaW4gdXNlIChidXRcbiAgLy8gbm90IGFzIGFuIGFsdGVybmF0aXZlKS4gIE1vdmUgaXQgdG8gYWQgYW5kIGdldCAwYSBiYWNrLiAgQWxzbyBhZGp1c3RcbiAgLy8gdGhlIHRpbGVzIGFyb3VuZCB0aGUgY2F2ZSBlbnRyYW5jZXMgdG8gbm90IGhhdmUgZGFtYWdlIHRpbGVzIGluIHRoZVxuICAvLyBkZXNlcnQgdGlsZXNldC4gIFRoaXMgY2hhbmdlcyB0aGUgZ3JhcGhpY3MgYSBiaXQgKGZyb20gZGFyayBibHVlXG4gIC8vIHdhdGVyIHRvIGxpZ2h0IGJsdWUpLCB3aGljaCBkb2Vzbid0IGxvb2sgcXVpdGUgYXMgbmljZS4gIFRoZSBvdGhlclxuICAvLyBhbHRlcm5hdGl2ZSBpcyB0byBhbGxvY2F0ZSAzIG5ldyB0aWxlcywgY29waWVkIGZyb20gMHg4MCBpbiBzZWEgYnV0XG4gIC8vIGZyb20gMHhmNywgMHhmOCwgYW5kIDB4ZmQgaW4gZGVzZXJ0L3JpdmVyL2dyYXNzLiAgVGhlbiBzZWEgY2FuIGtlZXBcbiAgLy8gaXRzIGRlZXAgd2F0ZXIgYnV0IGRlc2VydCBhdm9pZHMgdGhlIGRhbWFnZS5cbiAgJC5yZWdpc3RlckZpeChTY3JlZW5GaXguU2VhQ2F2ZUVudHJhbmNlKTtcbiAgc2VhLmdldFRpbGUoMHhhZCkuY29weUZyb20oMHgwYSlcbiAgICAgIC5yZXBsYWNlSW4oJC5iZWFjaEV4aXROLCAkLmxpZ2h0aG91c2VFbnRyYW5jZSwgJC5vY2VhblNocmluZSk7XG4gIHNlYS5nZXRUaWxlKDB4MGEpLmNvcHlGcm9tKDB4YTIpOyAvLyBkb24ndCBib3RoZXIgc2V0dGluZyBhbiBhbHRlcm5hdGl2ZS5cbiAgLy9zZWEuZ2V0VGlsZSgweDBhKS5zZXRUaWxlcyhbMHg5MSwgMHg5MSwgMHg3ZCwgMHg3ZF0pLnNldEF0dHJzKDIpO1xuICAkLmJvdW5kYXJ5Tl9jYXZlLnNjcmVlbi5zZXQyZCgweDM4LCBbWyAgICAsIDB4MDAsIDB4MDAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyAgICAsIDB4MGEsIDB4MGEgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyAgICAsIDB4ZjcsIDB4ZjcgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzB4ZjgsIDB4ZjgsIDB4ZjgsIDB4ZjhdXSk7XG4gICQuY29ybmVyU0VfY2F2ZS5zY3JlZW4uc2V0MmQoMHg0OSwgW1sgICAgLCAweDAwLCAweDAwXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyAgICAsIDB4MGEsIDB4MGFdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbICAgICwgMHhmNywgMHhmN10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsweGY4LCAweGY3LCAweGY3XSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyAgICAsIDB4ZmQsIDB4ZjddXSk7XG4gICQuY29ybmVyU0VfY2F2ZS5zY3JlZW4uc2V0MmQoMHg0YSwgW1sweDAwLCAweDAwXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzB4MGEsIDB4MGFdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMHhmNywgMHhmN10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsweGY4LCAweGY3XSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzB4ODAsIDB4ZmRdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMHg4MCwgMHhmZl0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsweGZhICAgICAgXV0pO1xuXG4gICAgIC8vICwgWzB4ZjgsIDB4ZjhdLCBbbnVsbCwgMHhmZF1dKTtcbiAgLy8gc2VhLnNjcmVlbnMuYWRkKCQuYm91bmRhcnlXX2NhdmUpO1xuICAvLyBzZWEuc2NyZWVucy5hZGQoJC5kZXNlcnRDYXZlRW50cmFuY2UpO1xuXG4gIC8vIFRvIGFsbG93IGNhdmVzIHRvIGJlIGNsb3NlZCwgd2UgY2xlYXIgb3V0IG1ldGF0aWxlcyAwMS4uMDQsIHRvIGJlIHVzZWQgYXNcbiAgLy8gdGhlIGZvdXIgY29ybmVycyBvZiB0aGUgY2F2ZTogW1swMSwgMDFdLCBbMDIsIDAyXV0uICAwMyBhbmQgMDQgYXJlIHVzZWQgZm9yXG4gIC8vIHdhdGVyIGVudHJhbmNlcyB0byBlbnN1cmUgdGhlIHBsYXllciBpc24ndCBraWNrZWQgb2ZmIHRoZSBkb2xwaGluLlxuICAvLyBUaGVzZSBhcmUgY29waWVkIGZyb20gYzEsZDcgZm9yIG1vc3QgdGlsZXNldHMgKHRob3VnaCBvY2VhbiBpcyBzcGVjaWFsKS5cbiAgLy8gU29tZSB0aWxlc2V0cyBhbHJlYWR5IGhhdmUgbWV0YXRpbGVzIGluIDAxLi4wNCBzbyB3ZSBuZWVkIHRvIG1vdmUgdGhlbSB0b1xuICAvLyB1bm9jY3VwaWVkIHNwb3RzIG9uIGEgcGVyLXRpbGVzZXQgYmFzaXMgKG5vdGUgdGhhdCBzZWEgKDk0KSBhbmQgZGVzZXJ0ICg5YylcbiAgLy8gYXJlIGVudGFuZ2xlZCBoZXJlKS4gIFtUT0RPIC0gY2xlYW4gdXAgMmMgYW5kIDJkIGFzIHdlbGxdXG4gICQucmVnaXN0ZXJGaXgoU2NyZWVuRml4LkNsb3NlQ2F2ZXMpO1xuICAvLyBNb3ZlIHRoZSBleGlzdGluZyB0aWxlcyBpbiAwMS4uMDQgdG8gdmFyaW91cyBmcmVlIHNwb3RzXG4gIHJpdmVyLmdldFRpbGUoMHgwNykuY29weUZyb20oMHgwMSkucmVwbGFjZUluKC4uLnJpdmVyKTtcbiAgcml2ZXIuZ2V0VGlsZSgweDBlKS5jb3B5RnJvbSgweDAyKS5yZXBsYWNlSW4oLi4ucml2ZXIpO1xuICByaXZlci5nZXRUaWxlKDB4MjApLmNvcHlGcm9tKDB4MDMpLnJlcGxhY2VJbiguLi5yaXZlcik7XG4gIHJpdmVyLmdldFRpbGUoMHgyMSkuY29weUZyb20oMHgwNCkucmVwbGFjZUluKC4uLnJpdmVyKTtcbiAgZm9yIChjb25zdCB0cyBvZiBbZGVzZXJ0LCBzZWEsIG1vdW50YWluLCBtb3VudGFpblJpdmVyLCBsaW1lXSkge1xuICAgIHRzLmdldFRpbGUoMHg2OCkuY29weUZyb20oMHgwMSkucmVwbGFjZUluKC4uLnRzKTtcbiAgICB0cy5nZXRUaWxlKDB4ODMpLmNvcHlGcm9tKDB4MDIpLnJlcGxhY2VJbiguLi50cyk7XG4gICAgdHMuZ2V0VGlsZSgweDg4KS5jb3B5RnJvbSgweDAzKS5yZXBsYWNlSW4oLi4udHMpO1xuICAgIHRzLmdldFRpbGUoMHg4OSkuY29weUZyb20oMHgwNCkucmVwbGFjZUluKC4uLnRzKTtcbiAgfVxuICBmb3IgKGNvbnN0IHRzIG9mIFt0b3duXSkge1xuICAgIC8vIE5vdGU6IHdlIG5lZWQgdGhlIDAzLzA0IHRpbGVzIGhlcmUgYmVjYXVzZSBTYWhhcmEgTWVhZG93IG5vcnRoXG4gICAgLy8gY2F2ZSBleGl0IGlzIHNoYXJlZCB3aXRoIEVTSSBlbnRyYW5jZS5cbiAgICAvLyBOZWVkIHRvIG1vdmUgMDEsMDIgKHZhbmlsbGEgU3dhbiBHYXRlKSB0byBzb21ld2hlcmUgZWxzZSBmbGFnZ2FibGUsXG4gICAgLy8gYnV0IHRoZXJlIGFyZW4ndCB0d28gYXZhaWxhYmxlIHNwb3RzLCBzbyB3ZSdsbCBtb3ZlIDFhLDFiIHRvIDUwLDUxXG4gICAgLy8gZmlyc3QsIGFuZCB0aGVuIG1vdmUgMDEsMDIgdG8gMWEsMWIuXG4gICAgdHMuZ2V0VGlsZSgweDUwKS5jb3B5RnJvbSgweDFhKS5yZXBsYWNlSW4oLi4udHMpO1xuICAgIHRzLmdldFRpbGUoMHg1MSkuY29weUZyb20oMHgxYikucmVwbGFjZUluKC4uLnRzKTtcbiAgICB0cy5nZXRUaWxlKDB4MWEpLmNvcHlGcm9tKDB4MDEpLnJlcGxhY2VJbiguLi50cyk7XG4gICAgdHMuZ2V0VGlsZSgweDFiKS5jb3B5RnJvbSgweDAyKS5yZXBsYWNlSW4oLi4udHMpO1xuICAgIHRzLmdldFRpbGUoMHg1MikuY29weUZyb20oMHgwMykucmVwbGFjZUluKC4uLnRzKTtcbiAgICB0cy5nZXRUaWxlKDB4NTcpLmNvcHlGcm9tKDB4MDQpLnJlcGxhY2VJbiguLi50cyk7XG4gIH1cbiAgLy8gTWFrZSAwMS4uMDQgYmUgZmxhZ2dhYmxlIHdhbGwvb3BlbmluZ1xuICBmb3IgKGNvbnN0IHRzIG9mIFtncmFzcywgcml2ZXIsIGRlc2VydF0pIHtcbiAgICB0cy5nZXRUaWxlKDB4MDEpLmNvcHlGcm9tKDB4YzEpLnNldEFsdGVybmF0aXZlKDB4MDApO1xuICAgIHRzLmdldFRpbGUoMHgwMikuY29weUZyb20oMHhkNykuc2V0QWx0ZXJuYXRpdmUoMHgwYSk7XG4gICAgdHMuZ2V0VGlsZSgweDAzKS5jb3B5RnJvbSgweGMxKS5zZXRBbHRlcm5hdGl2ZSgweDAwKTtcbiAgICB0cy5nZXRUaWxlKDB4MDQpLmNvcHlGcm9tKDB4ZDcpLnNldEFsdGVybmF0aXZlKDB4MGEpO1xuICB9XG4gIGZvciAoY29uc3QgdHMgb2YgW3NlYV0pIHtcbiAgICB0cy5nZXRUaWxlKDB4MDEpLmNvcHlGcm9tKDB4YzEpLnNldEFsdGVybmF0aXZlKDB4MDApO1xuICAgIHRzLmdldFRpbGUoMHgwMikuY29weUZyb20oMHhjYikuc2V0QWx0ZXJuYXRpdmUoMHgwMCk7XG4gICAgdHMuZ2V0VGlsZSgweDAzKS5jb3B5RnJvbSgweGMxKS5zZXRBbHRlcm5hdGl2ZSgweGMwKTtcbiAgICB0cy5nZXRUaWxlKDB4MDQpLmNvcHlGcm9tKDB4Y2IpLnNldEFsdGVybmF0aXZlKDB4YzApO1xuICAgIC8vIGNvcHkgcm9jayBncmFwaGljcyBmcm9tIG90aGVyIHRpbGVzZXQgKHNhbWUgcGFnZSBpcyBsb2FkZWQpXG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPCA1OyBpKyspIHtcbiAgICAgIHRzLmdldFRpbGUoaSkuc2V0VGlsZXMoZ3Jhc3MuZ2V0VGlsZShpKS50aWxlcyk7XG4gICAgfVxuICB9XG4gIGZvciAoY29uc3QgdHMgb2YgW3Rvd25dKSB7XG4gICAgdHMuZ2V0VGlsZSgweDAxKS5jb3B5RnJvbSgweDYzKS5zZXRBbHRlcm5hdGl2ZSgweDAwKTtcbiAgICB0cy5nZXRUaWxlKDB4MDIpLmNvcHlGcm9tKDB4NjQpLnNldEFsdGVybmF0aXZlKDB4ZDIpO1xuICAgIHRzLmdldFRpbGUoMHgwMykuY29weUZyb20oMHg2Mykuc2V0QWx0ZXJuYXRpdmUoMHgwMCk7XG4gICAgdHMuZ2V0VGlsZSgweDA0KS5jb3B5RnJvbSgweDY0KS5zZXRBbHRlcm5hdGl2ZSgweGQyKTtcbiAgfVxuICAvLyBTZXQgdGhlIGNhdmUgZW50cmFuY2VzIHRvIHVzZSAwMS4uMDQgYXMgYXBwcm9wcmlhdGVcbiAgY29uc3QgY2xvc2VkQ2F2ZXMgPSBuZXcgU2V0KFtcbiAgICAkLmJvdW5kYXJ5RV9jYXZlLCAkLmJvdW5kYXJ5V19jYXZlLCAkLmV4aXRXX2NhdmUsICQuY2F2ZUFib3ZlUG9ydG9hLFxuICAgICQuYmVhY2hDYXZlLCAkLm91dHNpZGVXaW5kbWlsbCxcbiAgICAkLmV4aXRTX2NhdmUsICQudG93bkV4aXRXX2NhdmUsXG4gICAgJC56b21iaWVUb3duQm90dG9tX2NhdmVFeGl0LCAvLyAodG93bilcbiAgICAvLyBUT0RPIC0gYW55IHdheSB0byBkbyAkLmNoYW5uZWxFbmRXX2NhdmU/IChzdGFpciBpbiBkb2xwaGluQ2F2ZSlcbiAgICAvLyBUT0RPIC0gbW91bnRhaW4gY2F2ZSBlbnRyYW5jZXM/IChib3RoIDk0IGFuZCBcbiAgICAvLyAgIC0gMCBvbiB0b3AsIDE2IG9uIGJvdHRvbSBmb3IgMDUgKGZyZWUgaW4gOTQpIGFuZCAwNiAoZnJvbSAyNyBvciAzYz8pXG4gICAgLy8gICAtIG9yIGp1c3QgdXNlIDFhLzFhLzA4LzA5IC0gb25seSAwOCBpZiBhIGtleSBpcyBuZWVkZWQ/XG4gIF0pO1xuICBjb25zdCB3YXRlckNhdmVzID0gbmV3IFNldDxNZXRhc2NyZWVuPihbXSk7XG4gIGlmICgkLmlzRml4ZWQoU2NyZWVuRml4LlNlYUNhdmVFbnRyYW5jZSkpIHtcbiAgICB3YXRlckNhdmVzLmFkZCgkLmJvdW5kYXJ5Tl9jYXZlKTtcbiAgICB3YXRlckNhdmVzLmFkZCgkLmNvcm5lclNFX2NhdmUpO1xuICB9XG4gIGNvbnN0IG1vdW50YWluQ2F2ZXMgPSBuZXcgU2V0KFtcbiAgICAkLm1vdW50YWluRGVhZEVuZFdfY2F2ZUVtcHR5LFxuICAgICQubW91bnRhaW5QYXRoV19jYXZlLFxuICAgICQubW91bnRhaW5DYXZlX2VtcHR5LFxuICAgICQubW91bnRhaW5QYXRoRV9jYXZlLFxuICAgICQubW91bnRhaW5QYXRoTl9zbG9wZVNfY2F2ZSxcbiAgICAkLm1vdW50YWluUGF0aFdFX3Nsb3BlTl9jYXZlLFxuICAgICQubW91bnRhaW5QYXRoRV9nYXRlLFxuICBdKTtcbiAgZm9yIChjb25zdCBzY3Igb2YgWy4uLmNsb3NlZENhdmVzLCAuLi53YXRlckNhdmVzXSkge1xuICAgIGNvbnN0IGV4aXQgPSBzY3IuZGF0YS5leGl0cyEuZmluZChlID0+IGUudHlwZSA9PT0gJ2NhdmUnKTtcbiAgICBjb25zdCBwb3MgPSBNYXRoLm1pbiguLi5leGl0IS5leGl0cykgLSAweDEwO1xuICAgIGNvbnN0IHRpbGVzID0gd2F0ZXJDYXZlcy5oYXMoc2NyKSA/IFtbMywgM10sIFs0LCA0XV0gOiBbWzEsIDFdLCBbMiwgMl1dO1xuICAgIHNjci5zY3JlZW4uc2V0MmQocG9zLCB0aWxlcyk7XG4gICAgc2NyLmFkZEN1c3RvbUZsYWcodHJ1ZSk7XG4gIH1cbiAgZm9yIChjb25zdCBzY3Igb2YgWy4uLm1vdW50YWluQ2F2ZXNdKSB7XG4gICAgY29uc3QgZXhpdCA9IHNjci5kYXRhLmV4aXRzIS5maW5kKGUgPT4gZS50eXBlID09PSAnY2F2ZScgfHwgZS50eXBlID09PSAnZ2F0ZScpO1xuICAgIGNvbnN0IHBvcyA9IE1hdGgubWluKC4uLmV4aXQhLmV4aXRzKSAtIDB4MTA7XG4gICAgY29uc3QgdGlsZXMgPSBbWzB4MWEsIDB4MWFdLCBbMHgwOCwgMHgwOV1dO1xuICAgIHNjci5zY3JlZW4uc2V0MmQocG9zLCB0aWxlcyk7XG4gICAgc2NyLmFkZEN1c3RvbUZsYWcodHJ1ZSk7XG4gIH1cbiAgLy8gRml4IHRoZSB0d28gdmFuaWxsYSBzZWFsZWQtY2F2ZSBncmFwaGljcyB0byBiZSBjb25zaXN0ZW50IHdpdGhcbiAgLy8gb3VyIG5pY2VyIFwicm9ja2ZhbGxcIiBncmFwaGljcyAoc3BlY2lmaWNhbGx5LCBhZGQgdGhlIGFyY2hlZCB0b3ApLlxuICAkLm91dHNpZGVXaW5kbWlsbC5zY3JlZW4uc2V0MmQoMHg0MywgW1sweGNhLCAweDgyXV0pO1xuICAkLnRvd25FeGl0V19jYXZlLnNjcmVlbi5zZXQyZCgweDJhLCBbWzB4Y2EsIDB4ODJdXSk7XG5cbiAgLy8gTk9URTogdGhlIGNvcnJlY3QgY2F2ZXMgYXJlIGNsb3NlZCBieSBwYXNzL2ZpeGVudHJhbmNldHJpZ2dlcnMuXG5cbiAgLy8gc2VhLmdldFRpbGUoMHgwYSkuY29weUZyb20oMHhhMikuc2V0VGlsZXMoWywsMHg5MSwweDkxXSkuc2V0QXR0cnMoMCk7XG4gIC8vIFRoaXMgZG9lcyBvcGVuIHVwIHNjcmVlbiAkY2UgKGRlc2VydCBjYXZlIGVudHJhbmNlKSBmb3IgdXNlIGluIHRoZSBzZWEsXG4gIC8vIHdoaWNoIGlzIGludGVyZXN0aW5nIGJlY2F1c2Ugd2hpcmxwb29scyBjYW4ndCBiZSBmbG93biBwYXN0IC0gd2UnZCBuZWVkXG4gIC8vIHRvIGFkZCBmbGFncyB0byBjbGVhciB0aGUgd2hpcmxwb29scywgYnV0IGl0IHdvdWxkIGJlIGEgY2F2ZSB0aGF0J3NcbiAgLy8gYmxvY2tlZCBvbiBjYWxtaW5nIHRoZSBzZWEuLi5cblxuICAvLyBXZSBjb3VsZCBhZGQgYSBudW1iZXIgb2Ygc2NyZWVucyB0byB0aGUgc2VhIGlmIHdlIGNvdWxkIG1vdmUgNWEuLjVlXG4gIC8vICh3aGljaCBjb2xsaWRlcyB3aXRoIG1vdW50YWluIGdhdGVzKS4gIDg5LDhhLDkwLDk5LDlkLGQxLGQyIGFyZSBmcmVlXG4gIC8vIGluIDgwIChncmFzcyksIDkwIChyaXZlciksIGFuZCA5YyAoZGVzZXJ0KS4gIFRoZSBtYWluIHByb2JsZW0gaXMgdGhhdFxuICAvLyBhdCBsZWFzdCB0aGUgY2F2ZSBlbnRyYW5jZXMgZG9uJ3QgcXVpdGUgd29yayBmb3IgdGhlc2UgLSB0aGV5IGVuZCB1cFxuICAvLyBpbiBzaGFsbG93IHdhdGVyLCBhcmUgYSBsaXR0bGUgdG9vIHNob3J0LCBhbmQgaXQgc2VlbXMgdG8gYmUgaW1wb3NzaWJsZVxuICAvLyB0byBwaWNrIGEgcGFsZXR0ZSB0aGF0IGlzIGxpZ2h0IGJsdWUgb24gYm90dG9tIGFuZCBibGFjayBvbiB0b3AuXG4gIC8vXG4gIC8vIE90aGVyIG9wdGlvbnMgZm9yIHRoZSBzZWEgYXJlIDM0LDM4LDNjLi4zZiB3aGljaCBhcmUgbWFyc2ggdGlsZXMgaW5cbiAgLy8gcml2ZXIgLSB3b3VsZCBvcGVuIHVwIHNvbWUgbmFycm93IHBhc3NhZ2VzICgzMywgXG5cblxuICAvLyAgcm9tLm1ldGFzY3JlZW5zO1xuXG4gIC8vIGZvciAoY29uc3QgeCBvZiBPYmplY3QudmFsdWVzKFRJTEVTRVRfRklYRVMpKSB7XG4gIC8vICAgY29uc3QgaWQgPSB4LmlkO1xuICAvLyAgIGNvbnN0IHRzID0gcm9tLnRpbGVzZXRzW2lkXTtcbiAgLy8gICBjb25zdCB0ZSA9IHRzLmVmZmVjdHMoKTtcbiAgLy8gICBmb3IgKGNvbnN0IHRzdHIgaW4geCkge1xuICAvLyAgICAgY29uc3QgdCA9IE51bWJlcih0c3RyKTtcbiAgLy8gICAgIGlmIChpc05hTih0KSkgY29udGludWU7XG4gIC8vICAgICBjb25zdCB5OiBudW1iZXJ8e2Jhc2U6IG51bWJlcn0gPSAoeCBhcyBhbnkpW3RdO1xuICAvLyAgICAgY29uc3QgYmFzZSA9IHR5cGVvZiB5ID09PSAnbnVtYmVyJyA/IHkgOiAoeSBhcyBhbnkpLmJhc2U7XG4gIC8vICAgICBjb25zdCByZXN0OiBhbnkgPSB0eXBlb2YgeSA9PT0gJ251bWJlcicgPyB7fSA6IHk7XG4gIC8vICAgICB0cy5hdHRyc1t0XSA9IHRzLmF0dHJzW2Jhc2VdO1xuICAvLyAgICAgdGUuZWZmZWN0c1t0XSA9IHRlLmVmZmVjdHNbYmFzZV07XG4gIC8vICAgICBbcmVzdC50bCwgcmVzdC50ciwgcmVzdC5ibCwgcmVzdC5icl0uZm9yRWFjaCgobSwgaSkgPT4ge1xuICAvLyAgICAgICB0cy50aWxlc1tpXVt0XSA9IHRzLnRpbGVzW2ldW20gIT0gbnVsbCA/IG0gOiBiYXNlXTtcbiAgLy8gICAgIH0pO1xuICAvLyAgICAgaWYgKHJlc3QubW92ZSkge31cbiAgLy8gICAgIC8vIGlmIChyZXN0LnRpbGVzKSB7XG4gIC8vICAgICAvLyAgIHJlc3QudGlsZXMuZm9yRWFjaCgoczogbnVtYmVyLCBpOiBudW1iZXIpID0+IHZvaWQgKHRzLnRpbGVzW2ldW3RdID0gcykpO1xuICAvLyAgICAgLy8gfVxuICAvLyAgIH1cbiAgLy8gfVxufVxuXG5cbi8vIGNvbnN0IFRJTEVTRVRfRklYRVMgPSB7XG4vLyAgIGdyYXNzOiB7XG4vLyAgICAgaWQ6IDB4ODAsXG4vLyAgICAgMHg0MDogMHg1MSxcbi8vICAgICAweDQxOiAweDUyLFxuLy8gICAgIDB4NDI6IDB4NTMsXG4vLyAgICAgMHg0MzogMHg1NCxcbi8vICAgICAweDQ0OiAweDU1LFxuLy8gICAgIDB4NDU6IDB4NTYsXG4vLyAgICAgMHg0NjogMHg1OCxcbi8vICAgICAweDQ3OiAweDU5LFxuLy8gICB9LFxuLy8gICBkZXNlcnQ6IHtcbi8vICAgICBpZDogMHg5Yyxcbi8vICAgICAweDVhOiB7YmFzZTogMHg5OCwgYmw6IDB4OTQsIGJyOiAweDk0fSxcbi8vICAgICAweDViOiB7YmFzZTogMHg4MCwgdGw6IDB4ZmQsIHRyOiAweGZjfSxcbi8vICAgICAweDVjOiB7YmFzZTogMHg4MCwgYmw6IDB4ZmYsIGJyOiAweGZlfSxcbi8vICAgICAweDVkOiB7YmFzZTogMHg4MCwgdHI6IDB4ZmYsIGJyOiAweGZkfSxcbi8vICAgICAweDVlOiB7YmFzZTogMHg4MCwgdGw6IDB4ZmUsIGJsOiAweGZjfSxcbi8vICAgICAweDYzOiAweDcxLFxuLy8gICAgIDB4Njg6IDB4NzAsXG4vLyAgICAgMHg2OTogMHg2MCxcbi8vICAgICAweDZhOiAweDY1LFxuLy8gICAgIDB4NmM6IDB4NzAsXG4vLyAgICAgMHg2ZTogMHg3Nixcbi8vICAgICAweDZmOiAweDc4LFxuLy8gICB9LFxuLy8gfSBhcyBjb25zdDtcblxuLy8gY29uc3QgU0NSRUVOX1JFTUFQUyA9IFtcbi8vICAge3RpbGVzZXRzOiBbMHg5Y10sIHNyYzogMHg1YiwgZGVzdDogMHg1Ziwgc2NyZWVuczogWzB4Y2ZdfSxcbi8vIF07XG4vLyBjb25zdCBbXSA9IFNDUkVFTl9SRU1BUFM7XG5cbi8vIFRPRE8gLSBjb3B5IDVmIDwtIDViIGluIDljLCB0aGVuIHJlbWFwIGluIHNjcmVlbiBjZlxuLy8gICAgICAtIGJldHRlciBub3RhdGlvbj9cbi8vIENvbnNpZGVyIGRvaW5nIHRoaXMgcHJvZ3JhbW1hdGljYWxseSwgdGhvdWdoIHdlJ2Qgd2FudCB0byB1c2Vcbi8vIHRoZSBfYWN0dWFsXyBzY3JlZW4tdGlsZXNldCB1c2FnZXMgcmF0aGVyIHRoYW4gZGVjbGFyZWQgb3B0aW9uc1xuXG4vLyBjbGFzcyBYIHtcbi8vICAgcmVhZG9ubHkgbTogTWV0YXNjcmVlbnM7XG4vLyAgIGNvbnN0cnVjdG9yKHI6IFJvbSkge1xuLy8gICAgIHRoaXMubSA9IG5ldyBNZXRhc2NyZWVucyhyKTtcbi8vICAgfVxuLy8gfVxuXG4vLyBBcHBsaWVzIHRoZSBXaWRlQXJlbmFFeGl0cyBzY3JlZW4gZml4LlxuZXhwb3J0IGZ1bmN0aW9uIHdpZGVBcmVuYUV4aXRzKHJvbTogUm9tKSB7XG4gIGZ1bmN0aW9uIHdpZGVuKGV4aXRzOiBudW1iZXJbXSkge1xuICAgIGV4aXRzLnNwbGljZSgwLCBleGl0cy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgIC4uLm5ldyBTZXQoaXRlcnMuY29uY2F0KFxuICAgICAgICAgICAgICAgICAgICAgLi4uZXhpdHMubWFwKGUgPT4gW2UsIGUgKyAxLCBlIC0gMV0pKSkpO1xuICB9XG5cbiAgLy8gV2lkZW4gdGhlIHRvcCBleGl0cyBvZiB0aGUgc2ltcGxlIGFyZW5hc1xuICBjb25zdCB7XG4gICAgZm9ydHJlc3NBcmVuYV90aHJvdWdoLCBmb3J0cmVzc1RyYXAsXG4gICAgaGFsbE5TLCBoYWxsTlNfYXJlbmEsIGhhbGxOU19hcmVuYVdhbGwsIGhhbGxOU19lbnRyYW5jZSxcbiAgfSA9IHJvbS5tZXRhc2NyZWVucztcbiAgaGFsbE5TX2FyZW5hLnNjcmVlbi5zZXQyZCgweDA0LCBbXG4gICAgWzB4OTcsIDB4NzYsIDB4MjIsIDB4MjMsIDB4MjMsIDB4MjMsIDB4NGIsIDB4OTVdLFxuICAgIFsweDQyLCAweDQ4LCAweDIyLCAweDIxLCAweDIzLCAweDIzLCAweDQ1LCAweDQyXSxcbiAgICBbMHg0MywgMHg0OSwgMHgyZSwgMHgyMywgMHgyMywgMHgyMSwgMHg0NiwgMHg0M10sXG4gICAgWzB4NDQsIDB4NGEsIDB4MmUsIDB4MjMsIDB4MjEsIDB4MjEsIDB4NDcsIDB4NDRdLFxuICBdKTtcbiAgaGFsbE5TX2FyZW5hLnNldEdyaWRUaWxlKCcgYyB8IGEgfCBjICcpOyAvLywgJyBjIHwgYSB8IHcgJyk7XG4gIHdpZGVuKGhhbGxOU19hcmVuYS5maW5kRXhpdEJ5VHlwZSgnZWRnZTp0b3AnKS5leGl0cyBhcyBudW1iZXJbXSk7XG5cbiAgaGFsbE5TX2FyZW5hV2FsbC5zY3JlZW4uc2V0MmQoMHgwNCwgW1xuICAgIFsweDk0LCAweDRjLCAweDIyLCAweDIxLCAweDIxLCAweDIxLCAweDRiLCAweDkzXSxcbiAgICBbMHg5NywgMHg0ZiwgMHgwMCwgMHgwMSwgMHgwMSwgMHgwMiwgMHg1MCwgMHg5NV0sXG4gIF0pO1xuICBoYWxsTlNfYXJlbmFXYWxsLnNldEdyaWRUaWxlKCcgYyB8IGEgfCBjICcpO1xuICB3aWRlbihoYWxsTlNfYXJlbmFXYWxsLmZpbmRFeGl0QnlUeXBlKCdlZGdlOnRvcCcpLmV4aXRzIGFzIG51bWJlcltdKTtcblxuICAvLyBNb3ZlIHRoZSBhYmR1Y3Rpb24gdHJpZ2dlciBkb3duIDMgdGlsZXMgc28geW91IGNhbid0IHdhbGsgYXJvdW5kIGl0XG4gIGNvbnN0IGFiZHVjdGlvblRyaWdnZXIgPVxuICAgICAgcm9tLmxvY2F0aW9ucy5aZWJ1Q2F2ZS5zcGF3bnMuZmluZChzID0+IHMuaXNUcmlnZ2VyKCkgJiYgcy5pZCA9PT0gMHg4Yyk7XG4gIGlmIChhYmR1Y3Rpb25UcmlnZ2VyKSBhYmR1Y3Rpb25UcmlnZ2VyLnl0ICs9IDQ7XG5cbiAgLy8gV2lkZW4gdGhlIHRvcCBleGl0cyBvZiB0aGUgZm9ydHJlc3MvcHlyYW1pZCBhcmVuYXNcbiAgZm9ydHJlc3NBcmVuYV90aHJvdWdoLnNjcmVlbi5zZXQyZCgweDA1LCBbXG4gICAgWzB4NWYsIDB4MjIsIDB4MjEsIDB4MjEsIDB4MjEsIDB4NWZdLFxuICAgIFsweGI3LCAweDIyLCAweDIxLCAweDIxLCAweDIxLCAweGI1XSxcbiAgICBbMHhiZiwgMHgyMiwgMHgyMSwgMHgyMSwgMHgyMSwgMHhhOF0sXG4gIF0pO1xuICBmb3J0cmVzc0FyZW5hX3Rocm91Z2guc2V0R3JpZFRpbGUoJyBjIHwgYSB8IHcgJyk7XG4gIHdpZGVuKGZvcnRyZXNzQXJlbmFfdGhyb3VnaC5maW5kRXhpdEJ5VHlwZSgnZWRnZTp0b3AnKS5leGl0cyBhcyBudW1iZXJbXSk7XG5cbiAgLy8gV2lkZW4gdGhlIGJvdHRvbSBlbnRyYW5jZSBvZiBzYWJlcmEncyB0cmFwXG4gIGZvcnRyZXNzVHJhcC5zY3JlZW4uc2V0MmQoMHhjNCwgW1xuICAgIFsweDNjLCAweDNkLCAweDIxLCAweDIxLCAweDIxLCAweDIxLCAweDNiLCAweDNjXSxcbiAgICBbMHg5MiwgMHg0YywgMHgyMiwgMHgyMSwgMHgyMSwgMHgyMSwgMHg0YiwgMHg5MF0sXG4gICAgWzB4OTQsIDB4NGMsIDB4MjIsIDB4MjEsIDB4MjEsIDB4MjEsIDB4NGIsIDB4OTNdLFxuICBdKTtcbiAgZm9ydHJlc3NUcmFwLnNldEdyaWRUaWxlKCcgICB8IHggfCBjICcpO1xuICB3aWRlbihmb3J0cmVzc1RyYXAuZmluZEV4aXRCeVR5cGUoJ2VkZ2U6Ym90dG9tJykuZXhpdHMgYXMgbnVtYmVyW10pO1xuXG4gIC8vIEZpbmQgY2FzZXMgd2hlcmUgYSBuYXJyb3cgaGFsbHdheSB3YXMgdXNlZCBvbiB0b3BcbiAgLy8gb2YgYW4gYXJlbmEgYW5kIHJlcGxhY2Ugd2l0aCBhIG5vcm1hbCBoYWxsd2F5XG4gIGZvciAoY29uc3QgbG9jYXRpb24gb2Ygcm9tLmxvY2F0aW9ucykge1xuICAgIGNvbnN0IG1ldGEgPSBsb2NhdGlvbi5tZXRhO1xuICAgIGZvciAoY29uc3QgcG9zIG9mIG1ldGEuYWxsUG9zKCkpIHtcbiAgICAgIGNvbnN0IHNjciA9IG1ldGEuZ2V0KHBvcyk7XG4gICAgICBpZiAoc2NyID09PSBoYWxsTlNfZW50cmFuY2UgJiYgbWV0YS5nZXQocG9zICsgMTYpPy5oYXNGZWF0dXJlKCdhcmVuYScpKSB7XG4gICAgICAgIG1ldGEuc2V0KHBvcywgaGFsbE5TKTtcbiAgICAgICAgLy8gYWxzbyBzZXQgdGhlIG5vbi1tZXRhIHZlcnNpb24sIG1haW5seSBmb3IgbWFwIHZpZXdlclxuICAgICAgICBjb25zdCByb3cgPSBsb2NhdGlvbi5zY3JlZW5zW3BvcyA+Pj4gNF07XG4gICAgICAgIGlmIChyb3cpIHJvd1twb3MgJiAweGZdID0gaGFsbE5TLnNpZDtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiJdfQ==