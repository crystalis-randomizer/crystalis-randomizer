export function TileId(x) { return x; }
(function (TileId) {
    function from({ id }, { x, y }) {
        const xs = x >>> 8;
        const xt = (x >>> 4) & 0xf;
        const ys = y >>> 8;
        const yt = (y >>> 4) & 0xf;
        return (id << 16 | ys << 12 | xs << 8 | yt << 4 | xt);
    }
    TileId.from = from;
    function add(tile, dy, dx) {
        let t = tile;
        if (dy) {
            let y = (t & 0xf0) + (dy << 4);
            while (y >= 0xf0) {
                if ((t & 0xf000) >= 0xf000)
                    return -1;
                y -= 0xf0;
                t += 0x1000;
            }
            while (y < 0) {
                if (!(t & 0xf000))
                    return -1;
                y += 0xf0;
                t -= 0x1000;
            }
            t = t & ~0xf0 | y;
        }
        if (dx) {
            let x = (t & 0xf) + dx;
            while (x >= 0x10) {
                if ((t & 0xf00) >= 0x700)
                    return -1;
                x -= 0x10;
                t += 0x100;
            }
            while (x < 0) {
                if (!(t & 0xf00))
                    return -1;
                x += 0x10;
                t -= 0x100;
            }
            t = t & ~0xf | x;
        }
        return t;
    }
    TileId.add = add;
})(TileId || (TileId = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGlsZWlkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2pzL2xvZ2ljL3RpbGVpZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFNQSxNQUFNLFVBQVUsTUFBTSxDQUFDLENBQVMsSUFBWSxPQUFPLENBQVcsQ0FBQyxDQUFDLENBQUM7QUFDakUsV0FBaUIsTUFBTTtJQUNyQixTQUFnQixJQUFJLENBQUMsRUFBQyxFQUFFLEVBQVcsRUFBRSxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQWE7UUFDckQsTUFBTSxFQUFFLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNuQixNQUFNLEVBQUUsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7UUFDM0IsTUFBTSxFQUFFLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNuQixNQUFNLEVBQUUsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7UUFDM0IsT0FBTyxDQUFDLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFXLENBQUM7SUFDbEUsQ0FBQztJQU5lLFdBQUksT0FNbkIsQ0FBQTtJQUNELFNBQWdCLEdBQUcsQ0FBQyxJQUFZLEVBQUUsRUFBVSxFQUFFLEVBQVU7UUFDdEQsSUFBSSxDQUFDLEdBQVcsSUFBSSxDQUFDO1FBQ3JCLElBQUksRUFBRSxFQUFFO1lBQ04sSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDL0IsT0FBTyxDQUFDLElBQUksSUFBSSxFQUFFO2dCQUNoQixJQUFJLENBQUMsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxJQUFJLE1BQU07b0JBQUUsT0FBTyxDQUFDLENBQVcsQ0FBQztnQkFDaEQsQ0FBQyxJQUFJLElBQUksQ0FBQztnQkFDVixDQUFDLElBQUksTUFBTSxDQUFDO2FBQ2I7WUFDRCxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUU7Z0JBQ1osSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLE1BQU0sQ0FBQztvQkFBRSxPQUFPLENBQUMsQ0FBVyxDQUFDO2dCQUN2QyxDQUFDLElBQUksSUFBSSxDQUFBO2dCQUNULENBQUMsSUFBSSxNQUFNLENBQUM7YUFDYjtZQUNELENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDO1NBQ25CO1FBQ0QsSUFBSSxFQUFFLEVBQUU7WUFDTixJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUM7WUFDdkIsT0FBTyxDQUFDLElBQUksSUFBSSxFQUFFO2dCQUNoQixJQUFJLENBQUMsQ0FBQyxHQUFHLEtBQUssQ0FBQyxJQUFJLEtBQUs7b0JBQUUsT0FBTyxDQUFDLENBQVcsQ0FBQztnQkFDOUMsQ0FBQyxJQUFJLElBQUksQ0FBQztnQkFDVixDQUFDLElBQUksS0FBSyxDQUFDO2FBQ1o7WUFDRCxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUU7Z0JBQ1osSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLEtBQUssQ0FBQztvQkFBRSxPQUFPLENBQUMsQ0FBVyxDQUFDO2dCQUN0QyxDQUFDLElBQUksSUFBSSxDQUFBO2dCQUNULENBQUMsSUFBSSxLQUFLLENBQUM7YUFDWjtZQUNELENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDO1NBQ2xCO1FBQ0QsT0FBTyxDQUFXLENBQUM7SUFDckIsQ0FBQztJQS9CZSxVQUFHLE1BK0JsQixDQUFBO0FBQ0gsQ0FBQyxFQXhDZ0IsTUFBTSxLQUFOLE1BQU0sUUF3Q3RCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtMb2NhdGlvbn0gZnJvbSAnLi4vcm9tL2xvY2F0aW9uLmpzJztcblxuLy8gMjQtYml0IHVuaXF1ZSBJRCBmb3IgYSBzaW5nbGUgdGlsZTpcbi8vICAgTExMTExMTEwgWVlZWVhYWFggeXl5eXh4eHhcbi8vIHdoZXJlIEwgaXMgOC1iaXQgbG9jYXRpb24gSUQsIChZLCBYKSBpcyBzY3JlZW4sIGFuZCAoeSwgeCkgaXMgdGlsZS5cbmV4cG9ydCB0eXBlIFRpbGVJZCA9IG51bWJlciAmIHtfX3RpbGVJZF9fOiBuZXZlcn07XG5leHBvcnQgZnVuY3Rpb24gVGlsZUlkKHg6IG51bWJlcik6IFRpbGVJZCB7IHJldHVybiB4IGFzIFRpbGVJZDsgfVxuZXhwb3J0IG5hbWVzcGFjZSBUaWxlSWQge1xuICBleHBvcnQgZnVuY3Rpb24gZnJvbSh7aWR9OiBMb2NhdGlvbiwge3gsIHl9OiBDb29yZGluYXRlKTogVGlsZUlkIHtcbiAgICBjb25zdCB4cyA9IHggPj4+IDg7XG4gICAgY29uc3QgeHQgPSAoeCA+Pj4gNCkgJiAweGY7XG4gICAgY29uc3QgeXMgPSB5ID4+PiA4O1xuICAgIGNvbnN0IHl0ID0gKHkgPj4+IDQpICYgMHhmO1xuICAgIHJldHVybiAoaWQgPDwgMTYgfCB5cyA8PCAxMiB8IHhzIDw8IDggfCB5dCA8PCA0IHwgeHQpIGFzIFRpbGVJZDtcbiAgfVxuICBleHBvcnQgZnVuY3Rpb24gYWRkKHRpbGU6IFRpbGVJZCwgZHk6IG51bWJlciwgZHg6IG51bWJlcik6IFRpbGVJZCB7XG4gICAgbGV0IHQ6IG51bWJlciA9IHRpbGU7XG4gICAgaWYgKGR5KSB7XG4gICAgICBsZXQgeSA9ICh0ICYgMHhmMCkgKyAoZHkgPDwgNCk7XG4gICAgICB3aGlsZSAoeSA+PSAweGYwKSB7XG4gICAgICAgIGlmICgodCAmIDB4ZjAwMCkgPj0gMHhmMDAwKSByZXR1cm4gLTEgYXMgVGlsZUlkO1xuICAgICAgICB5IC09IDB4ZjA7XG4gICAgICAgIHQgKz0gMHgxMDAwO1xuICAgICAgfVxuICAgICAgd2hpbGUgKHkgPCAwKSB7XG4gICAgICAgIGlmICghKHQgJiAweGYwMDApKSByZXR1cm4gLTEgYXMgVGlsZUlkO1xuICAgICAgICB5ICs9IDB4ZjBcbiAgICAgICAgdCAtPSAweDEwMDA7XG4gICAgICB9XG4gICAgICB0ID0gdCAmIH4weGYwIHwgeTtcbiAgICB9XG4gICAgaWYgKGR4KSB7XG4gICAgICBsZXQgeCA9ICh0ICYgMHhmKSArIGR4O1xuICAgICAgd2hpbGUgKHggPj0gMHgxMCkge1xuICAgICAgICBpZiAoKHQgJiAweGYwMCkgPj0gMHg3MDApIHJldHVybiAtMSBhcyBUaWxlSWQ7XG4gICAgICAgIHggLT0gMHgxMDtcbiAgICAgICAgdCArPSAweDEwMDtcbiAgICAgIH1cbiAgICAgIHdoaWxlICh4IDwgMCkge1xuICAgICAgICBpZiAoISh0ICYgMHhmMDApKSByZXR1cm4gLTEgYXMgVGlsZUlkO1xuICAgICAgICB4ICs9IDB4MTBcbiAgICAgICAgdCAtPSAweDEwMDtcbiAgICAgIH1cbiAgICAgIHQgPSB0ICYgfjB4ZiB8IHg7XG4gICAgfVxuICAgIHJldHVybiB0IGFzIFRpbGVJZDtcbiAgfVxufVxuXG4vLyBJbXBsZW1lbnRlZCBieSBFbnRyYW5jZSwgRXhpdCwgU3Bhd24sIGV0Yy4uLlxuaW50ZXJmYWNlIENvb3JkaW5hdGUge1xuICB4OiBudW1iZXI7XG4gIHk6IG51bWJlcjtcbn1cbiJdfQ==