import { Grid } from './grid.js';
import { Multiset } from '../util.js';
import { UnionFind } from '../unionfind.js';
export class Monogrid {
    constructor(h, w, valid) {
        this.h = h;
        this.w = w;
        this.valid = valid;
        this.fixed = new Set();
        this.size = 0;
        this.data = new Uint8Array(h * w);
    }
    fill() {
        for (let y = 0; y < this.h; y++) {
            for (let x = 0; x < this.w; x++) {
                const i = y * this.w + x;
                if (y > 0)
                    this.data[i] |= 1;
                if (x > 0)
                    this.data[i] |= 2;
                if (y < this.h - 1)
                    this.data[i] |= 4;
                if (x < this.w - 1)
                    this.data[i] |= 8;
            }
        }
    }
    isBorder(i, dir) {
        const x = i % this.w;
        const y = (i - x) / this.w;
        return this.isBorder2(y, x, dir);
    }
    isBorder2(y, x, dir) {
        if (dir === 0)
            return !y;
        if (dir === 1)
            return !x;
        if (dir === 2)
            return y >= this.h - 1;
        if (dir === 3)
            return x >= this.w - 1;
        throw new Error('bad direction');
    }
    delete2(y, x, i = y * this.w + x) {
        if (this.fixed.has(i))
            return false;
        const repl = new Map();
        repl.set(i, 0);
        for (let dir = 0; dir < 4; dir++) {
            if (this.isBorder2(y, x, dir))
                continue;
            const neighbor = i + this.delta(dir);
            const prev = this.data[neighbor];
            const next = prev & ~(1 << (dir ^ 2));
            if (prev !== next) {
                if (this.fixed.has(neighbor))
                    return false;
                repl.set(neighbor, next);
            }
        }
        return this.try(repl);
    }
    delete(i) {
        const x = i % this.w;
        const y = (i - x) / this.w;
        return this.delete2(y, x, i);
    }
    deleteEdge2(y, x, dir, i0 = y * this.w + x) {
        if (this.fixed.has(i0))
            return false;
        if (this.isBorder2(y, x, dir)) {
            this.data[i0] &= ~(1 << dir);
            return true;
        }
        const repl = new Map();
        const i1 = i0 + this.delta(dir);
        if (this.fixed.has(i1))
            return false;
        repl.set(i0, this.data[i0] & ~(1 << dir));
        repl.set(i1, this.data[i1] & ~(1 << (dir ^ 2)));
        return this.try(repl);
    }
    deleteEdge(i, dir) {
        const x = i % this.w;
        const y = (i - x) / this.w;
        return this.deleteEdge2(y, x, dir, i);
    }
    refine(random, target) {
        let count = 0;
        const all = new Set();
        for (let i = 0; i < this.data.length; i++) {
            if (this.data[i])
                count++;
            if (!this.fixed.has(i))
                all.add(i);
        }
        while (count > target) {
            let found = false;
            for (const pos of random.ishuffle(all)) {
                if (count <= target)
                    break;
                const scr = this.data[pos];
                if (!scr) {
                    count--;
                    continue;
                }
                if (this.delete(pos)) {
                    found = true;
                    count--;
                }
            }
            if (!found)
                return false;
        }
        return true;
    }
    validate() {
        for (let y = 0; y < this.h; y++) {
            for (let x = 0; x < this.w; x++) {
                const i = y * this.w + x;
                const v = this.data[i];
                if (y && !(this.data[i - this.w] & 4) !== !(v & 1)) {
                    throw new Error(`invalid above ${y}${x}`);
                }
                if (x && !(this.data[i - 1] & 8) !== !(v & 2)) {
                    throw new Error(`invalid left of ${y}${x}`);
                }
            }
        }
    }
    addEdge(y, x, dir) {
        const i = y * this.w + x;
        this.data[i] |= 1 << dir;
        if (!this.isBorder2(y, x, dir)) {
            this.data[i + this.delta(dir)] |= 1 << (dir ^ 2);
        }
    }
    consolidate(random, target) {
        const counts = new Multiset();
        for (let i = 0; i < this.data.length; i++) {
            if (!this.fixed.has(i) && this.data[i])
                counts.add(this.data[i]);
        }
        let attempts = 1000;
        while (counts.unique() > target && --attempts) {
            const sorted = [...counts].sort((a, b) => b[1] - a[1]);
            const threshold = sorted[target][1];
            const bad = new Set(sorted.filter(a => a[1] <= threshold).map(x => x[0]));
            const eligible = this.findEligibleConsolidates(bad);
            if (!eligible.length)
                return [];
            for (const [i, s] of random.pick(eligible)) {
                if (this.data[i])
                    counts.delete(this.data[i]);
                if (s)
                    counts.add(s);
                this.data[i] = s;
            }
        }
        if (!attempts)
            return [];
        return [...counts].map(x => x[0]);
    }
    consolidateFixed(random, bad) {
        const counts = new Multiset();
        for (let i = 0; i < this.data.length; i++) {
            const scr = this.data[i];
            if (!this.fixed.has(i) && bad.has(scr))
                counts.add(scr);
        }
        let attempts = 1000;
        while (counts.unique() && --attempts) {
            const eligible = this.findEligibleConsolidates(bad);
            if (!eligible.length)
                return false;
            for (const [i, s] of random.pick(eligible)) {
                const scr = this.data[i];
                if (bad.has(scr))
                    counts.delete(scr);
                if (bad.has(s))
                    counts.add(s);
                this.data[i] = s;
            }
        }
        if (!attempts)
            return false;
        return true;
    }
    findEligibleConsolidates(bad) {
        const eligible = [];
        const best = [];
        for (let i = 0; i < this.data.length; i++) {
            if (this.fixed.has(i))
                continue;
            const scr0 = this.data[i];
            if (!bad.has(scr0))
                continue;
            for (let dir = 0; dir < 4; dir++) {
                if (this.isBorder(i, dir))
                    continue;
                const delta = this.delta(dir);
                if (this.fixed.has(i + delta))
                    continue;
                const mask0 = 1 << dir;
                if (bad.has(scr0 ^ mask0))
                    continue;
                const mask1 = 1 << (dir ^ 2);
                const scr1 = this.data[i + delta];
                const repl = new Map([[i, scr0 ^ mask0], [i + delta, scr1 ^ mask1]]);
                if (!this.check(repl))
                    continue;
                eligible.push(repl);
                if (!bad.has(scr1 ^ mask1) && bad.has(scr1)) {
                    best.push(repl);
                    break;
                }
            }
        }
        return best.length ? best : eligible;
    }
    try(map) {
        if (!this.check(map))
            return false;
        for (const [i, v] of map) {
            this.data[i] = v;
        }
        return true;
    }
    check(map) {
        var _a;
        const uf = new UnionFind();
        for (let y = 0; y < this.h; y++) {
            for (let x = 0; x < this.w; x++) {
                const i = y * this.w + x;
                const s = (_a = map === null || map === void 0 ? void 0 : map.get(i)) !== null && _a !== void 0 ? _a : this.data[i];
                if (s)
                    uf.union([i]);
                if (y > 0 && (s & 1))
                    uf.union([i, i - this.w]);
                if (x > 0 && (s & 2))
                    uf.union([i, i - 1]);
                if (y < this.h - 1 && (s & 4))
                    uf.union([i, i + this.w]);
                if (x < this.w - 1 && (s & 8))
                    uf.union([i, i + 1]);
            }
        }
        return uf.roots().length === 1;
    }
    addPath(random, maxSize) {
        var _a, _b;
        let y;
        let x;
        if (!this.size) {
            y = random.nextInt(this.h);
            x = random.nextInt(this.w);
        }
        else {
            const eligible = [];
            for (let i = 0; i < this.data.length; i++) {
                if (this.data[i] && this.data[i] !== 0xf)
                    eligible.push(i);
            }
            if (!eligible.length)
                return false;
            const p = random.pick(eligible);
            x = p % this.w;
            y = (p - x) / this.w;
        }
        const path = new Map();
        let i = y * this.w + x;
        let len = 0;
        let ok = true;
        while (true) {
            let closed = false;
            const prev = (_a = path.get(i)) !== null && _a !== void 0 ? _a : this.data[i];
            let found = false;
            for (let dir of random.ishuffle([0, 1, 2, 3])) {
                const mask = (1 << dir);
                if (prev & mask)
                    continue;
                const next = prev | mask;
                if (this.valid && !this.valid.has(next))
                    continue;
                const y1 = y + DY[dir];
                const x1 = x + DX[dir];
                if (y1 < 0 || x1 < 0 || y1 >= this.h || x1 >= this.w)
                    continue;
                const i1 = y1 * this.w + x1;
                const prev1 = (_b = path.get(i1)) !== null && _b !== void 0 ? _b : this.data[i1];
                const next1 = prev1 | (1 << (dir ^ 2));
                if (prev1) {
                    if (prev1 === next1 || (this.valid && !this.valid.has(next1))) {
                        continue;
                    }
                    closed = true;
                }
                ok = !this.valid || this.valid.has(next1);
                path.set(i, next);
                path.set(i1, next1);
                x = x1;
                y = y1;
                i = i1;
                found = true;
                break;
            }
            if (!found)
                break;
            if (closed || this.data[i])
                break;
            if (!this.size++)
                this.size++;
            if (ok && maxSize && this.size >= maxSize)
                break;
            if (ok && random.nextInt(15) < len++)
                break;
        }
        if (!path.size || !ok)
            return false;
        for (const [i, v] of path) {
            this.data[i] = v;
        }
        return true;
    }
    toGrid(char) {
        const g = new Grid(this.h, this.w);
        for (let y = 0; y < this.h; y++) {
            for (let x = 0; x < this.w; x++) {
                const i = y * this.w + x;
                const s = this.data[i];
                if (!s)
                    continue;
                const c = (y << 12 | x << 4 | 0x808);
                g.set(c, char);
                for (let dir = 0; dir < 4; dir++) {
                    if (!(s & (1 << dir)))
                        continue;
                    const delta = dir & 1 ? 8 : 0x800;
                    g.set((dir & 2 ? c + delta : c - delta), char);
                }
            }
        }
        return g;
    }
    delta(dir) {
        return (dir & 2 ? 1 : -1) * (dir & 1 ? 1 : this.w);
    }
    show() {
        const lines = [];
        for (let y = 0; y < this.h; y++) {
            let line = '';
            for (let x = 0; x < this.w; x++) {
                line += ' ╵╴┘╷│┐┤╶└─┴┌├┬┼'[this.data[y * this.w + x]];
            }
            lines.push(line);
        }
        return lines.join('\n');
    }
}
export class Cursor {
    constructor(grid, y, x) {
        this.grid = grid;
        this._i = y * grid.w + x;
    }
    get x() { return this._i % this.grid.w; }
    ;
    get y() { return Math.floor(this._i / this.grid.w); }
    go(dir) {
        const delta = this.grid.delta(dir);
        const i1 = this._i + delta;
        const mask0 = 1 << dir;
        const mask1 = 1 << (dir ^ 2);
        this.grid.data[this._i] |= mask0;
        this.grid.data[this._i = i1] |= mask1;
    }
    directedPath(random, y, x) {
        while (true) {
            const y0 = this.y;
            const x0 = this.x;
            const dirs = [];
            if (y < y0)
                dirs.push(0);
            if (x < x0)
                dirs.push(1);
            if (y > y0)
                dirs.push(2);
            if (x > x0)
                dirs.push(3);
            if (!dirs.length)
                return;
            this.go(random.pick(dirs));
        }
    }
}
const DY = [-1, 0, 1, 0];
const DX = [0, -1, 0, 1];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9ub2dyaWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvanMvbWF6ZS9tb25vZ3JpZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUUsSUFBSSxFQUFhLE1BQU0sV0FBVyxDQUFDO0FBQzVDLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFDdEMsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBRzVDLE1BQU0sT0FBTyxRQUFRO0lBTW5CLFlBQXFCLENBQVMsRUFBVyxDQUFTLEVBQzdCLEtBQW1CO1FBRG5CLE1BQUMsR0FBRCxDQUFDLENBQVE7UUFBVyxNQUFDLEdBQUQsQ0FBQyxDQUFRO1FBQzdCLFVBQUssR0FBTCxLQUFLLENBQWM7UUFKeEMsVUFBSyxHQUFHLElBQUksR0FBRyxFQUFVLENBQUM7UUFDMUIsU0FBSSxHQUFHLENBQUMsQ0FBQztRQUlQLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxVQUFVLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFHRCxJQUFJO1FBQ0YsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7WUFDL0IsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7Z0JBQy9CLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDekIsSUFBSSxDQUFDLEdBQUcsQ0FBQztvQkFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDN0IsSUFBSSxDQUFDLEdBQUcsQ0FBQztvQkFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENB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QUcsRUFBRTtnQkFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3pCLElBQUksQ0FBQyxHQUFHLEVBQUU7Z0JBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN6QixJQUFJLENBQUMsR0FBRyxFQUFFO2dCQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDekIsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNO2dCQUFFLE9BQU87WUFDekIsSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7U0FDNUI7SUFDSCxDQUFDO0NBQ0Y7QUFFRCxNQUFNLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDekIsTUFBTSxFQUFFLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUmFuZG9tIH0gZnJvbSAnLi4vcmFuZG9tLmpzJztcbmltcG9ydCB7IEdyaWQsIEdyaWRDb29yZCB9IGZyb20gJy4vZ3JpZC5qcyc7XG5pbXBvcnQgeyBNdWx0aXNldCB9IGZyb20gJy4uL3V0aWwuanMnO1xuaW1wb3J0IHsgVW5pb25GaW5kIH0gZnJvbSAnLi4vdW5pb25maW5kLmpzJztcblxuLyoqIEEgc2ltcGxlciBncmlkIG9mIGEgc2luZ2xlIHR5cGUgb2YgZWRnZS4gKi9cbmV4cG9ydCBjbGFzcyBNb25vZ3JpZCB7XG4gIC8qKiBFbGVtZW50cyBhcmUgMC4uZi4gKi9cbiAgZGF0YTogVWludDhBcnJheTtcbiAgZml4ZWQgPSBuZXcgU2V0PG51bWJlcj4oKTtcbiAgc2l6ZSA9IDA7XG5cbiAgY29uc3RydWN0b3IocmVhZG9ubHkgaDogbnVtYmVyLCByZWFkb25seSB3OiBudW1iZXIsXG4gICAgICAgICAgICAgIHJlYWRvbmx5IHZhbGlkPzogU2V0PG51bWJlcj4pIHtcbiAgICB0aGlzLmRhdGEgPSBuZXcgVWludDhBcnJheShoICogdyk7XG4gIH1cblxuICAvKiogRmlsbCB0aGUgZ3JpZC4gKi9cbiAgZmlsbCgpIHtcbiAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHRoaXMuaDsgeSsrKSB7XG4gICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHRoaXMudzsgeCsrKSB7XG4gICAgICAgIGNvbnN0IGkgPSB5ICogdGhpcy53ICsgeDtcbiAgICAgICAgaWYgKHkgPiAwKSB0aGlzLmRhdGFbaV0gfD0gMTtcbiAgICAgICAgaWYgKHggPiAwKSB0aGlzLmRhdGFbaV0gfD0gMjtcbiAgICAgICAgaWYgKHkgPCB0aGlzLmggLSAxKSB0aGlzLmRhdGFbaV0gfD0gNDtcbiAgICAgICAgaWYgKHggPCB0aGlzLncgLSAxKSB0aGlzLmRhdGFbaV0gfD0gODtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gVE9ETyAtIGNoZWNrIHZhbGlkP1xuICB9XG5cbiAgaXNCb3JkZXIoaTogbnVtYmVyLCBkaXI6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHggPSBpICUgdGhpcy53O1xuICAgIGNvbnN0IHkgPSAoaSAtIHgpIC8gdGhpcy53O1xuICAgIHJldHVybiB0aGlzLmlzQm9yZGVyMih5LCB4LCBkaXIpO1xuICB9XG5cbiAgaXNCb3JkZXIyKHk6IG51bWJlciwgeDogbnVtYmVyLCBkaXI6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgIGlmIChkaXIgPT09IDApIHJldHVybiAheTtcbiAgICBpZiAoZGlyID09PSAxKSByZXR1cm4gIXg7XG4gICAgaWYgKGRpciA9PT0gMikgcmV0dXJuIHkgPj0gdGhpcy5oIC0gMTtcbiAgICBpZiAoZGlyID09PSAzKSByZXR1cm4geCA+PSB0aGlzLncgLSAxO1xuICAgIHRocm93IG5ldyBFcnJvcignYmFkIGRpcmVjdGlvbicpO1xuICB9XG5cbiAgLy8gRGVsZXRlIGEgc2NyZWVuLlxuICBkZWxldGUyKHk6IG51bWJlciwgeDogbnVtYmVyLCBpID0geSAqIHRoaXMudyArIHgpOiBib29sZWFuIHtcbiAgICBpZiAodGhpcy5maXhlZC5oYXMoaSkpIHJldHVybiBmYWxzZTtcbiAgICBjb25zdCByZXBsID0gbmV3IE1hcDxudW1iZXIsIG51bWJlcj4oKTtcbiAgICByZXBsLnNldChpLCAwKTtcbiAgICBmb3IgKGxldCBkaXIgPSAwOyBkaXIgPCA0OyBkaXIrKykge1xuICAgICAgaWYgKHRoaXMuaXNCb3JkZXIyKHksIHgsIGRpcikpIGNvbnRpbnVlO1xuICAgICAgY29uc3QgbmVpZ2hib3IgPSBpICsgdGhpcy5kZWx0YShkaXIpO1xuICAgICAgY29uc3QgcHJldiA9IHRoaXMuZGF0YVtuZWlnaGJvcl07XG4gICAgICBjb25zdCBuZXh0ID0gcHJldiAmIH4oMSA8PCAoZGlyIF4gMikpO1xuICAgICAgaWYgKHByZXYgIT09IG5leHQpIHtcbiAgICAgICAgaWYgKHRoaXMuZml4ZWQuaGFzKG5laWdoYm9yKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXBsLnNldChuZWlnaGJvciwgbmV4dCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnRyeShyZXBsKTtcbiAgfVxuXG4gIGRlbGV0ZShpOiBudW1iZXIpOiBib29sZWFuIHtcbiAgICBjb25zdCB4ID0gaSAlIHRoaXMudztcbiAgICBjb25zdCB5ID0gKGkgLSB4KSAvIHRoaXMudztcbiAgICByZXR1cm4gdGhpcy5kZWxldGUyKHksIHgsIGkpO1xuICB9XG5cbiAgLy8gRGVsZXRlIGFuIGVkZ2UuXG4gIGRlbGV0ZUVkZ2UyKHk6IG51bWJlciwgeDogbnVtYmVyLCBkaXI6IG51bWJlciwgaTAgPSB5ICogdGhpcy53ICsgeCk6IGJvb2xlYW4ge1xuICAgIGlmICh0aGlzLmZpeGVkLmhhcyhpMCkpIHJldHVybiBmYWxzZTtcbiAgICBpZiAodGhpcy5pc0JvcmRlcjIoeSwgeCwgZGlyKSkge1xuICAgICAgdGhpcy5kYXRhW2kwXSAmPSB+KDEgPDwgZGlyKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBjb25zdCByZXBsID0gbmV3IE1hcDxudW1iZXIsIG51bWJlcj4oKTtcbiAgICBjb25zdCBpMSA9IGkwICsgdGhpcy5kZWx0YShkaXIpO1xuICAgIGlmICh0aGlzLmZpeGVkLmhhcyhpMSkpIHJldHVybiBmYWxzZTtcbiAgICByZXBsLnNldChpMCwgdGhpcy5kYXRhW2kwXSAmIH4oMSA8PCBkaXIpKTtcbiAgICByZXBsLnNldChpMSwgdGhpcy5kYXRhW2kxXSAmIH4oMSA8PCAoZGlyIF4gMikpKTtcbiAgICByZXR1cm4gdGhpcy50cnkocmVwbCk7XG4gIH1cblxuICBkZWxldGVFZGdlKGk6IG51bWJlciwgZGlyOiBudW1iZXIpOiBib29sZWFuIHtcbiAgICBjb25zdCB4ID0gaSAlIHRoaXMudztcbiAgICBjb25zdCB5ID0gKGkgLSB4KSAvIHRoaXMudztcbiAgICByZXR1cm4gdGhpcy5kZWxldGVFZGdlMih5LCB4LCBkaXIsIGkpO1xuICB9XG5cbiAgcmVmaW5lKHJhbmRvbTogUmFuZG9tLCB0YXJnZXQ6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgIGxldCBjb3VudCA9IDA7XG4gICAgY29uc3QgYWxsID0gbmV3IFNldDxudW1iZXI+KCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLmRhdGFbaV0pIGNvdW50Kys7XG4gICAgICBpZiAoIXRoaXMuZml4ZWQuaGFzKGkpKSBhbGwuYWRkKGkpO1xuICAgIH1cbiAgICAvLyBGaW5kIHNjcmVlbnMgdG8gZGVsZXRlXG4gICAgd2hpbGUgKGNvdW50ID4gdGFyZ2V0KSB7XG4gICAgICBsZXQgZm91bmQgPSBmYWxzZTtcbiAgICAgIGZvciAoY29uc3QgcG9zIG9mIHJhbmRvbS5pc2h1ZmZsZShhbGwpKSB7XG4gICAgICAgIGlmIChjb3VudCA8PSB0YXJnZXQpIGJyZWFrO1xuICAgICAgICBjb25zdCBzY3IgPSB0aGlzLmRhdGFbcG9zXTtcbiAgICAgICAgaWYgKCFzY3IpIHtcbiAgICAgICAgICBjb3VudC0tO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmRlbGV0ZShwb3MpKSB7XG4gICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgIGNvdW50LS07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghZm91bmQpIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICB2YWxpZGF0ZSgpIHtcbiAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHRoaXMuaDsgeSsrKSB7XG4gICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHRoaXMudzsgeCsrKSB7XG4gICAgICAgIGNvbnN0IGkgPSB5ICogdGhpcy53ICsgeDtcbiAgICAgICAgY29uc3QgdiA9IHRoaXMuZGF0YVtpXTtcbiAgICAgICAgaWYgKHkgJiYgISh0aGlzLmRhdGFbaSAtIHRoaXMud10gJiA0KSAhPT0gISh2ICYgMSkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgYWJvdmUgJHt5fSR7eH1gKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoeCAmJiAhKHRoaXMuZGF0YVtpIC0gMV0gJiA4KSAhPT0gISh2ICYgMikpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgbGVmdCBvZiAke3l9JHt4fWApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gQWRkIGFuIGVkZ2UuXG4gIGFkZEVkZ2UoeTogbnVtYmVyLCB4OiBudW1iZXIsIGRpcjogbnVtYmVyKSB7XG4gICAgY29uc3QgaSA9IHkgKiB0aGlzLncgKyB4O1xuICAgIHRoaXMuZGF0YVtpXSB8PSAxIDw8IGRpcjtcbiAgICBpZiAoIXRoaXMuaXNCb3JkZXIyKHksIHgsIGRpcikpIHtcbiAgICAgIHRoaXMuZGF0YVtpICsgdGhpcy5kZWx0YShkaXIpXSB8PSAxIDw8IChkaXIgXiAyKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWNyb3NzIGFsbCB0aGUgbm9uLWZpeGVkIHNjcmVlbnMsIHJlYXJyYW5nZSB0aGVtIHRvIHJlZHVjZSB0aGUgbnVtYmVyXG4gICAqIG9mIGRpZmZlcmVudCBzY3JlZW5zIHRvIDw9IHRhcmdldC5cbiAgICovXG4gIGNvbnNvbGlkYXRlKHJhbmRvbTogUmFuZG9tLCB0YXJnZXQ6IG51bWJlcik6IG51bWJlcltdIHtcbiAgICBjb25zdCBjb3VudHMgPSBuZXcgTXVsdGlzZXQ8bnVtYmVyPigpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5kYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoIXRoaXMuZml4ZWQuaGFzKGkpICYmIHRoaXMuZGF0YVtpXSkgY291bnRzLmFkZCh0aGlzLmRhdGFbaV0pO1xuICAgIH1cblxuICAgIGxldCBhdHRlbXB0cyA9IDEwMDA7XG4gICAgd2hpbGUgKGNvdW50cy51bmlxdWUoKSA+IHRhcmdldCAmJiAtLWF0dGVtcHRzKSB7XG4gICAgICBjb25zdCBzb3J0ZWQgPSBbLi4uY291bnRzXS5zb3J0KChhLCBiKSA9PiBiWzFdIC0gYVsxXSk7XG4gICAgICBjb25zdCB0aHJlc2hvbGQgPSBzb3J0ZWRbdGFyZ2V0XVsxXTtcbiAgICAgIGNvbnN0IGJhZCA9IG5ldyBTZXQoc29ydGVkLmZpbHRlcihhID0+IGFbMV0gPD0gdGhyZXNob2xkKS5tYXAoeCA9PiB4WzBdKSk7XG4gICAgICBjb25zdCBlbGlnaWJsZSA9IHRoaXMuZmluZEVsaWdpYmxlQ29uc29saWRhdGVzKGJhZCk7XG4gICAgICBpZiAoIWVsaWdpYmxlLmxlbmd0aCkgcmV0dXJuIFtdO1xuICAgICAgZm9yIChjb25zdCBbaSwgc10gb2YgcmFuZG9tLnBpY2soZWxpZ2libGUpKSB7XG4gICAgICAgIGlmICh0aGlzLmRhdGFbaV0pIGNvdW50cy5kZWxldGUodGhpcy5kYXRhW2ldKTtcbiAgICAgICAgaWYgKHMpIGNvdW50cy5hZGQocyk7XG4gICAgICAgIHRoaXMuZGF0YVtpXSA9IHM7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghYXR0ZW1wdHMpIHJldHVybiBbXTtcbiAgICByZXR1cm4gWy4uLmNvdW50c10ubWFwKHggPT4geFswXSk7XG4gIH1cblxuICAvKiogVHJ5IHRvIHJlbW92ZSBhbGwgaW5zdGFuY2VzIG9mIGJhZCBzY3JlZW5zLiAqL1xuICBjb25zb2xpZGF0ZUZpeGVkKHJhbmRvbTogUmFuZG9tLCBiYWQ6IFNldDxudW1iZXI+KTogYm9vbGVhbiB7XG4gICAgY29uc3QgY291bnRzID0gbmV3IE11bHRpc2V0PG51bWJlcj4oKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3Qgc2NyID0gdGhpcy5kYXRhW2ldO1xuICAgICAgaWYgKCF0aGlzLmZpeGVkLmhhcyhpKSAmJiBiYWQuaGFzKHNjcikpIGNvdW50cy5hZGQoc2NyKTtcbiAgICB9XG5cbiAgICBsZXQgYXR0ZW1wdHMgPSAxMDAwO1xuICAgIHdoaWxlIChjb3VudHMudW5pcXVlKCkgJiYgLS1hdHRlbXB0cykge1xuICAgICAgY29uc3QgZWxpZ2libGUgPSB0aGlzLmZpbmRFbGlnaWJsZUNvbnNvbGlkYXRlcyhiYWQpO1xuICAgICAgaWYgKCFlbGlnaWJsZS5sZW5ndGgpIHJldHVybiBmYWxzZTtcbiAgICAgIGZvciAoY29uc3QgW2ksIHNdIG9mIHJhbmRvbS5waWNrKGVsaWdpYmxlKSkge1xuICAgICAgICBjb25zdCBzY3IgPSB0aGlzLmRhdGFbaV07XG4gICAgICAgIGlmIChiYWQuaGFzKHNjcikpIGNvdW50cy5kZWxldGUoc2NyKTtcbiAgICAgICAgaWYgKGJhZC5oYXMocykpIGNvdW50cy5hZGQocyk7XG4gICAgICAgIHRoaXMuZGF0YVtpXSA9IHM7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghYXR0ZW1wdHMpIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8qKiBSZXR1cm5zIGEgc2V0IG9mIGVsaWJpbGUgY29uc29saWRhdGlvbnMuICovXG4gIGZpbmRFbGlnaWJsZUNvbnNvbGlkYXRlcyhiYWQ6IFNldDxudW1iZXI+KTogQXJyYXk8TWFwPG51bWJlciwgbnVtYmVyPj4ge1xuICAgIGNvbnN0IGVsaWdpYmxlOiBBcnJheTxNYXA8bnVtYmVyLCBudW1iZXI+PiA9IFtdO1xuICAgIGNvbnN0IGJlc3Q6IEFycmF5PE1hcDxudW1iZXIsIG51bWJlcj4+ID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLmZpeGVkLmhhcyhpKSkgY29udGludWU7XG4gICAgICBjb25zdCBzY3IwID0gdGhpcy5kYXRhW2ldO1xuICAgICAgaWYgKCFiYWQuaGFzKHNjcjApKSBjb250aW51ZTtcbiAgICAgIGZvciAobGV0IGRpciA9IDA7IGRpciA8IDQ7IGRpcisrKSB7XG4gICAgICAgIGlmICh0aGlzLmlzQm9yZGVyKGksIGRpcikpIGNvbnRpbnVlO1xuICAgICAgICBjb25zdCBkZWx0YSA9IHRoaXMuZGVsdGEoZGlyKTtcbiAgICAgICAgaWYgKHRoaXMuZml4ZWQuaGFzKGkgKyBkZWx0YSkpIGNvbnRpbnVlO1xuICAgICAgICBjb25zdCBtYXNrMCA9IDEgPDwgZGlyO1xuICAgICAgICBpZiAoYmFkLmhhcyhzY3IwIF4gbWFzazApKSBjb250aW51ZTtcbiAgICAgICAgY29uc3QgbWFzazEgPSAxIDw8IChkaXIgXiAyKTtcbiAgICAgICAgY29uc3Qgc2NyMSA9IHRoaXMuZGF0YVtpICsgZGVsdGFdO1xuICAgICAgICBjb25zdCByZXBsID0gbmV3IE1hcChbW2ksIHNjcjAgXiBtYXNrMF0sIFtpICsgZGVsdGEsIHNjcjEgXiBtYXNrMV1dKTtcbiAgICAgICAgaWYgKCF0aGlzLmNoZWNrKHJlcGwpKSBjb250aW51ZTtcbiAgICAgICAgZWxpZ2libGUucHVzaChyZXBsKTtcbiAgICAgICAgaWYgKCFiYWQuaGFzKHNjcjEgXiBtYXNrMSkgJiYgYmFkLmhhcyhzY3IxKSkge1xuICAgICAgICAgIGJlc3QucHVzaChyZXBsKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYmVzdC5sZW5ndGggPyBiZXN0IDogZWxpZ2libGU7XG4gIH1cblxuICB0cnkobWFwOiBNYXA8bnVtYmVyLCBudW1iZXI+KTogYm9vbGVhbiB7XG4gICAgaWYgKCF0aGlzLmNoZWNrKG1hcCkpIHJldHVybiBmYWxzZTtcbiAgICBmb3IgKGNvbnN0IFtpLCB2XSBvZiBtYXApIHtcbiAgICAgIHRoaXMuZGF0YVtpXSA9IHY7XG4gICAgfVxuICAgIC8vdGhpcy52YWxpZGF0ZSgpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgY2hlY2sobWFwPzogTWFwPG51bWJlciwgbnVtYmVyPik6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHVmID0gbmV3IFVuaW9uRmluZDxudW1iZXI+KCk7XG4gICAgZm9yIChsZXQgeSA9IDA7IHkgPCB0aGlzLmg7IHkrKykge1xuICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCB0aGlzLnc7IHgrKykge1xuICAgICAgICBjb25zdCBpID0geSAqIHRoaXMudyArIHg7XG4gICAgICAgIGNvbnN0IHMgPSBtYXA/LmdldChpKSA/PyB0aGlzLmRhdGFbaV07XG4gICAgICAgIGlmIChzKSB1Zi51bmlvbihbaV0pOyAvLyBoYW5kbGUgZGlzY29ubmVjdGVkIGVkZ2VzXG4gICAgICAgIGlmICh5ID4gMCAmJiAocyAmIDEpKSB1Zi51bmlvbihbaSwgaSAtIHRoaXMud10pO1xuICAgICAgICBpZiAoeCA+IDAgJiYgKHMgJiAyKSkgdWYudW5pb24oW2ksIGkgLSAxXSk7XG4gICAgICAgIGlmICh5IDwgdGhpcy5oIC0gMSAmJiAocyAmIDQpKSB1Zi51bmlvbihbaSwgaSArIHRoaXMud10pO1xuICAgICAgICBpZiAoeCA8IHRoaXMudyAtIDEgJiYgKHMgJiA4KSkgdWYudW5pb24oW2ksIGkgKyAxXSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB1Zi5yb290cygpLmxlbmd0aCA9PT0gMTtcbiAgfVxuXG4gIC8qKiBBZGQgYSBwYXRoIG9udG8gYW4gZXhpc3Rpbmcgbm9uLWVtcHR5IGVsZW1lbnQsIGlmIG9uZSBleGlzdHMuICovXG4gIGFkZFBhdGgocmFuZG9tOiBSYW5kb20sIG1heFNpemU/OiBudW1iZXIpOiBib29sZWFuIHtcbiAgICBsZXQgeTogbnVtYmVyO1xuICAgIGxldCB4OiBudW1iZXI7XG4gICAgaWYgKCF0aGlzLnNpemUpIHtcbiAgICAgIHkgPSByYW5kb20ubmV4dEludCh0aGlzLmgpO1xuICAgICAgeCA9IHJhbmRvbS5uZXh0SW50KHRoaXMudyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGVsaWdpYmxlOiBudW1iZXJbXSA9IFtdO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHRoaXMuZGF0YVtpXSAmJiB0aGlzLmRhdGFbaV0gIT09IDB4ZikgZWxpZ2libGUucHVzaChpKTtcbiAgICAgIH1cbiAgICAgIGlmICghZWxpZ2libGUubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG4gICAgICBjb25zdCBwID0gcmFuZG9tLnBpY2soZWxpZ2libGUpO1xuICAgICAgeCA9IHAgJSB0aGlzLnc7XG4gICAgICB5ID0gKHAgLSB4KSAvIHRoaXMudztcbiAgICB9XG4gICAgY29uc3QgcGF0aCA9IG5ldyBNYXA8bnVtYmVyLCBudW1iZXI+KCk7XG4gICAgbGV0IGkgPSB5ICogdGhpcy53ICsgeDtcbiAgICBsZXQgbGVuID0gMDtcbiAgICBsZXQgb2sgPSB0cnVlO1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICBsZXQgY2xvc2VkID0gZmFsc2U7XG4gICAgICBjb25zdCBwcmV2ID0gcGF0aC5nZXQoaSkgPz8gdGhpcy5kYXRhW2ldO1xuICAgICAgbGV0IGZvdW5kID0gZmFsc2U7XG4gICAgICBmb3IgKGxldCBkaXIgb2YgcmFuZG9tLmlzaHVmZmxlKFswLCAxLCAyLCAzXSkpIHtcbiAgICAgICAgY29uc3QgbWFzayA9ICgxIDw8IGRpcik7XG4gICAgICAgIGlmIChwcmV2ICYgbWFzaykgY29udGludWU7XG4gICAgICAgIGNvbnN0IG5leHQgPSBwcmV2IHwgbWFzaztcbiAgICAgICAgaWYgKHRoaXMudmFsaWQgJiYgIXRoaXMudmFsaWQuaGFzKG5leHQpKSBjb250aW51ZTtcbiAgICAgICAgY29uc3QgeTEgPSB5ICsgRFlbZGlyXTtcbiAgICAgICAgY29uc3QgeDEgPSB4ICsgRFhbZGlyXTtcbiAgICAgICAgaWYgKHkxIDwgMCB8fCB4MSA8IDAgfHwgeTEgPj0gdGhpcy5oIHx8IHgxID49IHRoaXMudykgY29udGludWU7XG4gICAgICAgIGNvbnN0IGkxID0geTEgKiB0aGlzLncgKyB4MTtcbiAgICAgICAgY29uc3QgcHJldjEgPSBwYXRoLmdldChpMSkgPz8gdGhpcy5kYXRhW2kxXTtcbiAgICAgICAgY29uc3QgbmV4dDEgPSBwcmV2MSB8ICgxIDw8IChkaXIgXiAyKSk7XG4gICAgICAgIGlmIChwcmV2MSkge1xuICAgICAgICAgIGlmIChwcmV2MSA9PT0gbmV4dDEgfHwgKHRoaXMudmFsaWQgJiYgIXRoaXMudmFsaWQuaGFzKG5leHQxKSkpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlOyAvLyBlaXRoZXIgYSBjb21wbGV0ZSByZXRyYWNlLCBvciBpbnZhbGlkXG4gICAgICAgICAgfVxuICAgICAgICAgIGNsb3NlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgb2sgPSAhdGhpcy52YWxpZCB8fCB0aGlzLnZhbGlkLmhhcyhuZXh0MSk7XG4gICAgICAgIHBhdGguc2V0KGksIG5leHQpO1xuICAgICAgICBwYXRoLnNldChpMSwgbmV4dDEpO1xuICAgICAgICB4ID0geDE7XG4gICAgICAgIHkgPSB5MTtcbiAgICAgICAgaSA9IGkxO1xuICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgaWYgKCFmb3VuZCkgYnJlYWs7XG4gICAgICBpZiAoY2xvc2VkIHx8IHRoaXMuZGF0YVtpXSkgYnJlYWs7XG4gICAgICBpZiAoIXRoaXMuc2l6ZSsrKSB0aGlzLnNpemUrKzsgLy8gY291bnQgMiB0aGUgZmlyc3QgdGltZVxuICAgICAgaWYgKG9rICYmIG1heFNpemUgJiYgdGhpcy5zaXplID49IG1heFNpemUpIGJyZWFrO1xuICAgICAgaWYgKG9rICYmIHJhbmRvbS5uZXh0SW50KDE1KSA8IGxlbisrKSBicmVhaztcbiAgICB9XG4gICAgaWYgKCFwYXRoLnNpemUgfHwgIW9rKSByZXR1cm4gZmFsc2U7XG4gICAgZm9yIChjb25zdCBbaSwgdl0gb2YgcGF0aCkge1xuICAgICAgdGhpcy5kYXRhW2ldID0gdjtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICB0b0dyaWQ8VD4oY2hhcjogVCk6IEdyaWQ8VD4ge1xuICAgIGNvbnN0IGcgPSBuZXcgR3JpZDxUPih0aGlzLmgsIHRoaXMudyk7XG4gICAgZm9yIChsZXQgeSA9IDA7IHkgPCB0aGlzLmg7IHkrKykge1xuICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCB0aGlzLnc7IHgrKykge1xuICAgICAgICBjb25zdCBpID0geSAqIHRoaXMudyArIHg7XG4gICAgICAgIGNvbnN0IHMgPSB0aGlzLmRhdGFbaV07XG4gICAgICAgIGlmICghcykgY29udGludWU7XG4gICAgICAgIGNvbnN0IGMgPSAoeSA8PCAxMiB8IHggPDwgNCB8IDB4ODA4KSBhcyBHcmlkQ29vcmQ7XG4gICAgICAgIGcuc2V0KGMsIGNoYXIpO1xuICAgICAgICBmb3IgKGxldCBkaXIgPSAwOyBkaXIgPCA0OyBkaXIrKykge1xuICAgICAgICAgIGlmICghKHMgJiAoMSA8PCBkaXIpKSkgY29udGludWU7XG4gICAgICAgICAgY29uc3QgZGVsdGEgPSBkaXIgJiAxID8gOCA6IDB4ODAwO1xuICAgICAgICAgIGcuc2V0KChkaXIgJiAyID8gYyArIGRlbHRhIDogYyAtIGRlbHRhKSBhcyBHcmlkQ29vcmQsIGNoYXIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBnO1xuICB9XG5cbiAgZGVsdGEoZGlyOiBudW1iZXIpIHtcbiAgICByZXR1cm4gKGRpciAmIDIgPyAxIDogLTEpICogKGRpciAmIDEgPyAxIDogdGhpcy53KTtcbiAgfVxuXG4gIHNob3coKTogc3RyaW5nIHtcbiAgICBjb25zdCBsaW5lcyA9IFtdO1xuICAgIGZvciAobGV0IHkgPSAwOyB5IDwgdGhpcy5oOyB5KyspIHtcbiAgICAgIGxldCBsaW5lID0gJyc7XG4gICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHRoaXMudzsgeCsrKSB7XG4gICAgICAgIGxpbmUgKz0gJyDilbXilbTilJjilbfilILilJDilKTilbbilJTilIDilLTilIzilJzilKzilLwnW3RoaXMuZGF0YVt5ICogdGhpcy53ICsgeF1dO1xuICAgICAgfVxuICAgICAgbGluZXMucHVzaChsaW5lKTtcbiAgICB9XG4gICAgcmV0dXJuIGxpbmVzLmpvaW4oJ1xcbicpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBDdXJzb3Ige1xuICBwcml2YXRlIF9pOiBudW1iZXJcbiAgY29uc3RydWN0b3IocmVhZG9ubHkgZ3JpZDogTW9ub2dyaWQsIHk6IG51bWJlciwgeDogbnVtYmVyKSB7XG4gICAgdGhpcy5faSA9IHkgKiBncmlkLncgKyB4O1xuICB9XG5cbiAgZ2V0IHgoKSB7IHJldHVybiB0aGlzLl9pICUgdGhpcy5ncmlkLncgfTtcbiAgZ2V0IHkoKSB7IHJldHVybiBNYXRoLmZsb29yKHRoaXMuX2kgLyB0aGlzLmdyaWQudyk7IH1cblxuICBnbyhkaXI6IG51bWJlcikge1xuICAgIGNvbnN0IGRlbHRhID0gdGhpcy5ncmlkLmRlbHRhKGRpcik7XG4gICAgY29uc3QgaTEgPSB0aGlzLl9pICsgZGVsdGE7XG4gICAgY29uc3QgbWFzazAgPSAxIDw8IGRpcjtcbiAgICBjb25zdCBtYXNrMSA9IDEgPDwgKGRpciBeIDIpO1xuICAgIHRoaXMuZ3JpZC5kYXRhW3RoaXMuX2ldIHw9IG1hc2swO1xuICAgIHRoaXMuZ3JpZC5kYXRhW3RoaXMuX2kgPSBpMV0gfD0gbWFzazE7XG4gICAgLy8gVE9ETyAtIGNoZWNrIHZhbGlkP1xuICB9XG5cbiAgZGlyZWN0ZWRQYXRoKHJhbmRvbTogUmFuZG9tLCB5OiBudW1iZXIsIHg6IG51bWJlcikge1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICBjb25zdCB5MCA9IHRoaXMueTtcbiAgICAgIGNvbnN0IHgwID0gdGhpcy54O1xuICAgICAgY29uc3QgZGlyczogbnVtYmVyW10gPSBbXTtcbiAgICAgIGlmICh5IDwgeTApIGRpcnMucHVzaCgwKTtcbiAgICAgIGlmICh4IDwgeDApIGRpcnMucHVzaCgxKTtcbiAgICAgIGlmICh5ID4geTApIGRpcnMucHVzaCgyKTtcbiAgICAgIGlmICh4ID4geDApIGRpcnMucHVzaCgzKTtcbiAgICAgIGlmICghZGlycy5sZW5ndGgpIHJldHVybjtcbiAgICAgIHRoaXMuZ28ocmFuZG9tLnBpY2soZGlycykpO1xuICAgIH1cbiAgfVxufVxuXG5jb25zdCBEWSA9IFstMSwgMCwgMSwgMF07XG5jb25zdCBEWCA9IFswLCAtMSwgMCwgMV07XG4iXX0=