import { Flag, Spawn } from '../rom/locationtables.js';
import { Metalocation } from '../rom/metalocation.js';
import { cloneArray } from '../rom/util.js';
import { removeWhirlpools } from './removewhirlpools.js';
export function standardMapEdits(rom, opts) {
    if (opts.eastCave) {
        eastCave(rom, opts.eastCave);
    }
    else if (opts.classicLimeTreeToLeaf) {
        connectLimeTreeToLeaf(rom);
    }
    addTowerExit(rom);
    reversibleSwanGate(rom);
    shrinkMado2(rom);
    removeUnusedGoaKensuExits(rom);
    adjustAbductionTrigger(rom);
    splitSaberaPalace2(rom);
    if (opts.removeWhirlpools) {
        removeWhirlpools(rom);
    }
}
(function (standardMapEdits) {
    function generateOptions(flags, random) {
        const options = {};
        if (flags.addEastCave()) {
            options.eastCave = {};
            const exits = ['cordel', 'lime', 'goa', 'desert'];
            let i = random.nextInt(4);
            [options.eastCave.exit1] = exits.splice(i, 1);
            options.eastCave.exit2 = random.pick(exits);
        }
        else if (flags.connectLimeTreeToLeaf()) {
            options.classicLimeTreeToLeaf = true;
        }
        if (flags.removeDesertWhirlpools()) {
            options.removeWhirlpools = true;
        }
        return options;
    }
    standardMapEdits.generateOptions = generateOptions;
})(standardMapEdits || (standardMapEdits = {}));
function eastCave(rom, opts) {
    const { locations: { EastCave1, EastCave2, EastCave3, SealedCave1, ValleyOfWind }, metascreens: { boundaryE_cave, branchNSE, branchNWE, branchNWSE, branchNWS, branchWSE, caveEmpty, deadEndE, deadEndE_downStair, deadEndE_upStair, deadEndN_stairs, deadEndS, deadEndS_stairs, deadEndW, deadEndW_downStair, hallNE, hallNS, hallNW, hallSE, hallWS, hallWE, hallNS_entrance, hallNS_ramp, hallNS_wall, }, } = rom;
    rom.locations.allocate(EastCave1);
    rom.locations.allocate(EastCave2);
    if (opts.exit2)
        rom.locations.allocate(EastCave3);
    for (const l of [EastCave1, EastCave2, EastCave3]) {
        l.bgm = l.originalBgm = 0x17;
        l.entrances = [];
        l.exits = [];
        l.pits = [];
        l.spawns = [];
        l.flags = [];
        l.width = l.height = 1;
        l.screens = [[0x80]];
        l.tilePalettes = [0x1a, 0x1b, 0x05];
        l.originalTilePalettes = [0x1a, 0x1b, 0x05];
        l.tileset = 0x88;
        l.tileEffects = 0xb5;
        l.tilePatterns = [0x14, 0x02];
        l.spritePatterns = [...SealedCave1.spritePatterns];
        l.spritePalettes = [...SealedCave1.spritePalettes];
    }
    EastCave1.meta = new Metalocation(EastCave1.id, rom.metatilesets.cave, 5, 5);
    EastCave1.meta.set2d(0x00, [
        [deadEndE, hallWS, caveEmpty, hallSE, deadEndW],
        [caveEmpty, hallNS, hallSE, hallNW, caveEmpty],
        [hallSE, branchNWSE, branchNWS, caveEmpty, caveEmpty],
        [hallNS, hallNS_ramp, hallNE, hallWE, hallWS],
        [hallNS_entrance, hallNE, deadEndW, deadEndE_upStair, hallNW],
    ]);
    EastCave2.meta = new Metalocation(EastCave2.id, rom.metatilesets.cave, 5, 5);
    EastCave2.meta.set2d(0x00, [
        [deadEndE, hallWS, deadEndS, caveEmpty, deadEndS],
        [caveEmpty, hallNS, hallNS, caveEmpty, hallNS],
        [caveEmpty, branchNSE, branchNWE, branchWSE, hallNW],
        [caveEmpty, hallNS_ramp, caveEmpty, hallNE, hallWS],
        [deadEndE, hallNW, caveEmpty, caveEmpty, deadEndN_stairs],
    ]);
    ValleyOfWind.meta.set2d(0x33, [[boundaryE_cave]]);
    rom.tileEffects[0].effects[0xc0] = 0;
    EastCave1.meta.attach(0x43, EastCave2.meta, 0x44);
    EastCave1.meta.attach(0x40, ValleyOfWind.meta, 0x33);
    if (opts.exit1) {
        EastCave1.meta.set2d(0x04, [[deadEndW_downStair]]);
        connectEastCaveExit(EastCave1, 0x04, opts.exit1);
    }
    if (opts.exit2) {
        EastCave3.meta = new Metalocation(EastCave3.id, rom.metatilesets.cave, 3, 1);
        EastCave3.meta.set2d(0x00, [
            [deadEndS_stairs],
            [hallNS_wall],
            [hallNS_entrance],
        ]);
        EastCave3.spawns.push(Spawn.from([0x18, 0x07, 0x23, 0x00]));
        EastCave3.flags.push(Flag.of({ screen: 0x10, flag: rom.flags.alloc(0x200) }));
        EastCave2.meta.set2d(0x40, [[deadEndE_downStair]]);
        EastCave2.meta.attach(0x40, EastCave3.meta, 0x00);
        connectEastCaveExit(EastCave3, 0x20, opts.exit2);
    }
    EastCave1.spawns.push(Spawn.of({ screen: 0x21, tile: 0x87, timed: true, id: 0x2 }), Spawn.of({ screen: 0x12, tile: 0x88, timed: false, id: 0x2 }), Spawn.of({ screen: 0x13, tile: 0x89, timed: true, id: 0x2 }), Spawn.of({ screen: 0x32, tile: 0x68, timed: false, id: 0x2 }), Spawn.of({ screen: 0x41, tile: 0x88, timed: true, id: 0x2 }), Spawn.of({ screen: 0x33, tile: 0x98, timed: true, id: 0x2 }), Spawn.of({ screen: 0x03, tile: 0x88, timed: true, id: 0x2 }));
    EastCave2.spawns.push(Spawn.of({ screen: 0x01, tile: 0x88, timed: true, id: 0x2 }), Spawn.of({ screen: 0x11, tile: 0x48, timed: false, id: 0x2 }), Spawn.of({ screen: 0x12, tile: 0x77, timed: true, id: 0x2 }), Spawn.of({ screen: 0x14, tile: 0x28, timed: false, id: 0x2 }), Spawn.of({ screen: 0x23, tile: 0x85, timed: true, id: 0x2 }), Spawn.of({ screen: 0x31, tile: 0x88, timed: true, id: 0x2 }), Spawn.of({ screen: 0x33, tile: 0x8a, timed: false, id: 0x2 }), Spawn.of({ screen: 0x34, tile: 0x98, timed: true, id: 0x2 }), Spawn.of({ screen: 0x41, tile: 0x82, timed: true, id: 0x2 }), Spawn.of({ y: 0x110, x: 0x478, type: 2, id: 0x59 }), Spawn.of({ y: 0x070, x: 0x108, type: 2, id: 0x7c }));
    rom.slots.swap(0x31, 0x59);
}
function connectEastCaveExit(loc, scr, exit) {
    const { locations: { CordelPlainEast, CordelPlainWest, Desert2, GoaValley, LimeTreeValley, }, metascreens: { bendNE, bendSE, boundaryN_trees, boundaryW_cave, cornerNE, cornerNW, cornerSE, cornerSE_cave, cornerSW, } } = loc.rom;
    let dest;
    let destScr;
    switch (exit) {
        case 'lime':
            dest = LimeTreeValley;
            destScr = 0x10;
            dest.resizeScreens(0, 1, 0, 0);
            dest.meta.spliceColumns(0, 1, 2, [
                [cornerNW, boundaryN_trees],
                [boundaryW_cave, bendSE],
                [cornerSW, cornerSE],
            ]);
            break;
        case 'cordel':
            const mapEdit = [
                [boundaryW_cave, bendSE],
                [cornerSW, cornerSE],
            ];
            dest = CordelPlainEast;
            destScr = 0x55;
            dest.meta.set2d(0x55, mapEdit);
            CordelPlainWest.meta.set2d(0x55, mapEdit);
            break;
        case 'goa':
            dest = GoaValley;
            destScr = 0x11;
            dest.meta.set2d(0x01, [
                [cornerNW, cornerNE],
                [boundaryW_cave, bendNE]
            ]);
            break;
        case 'desert':
            dest = Desert2;
            destScr = 0x53;
            dest.meta.set2d(0x53, [[cornerSE_cave]]);
            break;
    }
    loc.meta.attach(scr, dest.meta, destScr);
}
function connectLimeTreeToLeaf(rom) {
    const { locations: { ValleyOfWind, LimeTreeValley }, metascreens: { exitE, exitW_southwest, overworldEmpty_alt }, } = rom;
    ValleyOfWind.meta.set2d(0x54, [[exitE]]);
    LimeTreeValley.meta.set2d(0x10, [[exitW_southwest],
        [overworldEmpty_alt]]);
    ValleyOfWind.meta.attach(0x54, LimeTreeValley.meta, 0x10);
}
function addTowerExit(rom) {
    const { TowerEntrance, Crypt_Teleporter } = rom.locations;
    Crypt_Teleporter.meta.attach(0x00, TowerEntrance.meta, 0x00, 'teleporter', 'teleporter');
}
function reversibleSwanGate(rom) {
    const { flags: { OpenedSwanGate }, locations: { SwanGate }, npcs: { SoldierGuard }, } = rom;
    SwanGate.spawns.push(Spawn.of({ xt: 0x0a, yt: 0x02, type: 1, id: 0x2d }), Spawn.of({ xt: 0x0b, yt: 0x02, type: 1, id: 0x2d }));
    SoldierGuard.localDialogs.get(SwanGate.id)[0].flags.push(OpenedSwanGate.id);
}
function splitSaberaPalace2(rom) {
    splitMap(rom.locations.SaberaPalace2_West, rom.locations.SaberaPalace2, 0x00, 0x01, 0x10, 0x20, 0x30, 0x31, 0x41, 0x51, 0x61);
}
function splitMap(newLoc, loc, ...splitPos) {
    const rom = newLoc.rom;
    rom.locations.allocate(newLoc, loc);
    newLoc.bgm = loc.bgm;
    newLoc.entrances = [];
    newLoc.exits = [];
    newLoc.pits = [];
    newLoc.spawns = [];
    newLoc.flags = [];
    newLoc.width = newLoc.height = 1;
    newLoc.screens = [[0x80]];
    newLoc.tilePalettes = cloneArray(loc.tilePalettes);
    newLoc.originalTilePalettes = cloneArray(loc.originalTilePalettes);
    newLoc.tileset = loc.tileset;
    newLoc.tileEffects = loc.tileEffects;
    newLoc.tilePatterns = cloneArray(loc.tilePatterns);
    newLoc.spritePatterns = cloneArray(loc.spritePatterns);
    newLoc.spritePalettes = cloneArray(loc.spritePalettes);
    let h = 0;
    let w = 0;
    for (const pos of splitPos) {
        h = Math.max(h, (pos >>> 4) + 1);
        w = Math.max(w, (pos & 0xf) + 1);
    }
    newLoc.meta = new Metalocation(newLoc.id, loc.meta.tileset, h, w);
    for (const pos of splitPos) {
        newLoc.meta.set(pos, loc.meta.get(pos));
        loc.meta.set(pos, loc.meta.tileset.empty);
    }
    const posSet = new Set(splitPos);
    newLoc.flags = loc.flags.filter(f => posSet.has(f.screen));
    loc.flags = loc.flags.filter(f => !posSet.has(f.screen));
    newLoc.spawns = loc.spawns.filter(s => posSet.has(s.screen));
    loc.spawns = loc.spawns.filter(s => !posSet.has(s.screen));
    loc.meta.moveExitsAndPitsTo(newLoc.meta);
}
function shrinkMado2(rom) {
}
function removeUnusedGoaKensuExits(rom) {
    const meta = rom.locations.GoaFortress_Kensu.meta;
    for (const [pos, type] of meta.exits()) {
        if (pos < 0x10 || type.startsWith('seamless'))
            continue;
        meta.deleteExit(pos, type);
    }
}
function adjustAbductionTrigger(rom) {
    rom.locations.ZebuCave.spawns.find(s => s.isTrigger()).yt += 3;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhbmRhcmRtYXBlZGl0cy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9qcy9wYXNzL3N0YW5kYXJkbWFwZWRpdHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsT0FBTyxFQUFDLElBQUksRUFBRSxLQUFLLEVBQUMsTUFBTSwwQkFBMEIsQ0FBQztBQUVyRCxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0sd0JBQXdCLENBQUM7QUFDcEQsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQzFDLE9BQU8sRUFBQyxnQkFBZ0IsRUFBQyxNQUFNLHVCQUF1QixDQUFDO0FBZXZELE1BQU0sVUFBVSxnQkFBZ0IsQ0FBQyxHQUFRLEVBQUUsSUFBYTtJQUN0RCxJQUFJLElBQUksQ0FBQyxRQUFRLEVBQUU7UUFDakIsUUFBUSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7S0FDOUI7U0FBTSxJQUFJLElBQUksQ0FBQyxxQkFBcUIsRUFBRTtRQUNyQyxxQkFBcUIsQ0FBQyxHQUFHLENBQUMsQ0FBQztLQUM1QjtJQUNELFlBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNsQixrQkFBa0IsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUN4QixXQUFXLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDakIseUJBQXlCLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDL0Isc0JBQXNCLENBQUMsR0FBRyxDQUFDLENBQUM7SUFFNUIsa0JBQWtCLENBQUMsR0FBRyxDQUFDLENBQUM7SUFJeEIsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLEVBQUU7UUFDekIsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLENBQUM7S0FDdkI7QUFDSCxDQUFDO0FBRUQsV0FBaUIsZ0JBQWdCO0lBQy9CLFNBQWdCLGVBQWUsQ0FBQyxLQUFjLEVBQUUsTUFBYztRQUM1RCxNQUFNLE9BQU8sR0FBWSxFQUFFLENBQUM7UUFDNUIsSUFBSSxLQUFLLENB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Q0FBQyxDQUFDO1FBQzdFLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRTtZQUN6QixDQUFDLGVBQWUsQ0FBQztZQUNqQixDQUFDLFdBQVcsQ0FBQztZQUNiLENBQUMsZUFBZSxDQUFDO1NBQ2xCLENBQUMsQ0FBQztRQUdILFNBQVMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDNUQsU0FBUyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEdBQUcsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFDLENBQUMsQ0FBQyxDQUFDO1FBRzVFLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbkQsU0FBUyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDbEQsbUJBQW1CLENBQUMsU0FBUyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7S0FDbEQ7SUFHRCxTQUFTLENBQUMsTUFBTSxDQUFDLElBQUksQ0FDbkIsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxFQUMxRCxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBQyxDQUFDLEVBQzNELEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFDLENBQUMsRUFDMUQsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxFQUMzRCxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBQyxDQUFDLEVBQzFELEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFDLENBQUMsRUFDMUQsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxDQUMzRCxDQUFDO0lBQ0YsU0FBUyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQ25CLEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFDLENBQUMsRUFDMUQsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxFQUMzRCxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBQyxDQUFDLEVBQzFELEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFDLENBQUMsRUFDM0QsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxFQUMxRCxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBQyxDQUFDLEVBQzFELEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFDLENBQUMsRUFDM0QsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxFQUMxRCxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBQyxDQUFDLEVBRTFELEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFDLENBQUMsRUFFakQsS0FBSyxDQUFDLEVBQUUsQ0FB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LE1BQU0sTUFBTSxHQUFHLElBQUksR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ2pDLE1BQU0sQ0FBQyxLQUFLLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO0lBQzNELEdBQUcsQ0FBQyxLQUFLLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDekQsTUFBTSxDQUFDLE1BQU0sR0FBRyxHQUFHLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDN0QsR0FBRyxDQUFDLE1BQU0sR0FBRyxHQUFHLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUMzRCxHQUFHLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUMzQyxDQUFDO0FBSUQsU0FBUyxXQUFXLENBQUMsR0FBUTtBQUc3QixDQUFDO0FBOERELFNBQVMseUJBQXlCLENBQUMsR0FBUTtJQUt6QyxNQUFNLElBQUksR0FBRyxHQUFHLENBQUMsU0FBUyxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQztJQUNsRCxLQUFLLE1BQU0sQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLElBQUksSUFBSSxDQUFDLEtBQUssRUFBRSxFQUFFO1FBQ3RDLElBQUksR0FBRyxHQUFHLElBQUksSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQztZQUFFLFNBQVM7UUFDeEQsSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUM7S0FDNUI7QUFLSCxDQUFDO0FBRUQsU0FBUyxzQkFBc0IsQ0FBQyxHQUFRO0lBR3RDLEdBQUcsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUUsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ2xFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0ZsYWdTZXR9IGZyb20gJy4uL2ZsYWdzZXQuanMnO1xuaW1wb3J0IHtSYW5kb219IGZyb20gJy4uL3JhbmRvbS5qcyc7XG5pbXBvcnQge1JvbX0gZnJvbSAnLi4vcm9tLmpzJztcbmltcG9ydCB7RmxhZywgU3Bhd259IGZyb20gJy4uL3JvbS9sb2NhdGlvbnRhYmxlcy5qcyc7XG5pbXBvcnQge0xvY2F0aW9ufSBmcm9tICcuLi9yb20vbG9jYXRpb24uanMnO1xuaW1wb3J0IHtNZXRhbG9jYXRpb259IGZyb20gJy4uL3JvbS9tZXRhbG9jYXRpb24uanMnO1xuaW1wb3J0IHtjbG9uZUFycmF5fSBmcm9tICcuLi9yb20vdXRpbC5qcyc7XG5pbXBvcnQge3JlbW92ZVdoaXJscG9vbHN9IGZyb20gJy4vcmVtb3Zld2hpcmxwb29scy5qcyc7XG5cbnR5cGUgRWFzdENhdmVFeGl0ID0gJ2NvcmRlbCcgfCAnbGltZScgfCAnZ29hJyB8ICdkZXNlcnQnO1xuXG5pbnRlcmZhY2UgRWFzdENhdmVPcHRpb25zIHtcbiAgZXhpdDE/OiBFYXN0Q2F2ZUV4aXQ7XG4gIGV4aXQyPzogRWFzdENhdmVFeGl0O1xufVxuXG5pbnRlcmZhY2UgT3B0aW9ucyB7XG4gIGVhc3RDYXZlPzogRWFzdENhdmVPcHRpb25zO1xuICBjbGFzc2ljTGltZVRyZWVUb0xlYWY/OiBib29sZWFuO1xuICByZW1vdmVXaGlybHBvb2xzPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHN0YW5kYXJkTWFwRWRpdHMocm9tOiBSb20sIG9wdHM6IE9wdGlvbnMpIHtcbiAgaWYgKG9wdHMuZWFzdENhdmUpIHtcbiAgICBlYXN0Q2F2ZShyb20sIG9wdHMuZWFzdENhdmUpO1xuICB9IGVsc2UgaWYgKG9wdHMuY2xhc3NpY0xpbWVUcmVlVG9MZWFmKSB7XG4gICAgY29ubmVjdExpbWVUcmVlVG9MZWFmKHJvbSk7XG4gIH1cbiAgYWRkVG93ZXJFeGl0KHJvbSk7XG4gIHJldmVyc2libGVTd2FuR2F0ZShyb20pO1xuICBzaHJpbmtNYWRvMihyb20pO1xuICByZW1vdmVVbnVzZWRHb2FLZW5zdUV4aXRzKHJvbSk7XG4gIGFkanVzdEFiZHVjdGlvblRyaWdnZXIocm9tKTtcblxuICBzcGxpdFNhYmVyYVBhbGFjZTIocm9tKTtcbiAgLy9zcGxpdFN0eXgyKHJvbSk7IC8vIGRvbid0IGFjdHVhbGx5IGRvIHRoaXMgb25lP1xuICAvLyBjbG9zZUNhdmVFbnRyYW5jZXMocm9tKTsgLy8gTk9URTogYWZ0ZXIgb3RoZXIgbWFwIGVkaXRzXG5cbiAgaWYgKG9wdHMucmVtb3ZlV2hpcmxwb29scykge1xuICAgIHJlbW92ZVdoaXJscG9vbHMocm9tKTtcbiAgfVxufVxuXG5leHBvcnQgbmFtZXNwYWNlIHN0YW5kYXJkTWFwRWRpdHMge1xuICBleHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVPcHRpb25zKGZsYWdzOiBGbGFnU2V0LCByYW5kb206IFJhbmRvbSk6IE9wdGlvbnMge1xuICAgIGNvbnN0IG9wdGlvbnM6IE9wdGlvbnMgPSB7fTtcbiAgICBpZiAoZmxhZ3MuYWRkRWFzdENhdmUoKSkge1xuICAgICAgb3B0aW9ucy5lYXN0Q2F2ZSA9IHt9O1xuICAgICAgY29uc3QgZXhpdHM6IEVhc3RDYXZlRXhpdFtdID0gWydjb3JkZWwnLCAnbGltZScsICdnb2EnLCAnZGVzZXJ0J107XG4gICAgICBsZXQgaSA9IHJhbmRvbS5uZXh0SW50KDQpO1xuICAgICAgW29wdGlvbnMuZWFzdENhdmUuZXhpdDFdID0gZXhpdHMuc3BsaWNlKGksIDEpO1xuICAgICAgb3B0aW9ucy5lYXN0Q2F2ZS5leGl0MiA9IHJhbmRvbS5waWNrKGV4aXRzKTtcbiAgICB9IGVsc2UgaWYgKGZsYWdzLmNvbm5lY3RMaW1lVHJlZVRvTGVhZigpKSB7XG4gICAgICBvcHRpb25zLmNsYXNzaWNMaW1lVHJlZVRvTGVhZiA9IHRydWU7XG4gICAgfVxuICAgIGlmIChmbGFncy5yZW1vdmVEZXNlcnRXaGlybHBvb2xzKCkpIHtcbiAgICAgIG9wdGlvbnMucmVtb3ZlV2hpcmxwb29scyA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiBvcHRpb25zO1xuICB9XG59XG5cbmZ1bmN0aW9uIGVhc3RDYXZlKHJvbTogUm9tLCBvcHRzOiBFYXN0Q2F2ZU9wdGlvbnMpIHtcbiAgY29uc3Qge1xuICAgIGxvY2F0aW9uczoge0Vhc3RDYXZlMSwgRWFzdENhdmUyLCBFYXN0Q2F2ZTMsIFNlYWxlZENhdmUxLCBWYWxsZXlPZldpbmR9LFxuICAgIG1ldGFzY3JlZW5zOiB7Ym91bmRhcnlFX2NhdmUsXG4gICAgICAgICAgICAgICAgICBicmFuY2hOU0UsIGJyYW5jaE5XRSwgYnJhbmNoTldTRSwgYnJhbmNoTldTLCBicmFuY2hXU0UsXG4gICAgICAgICAgICAgICAgICBjYXZlRW1wdHksXG4gICAgICAgICAgICAgICAgICBkZWFkRW5kRSwgZGVhZEVuZEVfZG93blN0YWlyLCBkZWFkRW5kRV91cFN0YWlyLFxuICAgICAgICAgICAgICAgICAgZGVhZEVuZE5fc3RhaXJzLCBkZWFkRW5kUywgZGVhZEVuZFNfc3RhaXJzLFxuICAgICAgICAgICAgICAgICAgZGVhZEVuZFcsIGRlYWRFbmRXX2Rvd25TdGFpcixcbiAgICAgICAgICAgICAgICAgIGhhbGxORSwgaGFsbE5TLCBoYWxsTlcsIGhhbGxTRSwgaGFsbFdTLCBoYWxsV0UsXG4gICAgICAgICAgICAgICAgICBoYWxsTlNfZW50cmFuY2UsIGhhbGxOU19yYW1wLCBoYWxsTlNfd2FsbCxcbiAgICAgICAgICAgICAgICAgfSxcbiAgICAvL2ZsYWdzOiB7QWx3YXlzVHJ1ZX0sXG4gIH0gPSByb207XG5cbiAgcm9tLmxvY2F0aW9ucy5hbGxvY2F0ZShFYXN0Q2F2ZTEpO1xuICByb20ubG9jYXRpb25zLmFsbG9jYXRlKEVhc3RDYXZlMik7XG4gIGlmIChvcHRzLmV4aXQyKSByb20ubG9jYXRpb25zLmFsbG9jYXRlKEVhc3RDYXZlMyk7XG5cbiAgZm9yIChjb25zdCBsIG9mIFtFYXN0Q2F2ZTEsIEVhc3RDYXZlMiwgRWFzdENhdmUzXSkge1xuICAgIGwuYmdtID0gbC5vcmlnaW5hbEJnbSA9IDB4MTc7IC8vIG10IHNhYnJlIGNhdmUgbXVzaWM/XG4gICAgbC5lbnRyYW5jZXMgPSBbXTtcbiAgICBsLmV4aXRzID0gW107XG4gICAgbC5waXRzID0gW107XG4gICAgbC5zcGF3bnMgPSBbXTtcbiAgICBsLmZsYWdzID0gW107XG4gICAgbC53aWR0aCA9IGwuaGVpZ2h0ID0gMTtcbiAgICBsLnNjcmVlbnMgPSBbWzB4ODBdXTtcbiAgICBsLnRpbGVQYWxldHRlcyA9IFsweDFhLCAweDFiLCAweDA1XTsgLy8gcm9jayB3YWxsXG4gICAgbC5vcmlnaW5hbFRpbGVQYWxldHRlcyA9IFsweDFhLCAweDFiLCAweDA1XTsgLy8gcm9jayB3YWxsXG4gICAgbC50aWxlc2V0ID0gMHg4ODtcbiAgICBsLnRpbGVFZmZlY3RzID0gMHhiNTtcbiAgICBsLnRpbGVQYXR0ZXJucyA9IFsweDE0LCAweDAyXTtcbiAgICBsLnNwcml0ZVBhdHRlcm5zID0gWy4uLlNlYWxlZENhdmUxLnNwcml0ZVBhdHRlcm5zXSBhcyBbbnVtYmVyLCBudW1iZXJdO1xuICAgIGwuc3ByaXRlUGFsZXR0ZXMgPSBbLi4uU2VhbGVkQ2F2ZTEuc3ByaXRlUGFsZXR0ZXNdIGFzIFtudW1iZXIsIG51bWJlcl07XG4gIH1cblxuICAvLyBOT1RFOiAweDljIGNhbiBiZWNvbWUgMHg5OSBpbiB0b3AgbGVmdCBvciAweDk3IGluIHRvcCByaWdodCBvciBib3R0b20gbWlkZGxlIGZvciBhIGNhdmUgZXhpdFxuICBFYXN0Q2F2ZTEubWV0YSA9IG5ldyBNZXRhbG9jYXRpb24oRWFzdENhdmUxLmlkLCByb20ubWV0YXRpbGVzZXRzLmNhdmUsIDUsIDUpO1xuICBFYXN0Q2F2ZTEubWV0YS5zZXQyZCgweDAwLCBbXG4gICAgW2RlYWRFbmRFLCAgICAgICAgaGFsbFdTLCAgICAgIGNhdmVFbXB0eSwgaGFsbFNFLCAgICAgICAgICAgZGVhZEVuZFddLFxuICAgIFtjYXZlRW1wdHksICAgICAgIGhhbGxOUywgICAgICBoYWxsU0UsICAgIGhhbGxOVywgICAgICAgICAgIGNhdmVFbXB0eV0sXG4gICAgW2hhbGxTRSwgICAgICAgICAgYnJhbmNoTldTRSwgIGJyYW5jaE5XUywgY2F2ZUVtcHR5LCAgICAgICAgY2F2ZUVtcHR5XSxcbiAgICBbaGFsbE5TLCAgICAgICAgICBoYWxsTlNfcmFtcCwgaGFsbE5FLCAgICBoYWxsV0UsICAgICAgICAgICBoYWxsV1NdLFxuICAgIFtoYWxsTlNfZW50cmFuY2UsIGhhbGxORSwgICAgICBkZWFkRW5kVywgIGRlYWRFbmRFX3VwU3RhaXIsIGhhbGxOV10sXG4gIF0pO1xuXG4gIEVhc3RDYXZlMi5tZXRhID0gbmV3IE1ldGFsb2NhdGlvbihFYXN0Q2F2ZTIuaWQsIHJvbS5tZXRhdGlsZXNldHMuY2F2ZSwgNSwgNSk7XG4gIEVhc3RDYXZlMi5tZXRhLnNldDJkKDB4MDAsIFtcbiAgICBbZGVhZEVuZEUsICBoYWxsV1MsICAgICAgZGVhZEVuZFMsICBjYXZlRW1wdHksIGRlYWRFbmRTXSxcbiAgICBbY2F2ZUVtcHR5LCBoYWxsTlMsICAgICAgaGFsbE5TLCAgICBjYXZlRW1wdHksIGhhbGxOU10sXG4gICAgW2NhdmVFbXB0eSwgYnJhbmNoTlNFLCAgIGJyYW5jaE5XRSwgYnJhbmNoV1NFLCBoYWxsTlddLFxuICAgIFtjYXZlRW1wdHksIGhhbGxOU19yYW1wLCBjYXZlRW1wdHksIGhhbGxORSwgICAgaGFsbFdTXSxcbiAgICBbZGVhZEVuZEUsICBoYWxsTlcsICAgICAgY2F2ZUVtcHR5LCBjYXZlRW1wdHksIGRlYWRFbmROX3N0YWlyc10sXG4gIF0pO1xuXG4gIC8vIEFkZCBlbnRyYW5jZSB0byB2YWxsZXkgb2Ygd2luZFxuICBWYWxsZXlPZldpbmQubWV0YS5zZXQyZCgweDMzLCBbW2JvdW5kYXJ5RV9jYXZlXV0pO1xuICByb20udGlsZUVmZmVjdHNbMF0uZWZmZWN0c1sweGMwXSA9IDA7XG4gIC8vIFRPRE8gLSBkbyB0aGlzIG9uY2Ugd2UgZml4IHRoZSBzZWEgdGlsZXNldFxuICAvLyByb20uc2NyZWVuc1sweGMyXS50aWxlc1sweDVhXSA9IDB4MGE7XG4gIC8vIHJvbS5zY3JlZW5zWzB4YzJdLnRpbGVzWzB4NWJdID0gMHgwYTtcblxuICAvLyBDb25uZWN0IG1hcHNcbiAgRWFzdENhdmUxLm1ldGEuYXR0YWNoKDB4NDMsIEVhc3RDYXZlMi5tZXRhLCAweDQ0KTtcbiAgRWFzdENhdmUxLm1ldGEuYXR0YWNoKDB4NDAsIFZhbGxleU9mV2luZC5tZXRhLCAweDMzKTtcblxuICBpZiAob3B0cy5leGl0MSkge1xuICAgIEVhc3RDYXZlMS5tZXRhLnNldDJkKDB4MDQsIFtbZGVhZEVuZFdfZG93blN0YWlyXV0pOyAvLyBkb3duIHN0YWlyXG4gICAgY29ubmVjdEVhc3RDYXZlRXhpdChFYXN0Q2F2ZTEsIDB4MDQsIG9wdHMuZXhpdDEpO1xuICB9XG5cbiAgaWYgKG9wdHMuZXhpdDIpIHtcbiAgICBFYXN0Q2F2ZTMubWV0YSA9IG5ldyBNZXRhbG9jYXRpb24oRWFzdENhdmUzLmlkLCByb20ubWV0YXRpbGVzZXRzLmNhdmUsIDMsIDEpO1xuICAgIEVhc3RDYXZlMy5tZXRhLnNldDJkKDB4MDAsIFtcbiAgICAgIFtkZWFkRW5kU19zdGFpcnNdLFxuICAgICAgW2hhbGxOU193YWxsXSxcbiAgICAgIFtoYWxsTlNfZW50cmFuY2VdLFxuICAgIF0pO1xuXG4gICAgLy8gQWRkIGEgcm9jayB3YWxsIChpZD0wKS5cbiAgICBFYXN0Q2F2ZTMuc3Bhd25zLnB1c2goU3Bhd24uZnJvbShbMHgxOCwgMHgwNywgMHgyMywgMHgwMF0pKTtcbiAgICBFYXN0Q2F2ZTMuZmxhZ3MucHVzaChGbGFnLm9mKHtzY3JlZW46IDB4MTAsIGZsYWc6IHJvbS5mbGFncy5hbGxvYygweDIwMCl9KSk7XG5cbiAgICAvLyBNYWtlIHRoZSBjb25uZWN0aW9ucy5cbiAgICBFYXN0Q2F2ZTIubWV0YS5zZXQyZCgweDQwLCBbW2RlYWRFbmRFX2Rvd25TdGFpcl1dKTtcbiAgICBFYXN0Q2F2ZTIubWV0YS5hdHRhY2goMHg0MCwgRWFzdENhdmUzLm1ldGEsIDB4MDApO1xuICAgIGNvbm5lY3RFYXN0Q2F2ZUV4aXQoRWFzdENhdmUzLCAweDIwLCBvcHRzLmV4aXQyKTtcbiAgfVxuXG4gIC8vIEFkZCBtb25zdGVyc1xuICBFYXN0Q2F2ZTEuc3Bhd25zLnB1c2goXG4gICAgU3Bhd24ub2Yoe3NjcmVlbjogMHgyMSwgdGlsZTogMHg4NywgdGltZWQ6IHRydWUsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDEyLCB0aWxlOiAweDg4LCB0aW1lZDogZmFsc2UsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDEzLCB0aWxlOiAweDg5LCB0aW1lZDogdHJ1ZSwgaWQ6IDB4Mn0pLFxuICAgIFNwYXduLm9mKHtzY3JlZW46IDB4MzIsIHRpbGU6IDB4NjgsIHRpbWVkOiBmYWxzZSwgaWQ6IDB4Mn0pLFxuICAgIFNwYXduLm9mKHtzY3JlZW46IDB4NDEsIHRpbGU6IDB4ODgsIHRpbWVkOiB0cnVlLCBpZDogMHgyfSksXG4gICAgU3Bhd24ub2Yoe3NjcmVlbjogMHgzMywgdGlsZTogMHg5OCwgdGltZWQ6IHRydWUsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDAzLCB0aWxlOiAweDg4LCB0aW1lZDogdHJ1ZSwgaWQ6IDB4Mn0pLFxuICApO1xuICBFYXN0Q2F2ZTIuc3Bhd25zLnB1c2goXG4gICAgU3Bhd24ub2Yoe3NjcmVlbjogMHgwMSwgdGlsZTogMHg4OCwgdGltZWQ6IHRydWUsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDExLCB0aWxlOiAweDQ4LCB0aW1lZDogZmFsc2UsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDEyLCB0aWxlOiAweDc3LCB0aW1lZDogdHJ1ZSwgaWQ6IDB4Mn0pLFxuICAgIFNwYXduLm9mKHtzY3JlZW46IDB4MTQsIHRpbGU6IDB4MjgsIHRpbWVkOiBmYWxzZSwgaWQ6IDB4Mn0pLFxuICAgIFNwYXduLm9mKHtzY3JlZW46IDB4MjMsIHRpbGU6IDB4ODUsIHRpbWVkOiB0cnVlLCBpZDogMHgyfSksXG4gICAgU3Bhd24ub2Yoe3NjcmVlbjogMHgzMSwgdGlsZTogMHg4OCwgdGltZWQ6IHRydWUsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDMzLCB0aWxlOiAweDhhLCB0aW1lZDogZmFsc2UsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDM0LCB0aWxlOiAweDk4LCB0aW1lZDogdHJ1ZSwgaWQ6IDB4Mn0pLFxuICAgIFNwYXduLm9mKHtzY3JlZW46IDB4NDEsIHRpbGU6IDB4ODIsIHRpbWVkOiB0cnVlLCBpZDogMHgyfSksXG4gICAgLy8gY2hlc3Q6IG1lZGljYWwgaGVyYlxuICAgIFNwYXduLm9mKHt5OiAweDExMCwgeDogMHg0NzgsIHR5cGU6IDIsIGlkOiAweDU5fSksXG4gICAgLy8gY2hlc3Q6IG1pbWljXG4gICAgU3Bhd24ub2Yoe3k6IDB4MDcwLCB4OiAweDEwOCwgdHlwZTogMiwgaWQ6IDB4N2N9KSxcbiAgKTtcbiAgLy8gVE9ETyAtIHRoaXMgaXMgc3VidGxlOiB0aGVyZSdzIGEgaGFuZGZ1bCBvZiBkaWZmZXJlbnQgcGxhY2VzIHRoaXMgY2hlY2tcbiAgLy8gY291bGQgZW5kIHVwLiAgVWx0aW1hdGVseSwgd2UgbmVlZCB0byBtYWtlIHN1cmUgdGhlcmUgYXJlIHVuaXF1ZSBjaGVja3NcbiAgLy8gaW4gdGhlIGVhcmx5IHNwaGVyZXMuICBVbHRpbWF0ZWx5LCB3ZSdkIGxpa2UgdGhlIHN0dWRlbnQgYW5kL29yIGFueSBjaGVzdHNcbiAgLy8gaW4gTWV6YW1lIHRvIGJlIFwidW5pcXVlXCIgYXMgd2VsbCwgYnV0IHdlJ3ZlIG9ubHkgZ290IG9uZSB1bmlxdWUgaXRlbSB0b1xuICAvLyBwbGF5IHdpdGguICBNYXliZSBmaWd1cmUgb3V0IGEgd2F5IHRvIG1hcmsgYSBcInVuaXF1ZVwiIG1lZGljYWwgaGVyYj9cbiAgcm9tLnNsb3RzLnN3YXAoMHgzMSwgMHg1OSk7XG4gIC8vIHN3YXAgb3V0IGFsYXJtIGZsdXRlIGZvciBtZWRpY2FsIGhlcmIgLSB0aGlzIG1ha2VzIGl0IGEgdW5pcXVlIGNoZWNrLlxuICAvLyBXaW5kbWlsbEd1YXJkLmRhdGFbMV0gPSAweDU5OyAvLyBhbGFybSBmbHV0ZSAtPiBtZWRpY2FsIGhlcmJcbiAgLy8gV2luZG1pbGxHdWFyZC5kaWFsb2coTGVhZl9TdHVkZW50SG91c2UpWzBdLmNvbmRpdGlvbiA9IH4weDE1OTtcbn1cblxuZnVuY3Rpb24gY29ubmVjdEVhc3RDYXZlRXhpdChsb2M6IExvY2F0aW9uLCBzY3I6IG51bWJlciwgZXhpdDogRWFzdENhdmVFeGl0KSB7XG4gIGNvbnN0IHtcbiAgICBsb2NhdGlvbnM6IHtcbiAgICAgIENvcmRlbFBsYWluRWFzdCwgQ29yZGVsUGxhaW5XZXN0LCBEZXNlcnQyLCBHb2FWYWxsZXksIExpbWVUcmVlVmFsbGV5LFxuICAgIH0sXG4gICAgbWV0YXNjcmVlbnM6IHtcbiAgICAgIGJlbmRORSwgYmVuZFNFLFxuICAgICAgYm91bmRhcnlOX3RyZWVzLCBib3VuZGFyeVdfY2F2ZSxcbiAgICAgIGNvcm5lck5FLCBjb3JuZXJOVywgY29ybmVyU0UsIGNvcm5lclNFX2NhdmUsIGNvcm5lclNXLFxuICAgIH19ID0gbG9jLnJvbTtcbiAgbGV0IGRlc3Q6IExvY2F0aW9uO1xuICBsZXQgZGVzdFNjcjogbnVtYmVyO1xuICBzd2l0Y2ggKGV4aXQpIHtcbiAgICBjYXNlICdsaW1lJzpcbiAgICAgIC8vIEFkZCBlbnRyYW5jZSB0byBsaW1lIHRyZWUgdmFsbGV5XG4gICAgICBkZXN0ID0gTGltZVRyZWVWYWxsZXk7XG4gICAgICBkZXN0U2NyID0gMHgxMDtcbiAgICAgIGRlc3QucmVzaXplU2NyZWVucygwLCAxLCAwLCAwKTsgLy8gYWRkIG9uZSBzY3JlZW4gdG8gbGVmdCBlZGdlXG4gICAgICBkZXN0Lm1ldGEuc3BsaWNlQ29sdW1ucygwLCAxLCAyLCBbXG4gICAgICAgIFtjb3JuZXJOVywgICAgICAgYm91bmRhcnlOX3RyZWVzXSxcbiAgICAgICAgW2JvdW5kYXJ5V19jYXZlLCBiZW5kU0VdLFxuICAgICAgICBbY29ybmVyU1csICAgICAgIGNvcm5lclNFXSxcbiAgICAgIF0pO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdjb3JkZWwnOlxuICAgICAgY29uc3QgbWFwRWRpdCA9IFtcbiAgICAgICAgW2JvdW5kYXJ5V19jYXZlLCBiZW5kU0VdLFxuICAgICAgICBbY29ybmVyU1csICAgICAgIGNvcm5lclNFXSxcbiAgICAgIF07XG4gICAgICBkZXN0ID0gQ29yZGVsUGxhaW5FYXN0O1xuICAgICAgZGVzdFNjciA9IDB4NTU7XG4gICAgICBkZXN0Lm1ldGEuc2V0MmQoMHg1NSwgbWFwRWRpdCk7XG4gICAgICAvLyBBbHNvIG5lZWQgdG8gbWlycm9yIHRoZSBtYXAgZWRpdCBvbiB3ZXN0XG4gICAgICBDb3JkZWxQbGFpbldlc3QubWV0YS5zZXQyZCgweDU1LCBtYXBFZGl0KTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnZ29hJzpcbiAgICAgIGRlc3QgPSBHb2FWYWxsZXk7XG4gICAgICBkZXN0U2NyID0gMHgxMTtcbiAgICAgIGRlc3QubWV0YS5zZXQyZCgweDAxLCBbXG4gICAgICAgIFtjb3JuZXJOVywgICAgICAgY29ybmVyTkVdLFxuICAgICAgICBbYm91bmRhcnlXX2NhdmUsIGJlbmRORV1dKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnZGVzZXJ0JzpcbiAgICAgIGRlc3QgPSBEZXNlcnQyO1xuICAgICAgZGVzdFNjciA9IDB4NTM7XG4gICAgICBkZXN0Lm1ldGEuc2V0MmQoMHg1MywgW1tjb3JuZXJTRV9jYXZlXV0pO1xuICAgICAgYnJlYWs7XG4gIH1cbiAgbG9jLm1ldGEuYXR0YWNoKHNjciwgZGVzdC5tZXRhLCBkZXN0U2NyKTtcbn1cblxuLy8gUHJvZ3JhbW1hdGljYWxseSBhZGQgYSBob2xlIGJldHdlZW4gdmFsbGV5IG9mIHdpbmQgYW5kIGxpbWUgdHJlZSB2YWxsZXlcbmZ1bmN0aW9uIGNvbm5lY3RMaW1lVHJlZVRvTGVhZihyb206IFJvbSkge1xuICBjb25zdCB7XG4gICAgbG9jYXRpb25zOiB7VmFsbGV5T2ZXaW5kLCBMaW1lVHJlZVZhbGxleX0sXG4gICAgbWV0YXNjcmVlbnM6IHtleGl0RSwgZXhpdFdfc291dGh3ZXN0LCBvdmVyd29ybGRFbXB0eV9hbHR9LFxuICB9ID0gcm9tO1xuXG4gIFZhbGxleU9mV2luZC5tZXRhLnNldDJkKDB4NTQsIFtbZXhpdEVdXSk7XG4gIExpbWVUcmVlVmFsbGV5Lm1ldGEuc2V0MmQoMHgxMCwgW1tleGl0V19zb3V0aHdlc3RdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbb3ZlcndvcmxkRW1wdHlfYWx0XV0pO1xuICBWYWxsZXlPZldpbmQubWV0YS5hdHRhY2goMHg1NCwgTGltZVRyZWVWYWxsZXkubWV0YSwgMHgxMCk7XG59XG5cbmZ1bmN0aW9uIGFkZFRvd2VyRXhpdChyb206IFJvbSkge1xuICBjb25zdCB7VG93ZXJFbnRyYW5jZSwgQ3J5cHRfVGVsZXBvcnRlcn0gPSByb20ubG9jYXRpb25zO1xuICBDcnlwdF9UZWxlcG9ydGVyLm1ldGEuYXR0YWNoKDB4MDAsIFRvd2VyRW50cmFuY2UubWV0YSwgMHgwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndGVsZXBvcnRlcicsICd0ZWxlcG9ydGVyJyk7XG59XG5cbmZ1bmN0aW9uIHJldmVyc2libGVTd2FuR2F0ZShyb206IFJvbSkge1xuICBjb25zdCB7XG4gICAgZmxhZ3M6IHtPcGVuZWRTd2FuR2F0ZX0sXG4gICAgbG9jYXRpb25zOiB7U3dhbkdhdGV9LFxuICAgIG5wY3M6IHtTb2xkaWVyR3VhcmR9LFxuICB9ID0gcm9tO1xuICAvLyBBbGxvdyBvcGVuaW5nIFN3YW4gZnJvbSBlaXRoZXIgc2lkZSBieSBhZGRpbmcgYSBwYWlyIG9mIGd1YXJkcyBvbiB0aGVcbiAgLy8gb3Bwb3NpdGUgc2lkZSBvZiB0aGUgZ2F0ZS5cbiAgU3dhbkdhdGUuc3Bhd25zLnB1c2goXG4gICAgLy8gTk9URTogU29sZGllcnMgbXVzdCBjb21lIGluIHBhaXJzICh3aXRoIGluZGV4IF4xIGZyb20gZWFjaCBvdGhlcilcbiAgICBTcGF3bi5vZih7eHQ6IDB4MGEsIHl0OiAweDAyLCB0eXBlOiAxLCBpZDogMHgyZH0pLCAvLyBuZXcgc29sZGllclxuICAgIFNwYXduLm9mKHt4dDogMHgwYiwgeXQ6IDB4MDIsIHR5cGU6IDEsIGlkOiAweDJkfSksIC8vIG5ldyBzb2xkaWVyXG4gICAgLy9TcGF3bi5vZih7eHQ6IDB4MGUsIHl0OiAweDBhLCB0eXBlOiAyLCBpZDogMHhiM30pLCAvLyBuZXcgdHJpZ2dlcjogZXJhc2UgZ3VhcmRzXG4gICk7XG5cbiAgLy8gLy8gTk9URToganVzdCB1c2UgdGhlIGFjdHVhbCBmbGFnIGluc3RlYWQ/XG4gIC8vIC8vIEd1YXJkcyAoJDJkKSBhdCBzd2FuIGdhdGUgKCQ3MykgfiBzZXQgMGVmIGFmdGVyIG9wZW5pbmcgZ2F0ZSA9PiBjb25kaXRpb24gZm9yIGRlc3Bhd25cbiAgLy8gcm9tLm5wY3NbMHgyZF0ubG9jYWxEaWFsb2dzLmdldCgweDczKSFbMF0uZmxhZ3MucHVzaCgweDBlZik7XG4gIC8vIC8vIERlc3Bhd24gZ3VhcmQgdHJpZ2dlciByZXF1aXJlcyAwZWZcbiAgLy8gcm9tLnRyaWdnZXIoMHhiMykuY29uZGl0aW9ucy5wdXNoKDB4MGVmKTtcbiAgU29sZGllckd1YXJkLmxvY2FsRGlhbG9ncy5nZXQoU3dhbkdhdGUuaWQpIVswXS5mbGFncy5wdXNoKE9wZW5lZFN3YW5HYXRlLmlkKTtcbiAgLy9yb20udHJpZ2dlcigweGIzKS5jb25kaXRpb25zLnB1c2goT3BlbmVkU3dhbkdhdGUuaWQpO1xuICAvLyBUT0RPIC0gY2FuIHdlIGRvIGF3YXkgd2l0aCB0aGUgdHJpZ2dlcj8gIEp1c3Qgc3Bhd24gdGhlbSBvbiB0aGUgc2FtZSBjb25kaXRpb24uLi5cbn1cblxuZnVuY3Rpb24gc3BsaXRTYWJlcmFQYWxhY2UyKHJvbTogUm9tKSB7XG4gIHNwbGl0TWFwKHJvbS5sb2NhdGlvbnMuU2FiZXJhUGFsYWNlMl9XZXN0LCByb20ubG9jYXRpb25zLlNhYmVyYVBhbGFjZTIsXG4gICAgICAgICAgIDB4MDAsIDB4MDEsIDB4MTAsIDB4MjAsIDB4MzAsIDB4MzEsIDB4NDEsIDB4NTEsIDB4NjEpO1xufVxuXG4vLyBmdW5jdGlvbiBzcGxpdFN0eXgyKHJvbTogUm9tKSB7XG4vLyAgIGNvbnN0IHtyaXZlckNhdmVfZGVhZEVuZHNFLCByaXZlckNhdmVfZGVhZEVuZHNXfSA9IHJvbS5tZXRhc2NyZWVucztcbi8vICAgc3BsaXRNYXAocm9tLmxvY2F0aW9ucy5TdHl4Ml9FYXN0LCByb20ubG9jYXRpb25zLlN0eXgyLFxuLy8gICAgICAgICAgICAweDI0LCAweDMzLCAweDM0LCAweDQzLCAweDQ0LCAweDUzKTtcbi8vICAgcm9tLmxvY2F0aW9ucy5TdHl4Mi5tZXRhLnNldCgweDQyLCByaXZlckNhdmVfZGVhZEVuZHNXKTtcbi8vICAgcm9tLmxvY2F0aW9ucy5TdHl4Ml9FYXN0Lm1ldGEuc2V0KDB4NDIsIHJpdmVyQ2F2ZV9kZWFkRW5kc0UpO1xuLy8gfVxuXG4vLyBNb3ZlcyB0aGUgbGlzdGVkIHBvcyBmcm9tIG9uZSBsb2NhdGlvbiB0byBhIG5ldyBvbmUgKGkuZS4gZm9yIG1hcHMgdGhhdFxuLy8gYXJlIGFjdHVhbGx5IGRpc2Nvbm5lY3RlZCkuXG5mdW5jdGlvbiBzcGxpdE1hcChuZXdMb2M6IExvY2F0aW9uLCBsb2M6IExvY2F0aW9uLCAuLi5zcGxpdFBvczogbnVtYmVyW10pIHtcbiAgY29uc3Qgcm9tID0gbmV3TG9jLnJvbTtcbiAgcm9tLmxvY2F0aW9ucy5hbGxvY2F0ZShuZXdMb2MsIGxvYyk7XG4gIG5ld0xvYy5iZ20gPSBsb2MuYmdtO1xuICBuZXdMb2MuZW50cmFuY2VzID0gW107XG4gIG5ld0xvYy5leGl0cyA9IFtdO1xuICBuZXdMb2MucGl0cyA9IFtdO1xuICBuZXdMb2Muc3Bhd25zID0gW107XG4gIG5ld0xvYy5mbGFncyA9IFtdO1xuICBuZXdMb2Mud2lkdGggPSBuZXdMb2MuaGVpZ2h0ID0gMTtcbiAgbmV3TG9jLnNjcmVlbnMgPSBbWzB4ODBdXTtcbiAgbmV3TG9jLnRpbGVQYWxldHRlcyA9IGNsb25lQXJyYXkobG9jLnRpbGVQYWxldHRlcyk7XG4gIG5ld0xvYy5vcmlnaW5hbFRpbGVQYWxldHRlcyA9IGNsb25lQXJyYXkobG9jLm9yaWdpbmFsVGlsZVBhbGV0dGVzKTtcbiAgbmV3TG9jLnRpbGVzZXQgPSBsb2MudGlsZXNldDtcbiAgbmV3TG9jLnRpbGVFZmZlY3RzID0gbG9jLnRpbGVFZmZlY3RzO1xuICBuZXdMb2MudGlsZVBhdHRlcm5zID0gY2xvbmVBcnJheShsb2MudGlsZVBhdHRlcm5zKTtcbiAgbmV3TG9jLnNwcml0ZVBhdHRlcm5zID0gY2xvbmVBcnJheShsb2Muc3ByaXRlUGF0dGVybnMpO1xuICBuZXdMb2Muc3ByaXRlUGFsZXR0ZXMgPSBjbG9uZUFycmF5KGxvYy5zcHJpdGVQYWxldHRlcyk7XG5cbiAgbGV0IGggPSAwO1xuICBsZXQgdyA9IDA7XG4gIGZvciAoY29uc3QgcG9zIG9mIHNwbGl0UG9zKSB7XG4gICAgaCA9IE1hdGgubWF4KGgsIChwb3MgPj4+IDQpICsgMSk7XG4gICAgdyA9IE1hdGgubWF4KHcsIChwb3MgJiAweGYpICsgMSk7XG4gIH1cbiAgbmV3TG9jLm1ldGEgPSBuZXcgTWV0YWxvY2F0aW9uKG5ld0xvYy5pZCwgbG9jLm1ldGEudGlsZXNldCwgaCwgdyk7XG4gIGZvciAoY29uc3QgcG9zIG9mIHNwbGl0UG9zKSB7XG4gICAgbmV3TG9jLm1ldGEuc2V0KHBvcywgbG9jLm1ldGEuZ2V0KHBvcykpO1xuICAgIGxvYy5tZXRhLnNldChwb3MsIGxvYy5tZXRhLnRpbGVzZXQuZW1wdHkpO1xuICB9XG4gIGNvbnN0IHBvc1NldCA9IG5ldyBTZXQoc3BsaXRQb3MpO1xuICBuZXdMb2MuZmxhZ3MgPSBsb2MuZmxhZ3MuZmlsdGVyKGYgPT4gcG9zU2V0LmhhcyhmLnNjcmVlbikpO1xuICBsb2MuZmxhZ3MgPSBsb2MuZmxhZ3MuZmlsdGVyKGYgPT4gIXBvc1NldC5oYXMoZi5zY3JlZW4pKTtcbiAgbmV3TG9jLnNwYXducyA9IGxvYy5zcGF3bnMuZmlsdGVyKHMgPT4gcG9zU2V0LmhhcyhzLnNjcmVlbikpO1xuICBsb2Muc3Bhd25zID0gbG9jLnNwYXducy5maWx0ZXIocyA9PiAhcG9zU2V0LmhhcyhzLnNjcmVlbikpO1xuICBsb2MubWV0YS5tb3ZlRXhpdHNBbmRQaXRzVG8obmV3TG9jLm1ldGEpO1xufVxuXG5cbi8qKiBNYWRvIDIncyBhcmVhIGhhcyBhIDR4NCBzZWN0aW9uIG9mIHVudXNlZCB0aWxlcyBhdCB0aGUgdG9wLiAgRGVsZXRlIHRoZW0uICovXG5mdW5jdGlvbiBzaHJpbmtNYWRvMihyb206IFJvbSkge1xuICAvLyBUT0RPIC0gaW1wbGVtZW50IHNwbGljZVJvd3NcbiAgLy8gcm9tLmxvY2F0aW9ucy5Hb2FGb3J0cmVzc19NYWRvMy5tZXRhLnNwbGljZVJvd3MoMCwgNCwgMCwgW10pO1xufVxuXG4vLyBmdW5jdGlvbiBjbG9zZUNhdmVFbnRyYW5jZXMocm9tOiBSb20pOiB2b2lkIHtcbi8vICAgLy8gRGVzdHJ1Y3R1cmUgb3V0IGEgZmV3IGxvY2F0aW9ucyBieSBuYW1lXG4vLyAgIGNvbnN0IHtcbi8vICAgICBmbGFnczoge0Fsd2F5c1RydWUsIE9wZW5lZFNlYWxlZENhdmUsIE9wZW5lZFByaXNvbn0sXG4vLyAgICAgbG9jYXRpb25zOiB7XG4vLyAgICAgICBDb3JkZWxQbGFpbkVhc3QsIENvcmRlbFBsYWluV2VzdCwgRGVzZXJ0Mixcbi8vICAgICAgIEtpcmlzYU1lYWRvdywgU2FoYXJhT3V0c2lkZUNhdmUsIFZhbGxleU9mV2luZCxcbi8vICAgICAgIFdhdGVyZmFsbFZhbGxleU5vcnRoLCBXYXRlcmZhbGxWYWxsZXlTb3V0aCxcbi8vICAgICB9LFxuLy8gICB9ID0gcm9tO1xuXG4vLyAgIC8vIC8vIFByZXZlbnQgc29mdGxvY2sgZnJvbSBleGl0aW5nIHNlYWxlZCBjYXZlIGJlZm9yZSB3aW5kbWlsbCBzdGFydGVkXG4vLyAgIC8vIFZhbGxleU9mV2luZC5lbnRyYW5jZXNbMV0ueSArPSAxNjsgLy8gdW5uZWVkZWQgYWZ0ZXIgZW50cmFuY2Ugbm9ybWFsaXphdGlvblxuXG4vLyAgIC8vIENsZWFyIHRpbGVzIDEsMiwzLDQgZm9yIGJsb2NrYWJsZSBjYXZlcyBpbiB0aWxlc2V0cyA5MCwgOTQsIGFuZCA5Y1xuXG4vLyAgIC8vIC8vIE5PVEU6IGZsYWcgMmYwIGlzIEFMV0FZUyBzZXQgLSB1c2UgaXQgYXMgYSBiYXNlbGluZS5cbi8vICAgLy8gY29uc3QgZmxhZ3NUb0NsZWFyOiBbTG9jYXRpb24sIG51bWJlcl1bXSA9IFtcbi8vICAgLy8gICBbVmFsbGV5T2ZXaW5kLCAweDMwXSwgLy8gdmFsbGV5IG9mIHdpbmQsIHplYnUncyBjYXZlXG4vLyAgIC8vICAgLy9bQ29yZGVsUGxhaW5XZXN0LCAweDMwXSwgLy8gY29yZGVsIHdlc3QsIHZhbXBpcmUgY2F2ZVxuLy8gICAvLyAgIC8vW0NvcmRlbFBsYWluRWFzdCwgMHgzMF0sIC8vIGNvcmRlbCBlYXN0LCB2YW1waXJlIGNhdmVcbi8vICAgLy8gICAvL1tXYXRlcmZhbGxWYWxsZXlOb3J0aCwgMHgwMF0sIC8vIHdhdGVyZmFsbCBub3J0aCwgcHJpc29uIGNhdmVcbi8vICAgLy8gICBbV2F0ZXJmYWxsVmFsbGV5Tm9ydGgsIDB4MTRdLCAvLyB3YXRlcmZhbGwgbm9ydGgsIGZvZyBsYW1wXG4vLyAgIC8vICAgW1dhdGVyZmFsbFZhbGxleVNvdXRoLCAweDc0XSwgLy8gd2F0ZXJmYWxsIHNvdXRoLCBraXJpc2Fcbi8vICAgLy8gICBbS2lyaXNhTWVhZG93LCAweDEwXSwgLy8ga2lyaXNhIG1lYWRvd1xuLy8gICAvLyAgIFtTYWhhcmFPdXRzaWRlQ2F2ZSwgMHgwMF0sIC8vIGNhdmUgdG8gZGVzZXJ0XG4vLyAgIC8vICAgW0Rlc2VydDIsIDB4NDFdLFxuLy8gICAvLyBdO1xuLy8gICAvLyBmdW5jdGlvbiBwdXNoRmxhZyhsb2M6IExvY2F0aW9uLCBzY3JlZW46IG51bWJlciwgZmxhZzogZmxhZ3MuRmxhZykge1xuLy8gICAvLyAgIGxvYy5mbGFncy5wdXNoKEZsYWcub2Yoe3NjcmVlbiwgZmxhZzogZmxhZy5pZH0pKTtcbi8vICAgLy8gfVxuXG4vLyAgIC8vIGZvciAoY29uc3QgW2xvYywgc2NyZWVuXSBvZiBmbGFnc1RvQ2xlYXIpIHtcbi8vICAgLy8gICBwdXNoRmxhZyhsb2MsIHNjcmVlbiwgQWx3YXlzVHJ1ZSk7XG4vLyAgIC8vIH1cblxuLy8gICAvLyBOT1RFIC0gdGhpcyB1c2VkIHRvIGJlIGNvbmZpZ3VyYWJsZS4uLlxuXG4vLyAgIC8vIGZ1bmN0aW9uIHJlcGxhY2VGbGFnKGxvYzogTG9jYXRpb24sIHl4OiBudW1iZXIsIGZsYWc6IG51bWJlcik6IHZvaWQge1xuLy8gICAvLyAgIGZvciAoY29uc3QgZiBvZiBsb2MuZmxhZ3MpIHtcbi8vICAgLy8gICAgIGlmIChmLnl4ID09PSB5eCkge1xuLy8gICAvLyAgICAgICBmLmZsYWcgPSBmbGFnO1xuLy8gICAvLyAgICAgICByZXR1cm47XG4vLyAgIC8vICAgICB9XG4vLyAgIC8vICAgfVxuLy8gICAvLyAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgZmxhZyB0byByZXBsYWNlIGF0ICR7bG9jfToke3l4fWApO1xuLy8gICAvLyB9O1xuXG4vLyAgIC8vIE5PVEU6IHdlIGNvdWxkIGFsc28gY2xvc2UgaXQgb2ZmIHVudGlsIGJvc3Mga2lsbGVkLi4uP1xuLy8gICAvLyAgLSBjb25zdCB2YW1waXJlRmxhZyA9IH5yb20ubnBjU3Bhd25zWzB4YzBdLmNvbmRpdGlvbnNbMHgwYV1bMF07XG4vLyAgIC8vICAtPiBrZWxiZXNxdWUgZm9yIHRoZSBvdGhlciBvbmUuXG4vLyAgIHB1c2hGbGFnKENvcmRlbFBsYWluV2VzdCwgMHgzMCwgT3BlbmVkU2VhbGVkQ2F2ZSk7XG4vLyAgIHB1c2hGbGFnKENvcmRlbFBsYWluRWFzdCwgMHgzMCwgT3BlbmVkU2VhbGVkQ2F2ZSk7XG4vLyAgIHB1c2hGbGFnKFdhdGVyZmFsbFZhbGxleU5vcnRoLCAweDAwLCBPcGVuZWRQcmlzb24pO1xuLy8gICBjb25zdCBleHBsb3Npb24gPSBTcGF3bi5vZih7eTogMHgwNjAsIHg6IDB4MDYwLCB0eXBlOiA0LCBpZDogMHgyY30pO1xuLy8gICBjb25zdCBrZXlUcmlnZ2VyID0gU3Bhd24ub2Yoe3k6IDB4MDcwLCB4OiAweDA3MCwgdHlwZTogMiwgaWQ6IDB4YWR9KTtcbi8vICAgV2F0ZXJmYWxsVmFsbGV5Tm9ydGguc3Bhd25zLnNwbGljZSgxLCAwLCBleHBsb3Npb24pO1xuLy8gICBXYXRlcmZhbGxWYWxsZXlOb3J0aC5zcGF3bnMucHVzaChrZXlUcmlnZ2VyKTtcbi8vIH1cblxuZnVuY3Rpb24gcmVtb3ZlVW51c2VkR29hS2Vuc3VFeGl0cyhyb206IFJvbSkge1xuICAvLyBUaGVzZSBleGl0cyBhcmUgbmV2ZXIgYWN0dWFsbHkgcmVhY2hhYmxlLCBhbmQgdGhleSBjYXVzZSBwcm9ibGVtc1xuICAvLyB3aGVuIHRoZWlyIG90aGVyIHNpZGUgZW5kcyB1cCBnZXR0aW5nIHNodWZmbGVkLiAgUG9zc2libHkgdGhlIGJlc3RcbiAgLy8gb3B0aW9uIGlzIHRvIGRldGVjdCB0aGUgdW5yZWNpcHJvY2F0ZWQgZXhpdHMgYW5kIHVwZGF0ZSB0aGVtIHdoZW5cbiAgLy8gd2UgdHJhbnNmZXIuICBCdXQgZm9yIG5vdyB0aGlzIGlzIGFsbCB0aGF0J3MgcmVhbGx5IG5lZWRlZC5cbiAgY29uc3QgbWV0YSA9IHJvbS5sb2NhdGlvbnMuR29hRm9ydHJlc3NfS2Vuc3UubWV0YTtcbiAgZm9yIChjb25zdCBbcG9zLCB0eXBlXSBvZiBtZXRhLmV4aXRzKCkpIHtcbiAgICBpZiAocG9zIDwgMHgxMCB8fCB0eXBlLnN0YXJ0c1dpdGgoJ3NlYW1sZXNzJykpIGNvbnRpbnVlO1xuICAgIG1ldGEuZGVsZXRlRXhpdChwb3MsIHR5cGUpO1xuICB9XG5cbiAgLy8gTk9URTogbWFwcyAkMjEgYW5kICRiYSBhcmUgc2VhbWxlc3MgcGFpcnMgb2YgbWFwcyB3aXRoIGZsYWdzLCBidXQgdGhleVxuICAvLyBsYWNrIHRoZSBhY3R1YWwgc2FtZSBmbGFncy4gIFdlIG5lZWQgdG8ga2VlcCB0aGVtIGluIHN5bmMuLi4/ICBQcm9iYWJseVxuICAvLyBzaG91bGRuJ3QgYWxsb2NhdGUgYSBzZXBhcmF0ZSBmbGFnIGZvciB0aGVtIC0ganVzdCByZXVzZSB0aGUgb3RoZXIgb25lLlxufVxuXG5mdW5jdGlvbiBhZGp1c3RBYmR1Y3Rpb25UcmlnZ2VyKHJvbTogUm9tKSB7XG4gIC8vIEVuc3VyZSB3ZSBjYW4gc3RlcCBvbiBpdCBldmVuIHdoZW4gdGhlcmUncyBqdXN0IGEgc29saWQgd2FsbCBiZWhpbmQgdGhlXG4gIC8vIGJyZWFrYWJsZSB3YWxsLlxuICByb20ubG9jYXRpb25zLlplYnVDYXZlLnNwYXducy5maW5kKHMgPT4gcy5pc1RyaWdnZXIoKSkhLnl0ICs9IDM7XG59XG4iXX0=