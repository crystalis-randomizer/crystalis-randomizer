export class PyramidShuffle {
    constructor(location) {
        this.location = location;
    }
    shuffle(random) {
        if (this.meta)
            throw new Error(`impossible`);
        const meta = this.location.meta;
        moveInternalStair(meta, random);
        if (random.nextInt(2))
            invertPyramidExit(this.location.rom);
        const up = [...meta.exits()].filter(e => e[1] === 'stair:up');
        const dn = [...meta.exits()].filter(e => e[1] === 'stair:down');
        random.shuffle(up);
        random.shuffle(dn);
        for (const e of [...meta.exits()]) {
            if ((e[2][0] >>> 8) !== this.location.id) {
                const next = (e[1] === 'stair:up' ? up : dn).pop();
                meta.setExit(next[0], next[1], e[2]);
            }
        }
        if (up.length !== dn.length)
            throw new Error(`length mismatch`);
        const dn2 = random.shuffle([...dn]);
        for (let i = 0; i < dn.length; i++) {
            if (dn[i] === dn2[i]) {
                random.shuffle(dn2);
                i = -1;
            }
        }
        const self = this.location.id << 8;
        for (let i = 0; i < up.length; i++) {
            meta.setExitOneWay(up[i][0], up[i][1], [self | dn[i][0], dn[i][1]]);
            meta.setExitOneWay(dn2[i][0], dn2[i][1], [self | up[i][0], up[i][1]]);
        }
        this.meta = meta;
    }
    finish() { }
}
function moveInternalStair(meta, random) {
    const y = random.nextInt(2) + 6;
    const x = random.nextInt(3) + 2;
    if (y === 7 && x === 3)
        return;
    const { branchNWSE, branchNWE, branchWSE, branchNWE_upStair, deadEndW, deadEndE } = meta.rom.metascreens;
    const pos = y << 4 | x;
    let bottom = branchWSE;
    if (y === 7 && x === 1)
        bottom = deadEndE;
    if (y === 7 && x === 5)
        bottom = deadEndW;
    meta.set2d(0x63, [[branchNWSE], [branchNWSE], [branchNWSE]]);
    meta.set2d(pos - 16, [[branchNWE], [branchNWE_upStair], [bottom]]);
    meta.moveExit(0x73, pos);
}
function invertPyramidExit(rom) {
    const draygon = rom.locations.Pyramid_Draygon.meta;
    const main = rom.locations.Pyramid_Main.meta;
    const { metascreens: { hallSE, deadEndW_downStair, wideHallNE, wideHallNW, fortressArena_through, deadEndS_stairs } } = rom;
    draygon.width = 2;
    draygon.set2d(0x00, [[null, deadEndS_stairs],
        [null, fortressArena_through],
        [wideHallNE, wideHallNW]]);
    draygon.moveExit(0x20, 0x01);
    main.set2d(0x03, [[hallSE, deadEndW_downStair]]);
    main.moveExit(0x03, 0x04);
    main.attach(0x04, draygon, 0x01);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHlyYW1pZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9qcy9tYXplL3B5cmFtaWQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBVUEsTUFBTSxPQUFPLGNBQWM7SUFJekIsWUFBcUIsUUFBa0I7UUFBbEIsYUFBUSxHQUFSLFFBQVEsQ0FBVTtJQUFHLENBQUM7SUFHM0MsT0FBTyxDQUFDLE1BQWM7UUFDcEIsSUFBSSxJQUFJLENBQUMsSUFBSTtZQUFFLE1BQU0sSUFBSSxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDN0MsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUM7UUFDaEMsaUJBQWlCLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBRWhDLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7WUFBRSxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBRTVELE1BQU0sRUFBRSxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssVUFBVSxDQUFDLENBQUM7UUFDOUQsTUFBTSxFQUFFLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxZQUFZLENBQUMsQ0FBQztRQUNoRSxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ25CLE1BQU0sQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUM7UUFFbkIsS0FBSyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDLEVBQUU7WUFDakMsSUFBSSxDQUFDLENBQUMsQ0FB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RTdCLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxNQUFNLEVBQUUsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDakQsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFFMUIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ25DLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBMb2NhdGlvbiB9IGZyb20gJy4uL3JvbS9sb2NhdGlvbi5qcyc7XG5pbXBvcnQgeyBSYW5kb20gfSBmcm9tICcuLi9yYW5kb20uanMnO1xuaW1wb3J0IHsgUm9tIH0gZnJvbSAnLi4vcm9tLmpzJztcbmltcG9ydCB7IE1ldGFsb2NhdGlvbiB9IGZyb20gJy4uL3JvbS9tZXRhbG9jYXRpb24uanMnO1xuaW1wb3J0IHsgTWF6ZVNodWZmbGUgfSBmcm9tICcuL21hemUuanMnO1xuXG4vLyBUT0RPIC0gd2UgY291bGQgZG8gYSBiaXQgbW9yZSBtYXAgZ2VuOiByYW5kb21pemUgd2hpY2ggaGFsbCBoYXMgdGhlIGlubmVyXG4vLyBzdGFpciAob3IgbWFrZSBtb3JlIG9mIHRoZW0pLCBhZGQgc29tZSBkZWFkIGVuZHMgaW5zdGVhZCBvZiBzdGFpcnMsIGFkZFxuLy8gZXh0cmEgYnJhbmNoZXMgb24gdGhlIGVkZ2UvY29ybmVyLCBldGMuXG5cbmV4cG9ydCBjbGFzcyBQeXJhbWlkU2h1ZmZsZSBpbXBsZW1lbnRzIE1hemVTaHVmZmxlIHtcblxuICBtZXRhOiBNZXRhbG9jYXRpb258dW5kZWZpbmVkO1xuXG4gIGNvbnN0cnVjdG9yKHJlYWRvbmx5IGxvY2F0aW9uOiBMb2NhdGlvbikge31cblxuICAvLyBUaGlzIGlzIGEgZGlmZmVyZW50IHN0eWxlIG9mIHNodWZmbGUuICBcbiAgc2h1ZmZsZShyYW5kb206IFJhbmRvbSkge1xuICAgIGlmICh0aGlzLm1ldGEpIHRocm93IG5ldyBFcnJvcihgaW1wb3NzaWJsZWApO1xuICAgIGNvbnN0IG1ldGEgPSB0aGlzLmxvY2F0aW9uLm1ldGE7XG4gICAgbW92ZUludGVybmFsU3RhaXIobWV0YSwgcmFuZG9tKTtcbiAgICAvLyA1MCUgY2hhbmNlIG9mIHN3YXBwaW5nIHRoZSBleGl0IHRvIGEgZG93bnN0YWlyLlxuICAgIGlmIChyYW5kb20ubmV4dEludCgyKSkgaW52ZXJ0UHlyYW1pZEV4aXQodGhpcy5sb2NhdGlvbi5yb20pO1xuICAgIC8vIENvbGxlY3QgYWxsIHRoZSBleGl0cywgZ3JvdXBlZCBieSBkaXJlY3Rpb24uXG4gICAgY29uc3QgdXAgPSBbLi4ubWV0YS5leGl0cygpXS5maWx0ZXIoZSA9PiBlWzFdID09PSAnc3RhaXI6dXAnKTtcbiAgICBjb25zdCBkbiA9IFsuLi5tZXRhLmV4aXRzKCldLmZpbHRlcihlID0+IGVbMV0gPT09ICdzdGFpcjpkb3duJyk7XG4gICAgcmFuZG9tLnNodWZmbGUodXApO1xuICAgIHJhbmRvbS5zaHVmZmxlKGRuKTtcbiAgICAvLyBGaW5kIGV4aXRzIHRoYXQgZ28gYW55d2hlcmUgYW5kIHN3YXAgdGhlbS5cbiAgICBmb3IgKGNvbnN0IGUgb2YgWy4uLm1ldGEuZXhpdHMoKV0pIHtcbiAgICAgIGlmICgoZVsyXVswXSA+Pj4gOCkgIT09IHRoaXMubG9jYXRpb24uaWQpIHtcbiAgICAgICAgLy8gVGhpcyBpcyBhIHJlYWwgZXhpdCwgc28gcG9wIGl0IG91dCBvZiB0aGUgcmVsZXZhbnQgbGlzdFxuICAgICAgICBjb25zdCBuZXh0ID0gKGVbMV0gPT09ICdzdGFpcjp1cCcgPyB1cCA6IGRuKS5wb3AoKSE7XG4gICAgICAgIG1ldGEuc2V0RXhpdChuZXh0WzBdLCBuZXh0WzFdLCBlWzJdKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHVwLmxlbmd0aCAhPT0gZG4ubGVuZ3RoKSB0aHJvdyBuZXcgRXJyb3IoYGxlbmd0aCBtaXNtYXRjaGApO1xuICAgIGNvbnN0IGRuMiA9IHJhbmRvbS5zaHVmZmxlKFsuLi5kbl0pO1xuICAgIC8vIG1ha2Ugc3VyZSBkbjIgaXMgYWN0dWFsbHkgYSBkZXJhbmdlbWVudCBvZiBkbiAocHJldmVudCBjbG9zaW5nIG91dCB0aGVcbiAgICAvLyBjaGVzdCByb29tIGFzIGluYWNjZXNzaWJsZSkuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkbi5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGRuW2ldID09PSBkbjJbaV0pIHtcbiAgICAgICAgcmFuZG9tLnNodWZmbGUoZG4yKTtcbiAgICAgICAgaSA9IC0xO1xuICAgICAgfVxuICAgIH1cbiAgICAvLyB6aXAgdGhlIGV4aXRzIHRvZ2V0aGVyXG4gICAgY29uc3Qgc2VsZiA9IHRoaXMubG9jYXRpb24uaWQgPDwgODtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHVwLmxlbmd0aDsgaSsrKSB7XG4gICAgICBtZXRhLnNldEV4aXRPbmVXYXkodXBbaV1bMF0sIHVwW2ldWzFdLCBbc2VsZiB8IGRuW2ldWzBdLCBkbltpXVsxXV0pO1xuICAgICAgbWV0YS5zZXRFeGl0T25lV2F5KGRuMltpXVswXSwgZG4yW2ldWzFdLCBbc2VsZiB8IHVwW2ldWzBdLCB1cFtpXVsxXV0pO1xuICAgIH1cbiAgICB0aGlzLm1ldGEgPSBtZXRhO1xuICB9XG5cbiAgZmluaXNoKCkge31cbn1cblxuZnVuY3Rpb24gbW92ZUludGVybmFsU3RhaXIobWV0YTogTWV0YWxvY2F0aW9uLCByYW5kb206IFJhbmRvbSkge1xuICAvLyB5IHdpbGwgYmUgZWl0aGVyIDYgb3IgNywgeCB3aWxsIGJlIFsxLi41XSAob3IgMi4uNClcbiAgY29uc3QgeSA9IHJhbmRvbS5uZXh0SW50KDIpICsgNjtcbiAgY29uc3QgeCA9IHJhbmRvbS5uZXh0SW50KDMpICsgMjsgLy8gKDUpICsgMVxuICBpZiAoeSA9PT0gNyAmJiB4ID09PSAzKSByZXR1cm47XG4gIGNvbnN0IHticmFuY2hOV1NFLCBicmFuY2hOV0UsIGJyYW5jaFdTRSwgYnJhbmNoTldFX3VwU3RhaXIsXG4gICAgICAgICBkZWFkRW5kVywgZGVhZEVuZEV9ID0gbWV0YS5yb20ubWV0YXNjcmVlbnM7XG4gIGNvbnN0IHBvcyA9IHkgPDwgNCB8IHg7XG4gIGxldCBib3R0b20gPSBicmFuY2hXU0U7XG4gIGlmICh5ID09PSA3ICYmIHggPT09IDEpIGJvdHRvbSA9IGRlYWRFbmRFO1xuICBpZiAoeSA9PT0gNyAmJiB4ID09PSA1KSBib3R0b20gPSBkZWFkRW5kVztcbiAgbWV0YS5zZXQyZCgweDYzLCBbW2JyYW5jaE5XU0VdLCBbYnJhbmNoTldTRV0sIFticmFuY2hOV1NFXV0pO1xuICBtZXRhLnNldDJkKHBvcyAtIDE2LCBbW2JyYW5jaE5XRV0sIFticmFuY2hOV0VfdXBTdGFpcl0sIFtib3R0b21dXSk7XG4gIG1ldGEubW92ZUV4aXQoMHg3MywgcG9zKTtcbn1cblxuZnVuY3Rpb24gaW52ZXJ0UHlyYW1pZEV4aXQocm9tOiBSb20pIHtcbiAgLy8gTmVlZCB0byBkbyBhIGZldyBtaW5vciB0d2Vha3MgdG8gdHdvIG1hcHMuXG4gIGNvbnN0IGRyYXlnb24gPSByb20ubG9jYXRpb25zLlB5cmFtaWRfRHJheWdvbi5tZXRhO1xuICBjb25zdCBtYWluID0gcm9tLmxvY2F0aW9ucy5QeXJhbWlkX01haW4ubWV0YTtcblxuICAvLyBDaGFuZ2UgYSBmZXcgc2NyZWVucy5cbiAgY29uc3Qge21ldGFzY3JlZW5zOiB7aGFsbFNFLCBkZWFkRW5kV19kb3duU3RhaXIsIHdpZGVIYWxsTkUsIHdpZGVIYWxsTlcsXG4gICAgICAgICAgICAgICAgICAgICAgIGZvcnRyZXNzQXJlbmFfdGhyb3VnaCwgZGVhZEVuZFNfc3RhaXJzfX0gPSByb207XG4gIGRyYXlnb24ud2lkdGggPSAyO1xuICAvLyBUT0RPIC0gaWYgd2UgaGF2ZSBzY3JlZW5zIGF2YWlsYWJsZSB0byBtYWtlIHRoaXMgc21vb3RoZXIsIHVzZSB0aGVtLlxuICBkcmF5Z29uLnNldDJkKDB4MDAsIFtbbnVsbCwgZGVhZEVuZFNfc3RhaXJzXSxcbiAgICAgICAgICAgICAgICAgICAgICAgW251bGwsIGZvcnRyZXNzQXJlbmFfdGhyb3VnaF0sXG4gICAgICAgICAgICAgICAgICAgICAgIFt3aWRlSGFsbE5FLCB3aWRlSGFsbE5XXV0pO1xuICBkcmF5Z29uLm1vdmVFeGl0KDB4MjAsIDB4MDEpO1xuXG4gIG1haW4uc2V0MmQoMHgwMywgW1toYWxsU0UsIGRlYWRFbmRXX2Rvd25TdGFpcl1dKTtcbiAgbWFpbi5tb3ZlRXhpdCgweDAzLCAweDA0KTtcblxuICBtYWluLmF0dGFjaCgweDA0LCBkcmF5Z29uLCAweDAxKTsgLy8gd2lsbCBhdXRvbWF0aWNhbGx5IHN3YXAgb3V0IHRoZSByZXN0XG59XG4iXX0=