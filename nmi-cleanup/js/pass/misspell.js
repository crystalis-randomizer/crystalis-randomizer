const ITEMS = new Map([
    ['Sword of Wind', ['Sord of Wind', 'Sowrd of Wind', 'Sword of Wien']],
    ['Sword of Fire', ['Sword of Frirer']],
    ['Sword of Water', ['Horde of Otters']],
    ['Sword of Thunder', ['Sorg of Chunker']],
    ['Flame Bracelet', ['Fame Bracelet']],
    ['Storm Bracelet', ['Stom Bracelet']],
    ['Sacred Shield', ['Scared Shield']],
    ['Bow of Truth', ['Bow of Strewth']],
    ['Statue of Onyx', ['Statue of Onxy']],
    ['Ivory Statue', ['Ivory Statute']],
    ['Fog Lamp', ['Frog Lamp', 'Smog Lamp', 'Dog Lamp', 'Bog Lamp', 'Fog Lump']],
    ['Glowing Lamp', ['Glowing Lump']],
    ['Key to Stxy', ['Key to Styx']],
    ['Insect Flute', ['Bug Flute', 'Bug Whistle']],
    ['Flute of Lime', ['Flute of Grime']],
    ['Iron Necklace', ['I Ron Necklace']],
    ['Shield Ring', ['Sho Ring']],
    ['Deo\'s Pendant', ['Rabbit Necklace', 'Bunny Pendant']],
    ['Speed Boots', ['Hermes Sandals']],
    ['Rabbit Boots', ['Deo\'s Boots', 'Jumping Boots', 'Rabid Boots']],
    ['Alarm Flute', ['Pocket Rooster', 'Alarm Clock']],
    ['Shell Flute', ['Conch Shell', 'Dolphin Flute']],
    ['Eye Glasses', ['3D Glasses', 'X-Ray Goggles']],
    ['Kirisa Plant', ['Kilika Plant']],
    ['Refresh', ['Refresherize', 'Cure', 'Cura', 'Curaga']],
    ['Recover', ['Recoverize', 'Esuna']],
    ['Paralysis', ['Paralycize', 'Stop', 'Pew Pew']],
    ['Telepathy', ['Telepathize', 'Clairvoyance', 'ESP', 'Head Talk']],
    ['Teleport', ['Teleportate', 'Warp', 'Go']],
    ['Change', ['Changeify', 'Transform', 'Disguise']],
    ['Barrier', ['Barrierize', 'Protect', 'Wall', 'Shield']],
    ['Flight', ['Flyify', 'Blight', 'Super Jump']],
    ['Fruit of Lime', ['Fruit of Crime', 'Gold Needle', 'Soft']],
    ['Medical Herb', ['Potion', 'Hi Potion']],
    ['Fruit of Repun', ['Anti-Slime Pill', 'Maiden\'s Kiss']],
]);
const CHARACTERS = new Map([
    ['Aryllis', ['Mimic Queen']],
    ['Akahana', ['Steve', 'Jerkahana', 'Mashamahana']],
    ['Asina', ['Athena', 'Jrowina']],
    ['Azteca', ['Steve']],
    ['Clark', ['Steve', 'Fred', 'Mattrick', 'Clarktrick']],
    ['Deo', ['Steve']],
    ['Kelbesque', ['Linebacker']],
    ['Kensu', ['Steve', 'Jerksu']],
    ['Karmine', ['Slimelord']],
    ['Nadare', ['Steve']],
    ['Mado', ['Steve']],
    ['Rage', ['Steve']],
    ['Sabera', ['Flamelord']],
    ['Stom', ['Steve']],
    ['Tornel', ['Steve']],
    ['Zebu', ['Steve', 'Pervy Old Man']],
]);
const MONSTERS = new Map([
    ['Poison Slime', ['Mattrick Slime']],
    ['Mud Golem', ['Bear']],
    ['Axe Wereboar', ['The Axeman']],
    ['Pillbug', ['Tomato']],
    ['Ice Golem', ['Polar Bear']],
    ['Flail Guy', ['Kfal\'s Dude']],
    ['Flail Knight', ['Kfal\'s Knight']],
    ['Flying Plant', ['Obnoxious Turnip']],
    ['Beholder', ['Floating Eye']],
    ['Burt', ['Bert', 'Bort', 'Sorceror']],
    ['Mummy', ['Tornel Hugger']],
    ['Robot Sentry', ['C-3PO', 'T-1000', 'Johnny 5']],
    ['Robot Enforcer', ['ED-209', 'R2-D2', 'Agent Smith']],
    ['Robocopter', ['Cylon Drone', 'Megatron', 'Vision']],
    ['DYNA', ['GLaDOS', 'HAL-9000', 'Multivac']],
]);
export function misspell(rom, flags, random) {
    if (!flags.communityJokes())
        return;
    misspellItems(rom, flags, random);
    misspellCharacters(rom, random);
    misspellEnemies(rom, random);
}
function misspellItems(rom, flags, random) {
    if (flags.unidentifiedItems())
        return;
    if ('sphereAnalysis' in globalThis)
        return;
    const items = random.next() < 0.05 ? rom.items :
        [rom.items[random.nextInt(0x48)]];
    for (const item of items) {
        if (!item)
            continue;
        const newName = ITEMS.get(item.messageName) || [];
        const index = Math.floor(random.nextInt(3 * newName.length + 1) / 3);
        if (index < newName.length) {
            item.messageName = item.menuName = newName[index];
        }
        else if (item.messageName === item.menuName) {
            item.messageName = item.menuName = transpose(item.messageName, random);
        }
    }
}
function transpose(str, random) {
    const name = str.split('');
    const pos = random.nextInt(name.length - 1);
    if (name[pos] === ' ' || name[pos + 1] === ' ') {
        return str;
    }
    else if (name[pos].toUpperCase() === name[pos]) {
        name.splice(pos + 1, 1);
    }
    else {
        [name[pos], name[pos + 1]] = [name[pos + 1], name[pos]];
    }
    return name.join('');
}
function replaceCharacterName(rom, replaceFn) {
    for (const bank of rom.messages.parts) {
        for (const msg of bank) {
            msg.text = replaceFn(msg.text);
        }
    }
    rom.messages.personNames = rom.messages.personNames.map(replaceFn);
    replaceEnemyName(rom, replaceFn);
}
function replace(orig, newName) {
    return (text) => {
        if (!text.includes(orig))
            return text;
        return text.split(orig).join(newName);
    };
}
function replaceEnemyName(rom, replaceFn) {
    for (const obj of rom.objects) {
        if (obj.displayName)
            obj.displayName = replaceFn(obj.displayName);
    }
}
function misspellCharacters(rom, random) {
    const choices = [...CHARACTERS].flatMap(([k, vs]) => ['', ...vs, ...vs].map(v => [k, v]));
    const [orig, next] = random.pick(choices);
    const newName = next || transpose(orig, random);
    if (newName === orig)
        return;
    replaceCharacterName(rom, replace(orig, newName));
}
function misspellEnemies(rom, random) {
    for (let i = 0; i < 10; i++) {
        const [origName, choices] = random.pick([...MONSTERS]);
        const next = random.pick(['', ...choices, ...choices, ...choices]);
        const newName = next || transpose(origName, random);
        if (newName === origName)
            continue;
        replaceCharacterName(rom, replace(origName, newName));
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWlzc3BlbGwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvanMvcGFzcy9taXNzcGVsbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFJQSxNQUFNLEtBQUssR0FBa0MsSUFBSSxHQUFHLENBQUM7SUFDbkQsQ0FBQyxlQUFlLEVBQUUsQ0FBQyxjQUFjLEVBQUUsZUFBZSxFQUFFLGVBQWUsQ0FBQyxDQUFDO0lBQ3JFLENBQUMsZUFBZSxFQUFFLENBQUMsaUJBQWlCLENBQUMsQ0FBQztJQUN0QyxDQUFDLGdCQUFnQixFQUFFLENBQUMsaUJBQWlCLENBQUMsQ0FBQztJQUN2QyxDQUFDLGtCQUFrQixFQUFFLENBQUMsaUJBQWlCLENBQUMsQ0FBQztJQUN6QyxDQUFDLGdCQUFnQixFQUFFLENBQUMsZUFBZSxDQUFDLENBQUM7SUFDckMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDLGVBQWUsQ0FBQyxDQUFDO0lBQ3JDLENBQUMsZUFBZSxFQUFFLENBQUMsZUFBZSxDQUFDLENBQUM7SUFDcEMsQ0FBQyxjQUFjLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0lBQ3BDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0lBQ3RDLENBQUMsY0FBYyxFQUFFLENBQUMsZUFBZSxDQUFDLENBQUM7SUFDbkMsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxXQUFXLEVBQUUsV0FBVyxFQUFFLFVBQVUsRUFBRSxVQUFVLEVBQUUsVUFBVSxDQUFDLENBQUM7SUFDNUUsQ0FBQyxjQUFjLEVBQUUsQ0FBQyxjQUFjLENBQUMsQ0FBQztJQUNsQyxDQUFDLGFBQWEsRUFBRSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQ2hDLENBQUMsY0FBYyxFQUFFLENBQUMsV0FBVyxFQUFFLGFBQWEsQ0FBQyxDQUFDO0lBQzlDLENBQUMsZUFBZSxFQUFFLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztJQUNyQyxDQUFDLGVBQWUsRUFBRSxDQUFDLGdCQUFnQixDQUFD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RSxNQUFNLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDMUMsTUFBTSxPQUFPLEdBQUcsSUFBSSxJQUFJLFNBQVMsQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDaEQsSUFBSSxPQUFPLEtBQUssSUFBSTtRQUFFLE9BQU87SUFDN0Isb0JBQW9CLENBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQztBQUNwRCxDQUFDO0FBRUQsU0FBUyxlQUFlLENBQUMsR0FBUSxFQUFFLE1BQWM7SUFDL0MsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRTtRQUUzQixNQUFNLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLFFBQVEsQ0FBQyxDQUFDLENBQUM7UUFDdkQsTUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLE9BQU8sRUFBRSxHQUFHLE9BQU8sRUFBRSxHQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDbkUsTUFBTSxPQUFPLEdBQUcsSUFBSSxJQUFJLFNBQVMsQ0FBQyxRQUFRLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDcEQsSUFBSSxPQUFPLEtBQUssUUFBUTtZQUFFLFNBQVM7UUFDbkMsb0JBQW9CLENBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQztLQUN2RDtBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0ZsYWdTZXR9IGZyb20gJy4uL2ZsYWdzZXQuanMnO1xuaW1wb3J0IHtSYW5kb219IGZyb20gJy4uL3JhbmRvbS5qcyc7XG5pbXBvcnQge1JvbX0gZnJvbSAnLi4vcm9tLmpzJztcblxuY29uc3QgSVRFTVM6IFJlYWRvbmx5TWFwPHN0cmluZywgc3RyaW5nW10+ID0gbmV3IE1hcChbXG4gIFsnU3dvcmQgb2YgV2luZCcsIFsnU29yZCBvZiBXaW5kJywgJ1Nvd3JkIG9mIFdpbmQnLCAnU3dvcmQgb2YgV2llbiddXSxcbiAgWydTd29yZCBvZiBGaXJlJywgWydTd29yZCBvZiBGcmlyZXInXV0sXG4gIFsnU3dvcmQgb2YgV2F0ZXInLCBbJ0hvcmRlIG9mIE90dGVycyddXSxcbiAgWydTd29yZCBvZiBUaHVuZGVyJywgWydTb3JnIG9mIENodW5rZXInXV0sXG4gIFsnRmxhbWUgQnJhY2VsZXQnLCBbJ0ZhbWUgQnJhY2VsZXQnXV0sXG4gIFsnU3Rvcm0gQnJhY2VsZXQnLCBbJ1N0b20gQnJhY2VsZXQnXV0sXG4gIFsnU2FjcmVkIFNoaWVsZCcsIFsnU2NhcmVkIFNoaWVsZCddXSxcbiAgWydCb3cgb2YgVHJ1dGgnLCBbJ0JvdyBvZiBTdHJld3RoJ11dLFxuICBbJ1N0YXR1ZSBvZiBPbnl4JywgWydTdGF0dWUgb2YgT254eSddXSxcbiAgWydJdm9yeSBTdGF0dWUnLCBbJ0l2b3J5IFN0YXR1dGUnXV0sXG4gIFsnRm9nIExhbXAnLCBbJ0Zyb2cgTGFtcCcsICdTbW9nIExhbXAnLCAnRG9nIExhbXAnLCAnQm9nIExhbXAnLCAnRm9nIEx1bXAnXV0sXG4gIFsnR2xvd2luZyBMYW1wJywgWydHbG93aW5nIEx1bXAnXV0sXG4gIFsnS2V5IHRvIFN0eHknLCBbJ0tleSB0byBTdHl4J11dLFxuICBbJ0luc2VjdCBGbHV0ZScsIFsnQnVnIEZsdXRlJywgJ0J1ZyBXaGlzdGxlJ11dLFxuICBbJ0ZsdXRlIG9mIExpbWUnLCBbJ0ZsdXRlIG9mIEdyaW1lJ11dLFxuICBbJ0lyb24gTmVja2xhY2UnLCBbJ0kgUm9uIE5lY2tsYWNlJ11dLFxuICBbJ1NoaWVsZCBSaW5nJywgWydTaG8gUmluZyddXSxcbiAgWydEZW9cXCdzIFBlbmRhbnQnLCBbJ1JhYmJpdCBOZWNrbGFjZScsICdCdW5ueSBQZW5kYW50J11dLFxuICBbJ1NwZWVkIEJvb3RzJywgWydIZXJtZXMgU2FuZGFscyddXSxcbiAgWydSYWJiaXQgQm9vdHMnLCBbJ0Rlb1xcJ3MgQm9vdHMnLCAnSnVtcGluZyBCb290cycsICdSYWJpZCBCb290cyddXSxcbiAgWydBbGFybSBGbHV0ZScsIFsnUG9ja2V0IFJvb3N0ZXInLCAnQWxhcm0gQ2xvY2snXV0sXG4gIFsnU2hlbGwgRmx1dGUnLCBbJ0NvbmNoIFNoZWxsJywgJ0RvbHBoaW4gRmx1dGUnXV0sXG4gIFsnRXllIEdsYXNzZXMnLCBbJzNEIEdsYXNzZXMnLCAnWC1SYXkgR29nZ2xlcyddXSxcbiAgWydLaXJpc2EgUGxhbnQnLCBbJ0tpbGlrYSBQbGFudCddXSxcbiAgWydSZWZyZXNoJywgWydSZWZyZXNoZXJpemUnLCAnQ3VyZScsICdDdXJhJywgJ0N1cmFnYSddXSxcbiAgWydSZWNvdmVyJywgWydSZWNvdmVyaXplJywgJ0VzdW5hJ11dLFxuICBbJ1BhcmFseXNpcycsIFsnUGFyYWx5Y2l6ZScsICdTdG9wJywgJ1BldyBQZXcnXV0sXG4gIFsnVGVsZXBhdGh5JywgWydUZWxlcGF0aGl6ZScsICdDbGFpcnZveWFuY2UnLCAnRVNQJywgJ0hlYWQgVGFsayddXSxcbiAgWydUZWxlcG9ydCcsIFsnVGVsZXBvcnRhdGUnLCAnV2FycCcsICdHbyddXSxcbiAgWydDaGFuZ2UnLCBbJ0NoYW5nZWlmeScsICdUcmFuc2Zvcm0nLCAnRGlzZ3Vpc2UnXV0sXG4gIFsnQmFycmllcicsIFsnQmFycmllcml6ZScsICdQcm90ZWN0JywgJ1dhbGwnLCAnU2hpZWxkJ11dLFxuICBbJ0ZsaWdodCcsIFsnRmx5aWZ5JywgJ0JsaWdodCcsICdTdXBlciBKdW1wJ11dLFxuICBbJ0ZydWl0IG9mIExpbWUnLCBbJ0ZydWl0IG9mIENyaW1lJywgJ0dvbGQgTmVlZGxlJywgJ1NvZnQnXV0sXG4gIFsnTWVkaWNhbCBIZXJiJywgWydQb3Rpb24nLCAnSGkgUG90aW9uJ11dLFxuICBbJ0ZydWl0IG9mIFJlcHVuJywgWydBbnRpLVNsaW1lIFBpbGwnLCAnTWFpZGVuXFwncyBLaXNzJ11dLFxuXSk7XG5cbmNvbnN0IENIQVJBQ1RFUlM6IFJlYWRvbmx5TWFwPHN0cmluZywgc3RyaW5nW10+ID0gbmV3IE1hcChbXG4gIFsnQXJ5bGxpcycsIFsnTWltaWMgUXVlZW4nXV0sXG4gIFsnQWthaGFuYScsIFsnU3RldmUnLCAnSmVya2FoYW5hJywgJ01hc2hhbWFoYW5hJ11dLFxuICBbJ0FzaW5hJywgWydBdGhlbmEnLCAnSnJvd2luYSddXSxcbiAgWydBenRlY2EnLCBbJ1N0ZXZlJ11dLFxuICBbJ0NsYXJrJywgWydTdGV2ZScsICdGcmVkJywgJ01hdHRyaWNrJywgJ0NsYXJrdHJpY2snXV0sXG4gIFsnRGVvJywgWydTdGV2ZSddXSxcbiAgWydLZWxiZXNxdWUnLCBbJ0xpbmViYWNrZXInXV0sIC8vIE5PVEU6IGFsc28gY2hhbmdlIGluIGRpc3BsYXlOYW1lc1xuICBbJ0tlbnN1JywgWydTdGV2ZScsICdKZXJrc3UnXV0sXG4gIFsnS2FybWluZScsIFsnU2xpbWVsb3JkJ11dLFxuICBbJ05hZGFyZScsIFsnU3RldmUnXV0sXG4gIFsnTWFkbycsIFsnU3RldmUnXV0sXG4gIFsnUmFnZScsIFsnU3RldmUnXV0sXG4gIFsnU2FiZXJhJywgWydGbGFtZWxvcmQnXV0sXG4gIFsnU3RvbScsIFsnU3RldmUnXV0sXG4gIFsnVG9ybmVsJywgWydTdGV2ZSddXSxcbiAgWydaZWJ1JywgWydTdGV2ZScsICdQZXJ2eSBPbGQgTWFuJ11dLFxuXSk7XG5cbmNvbnN0IE1PTlNURVJTOiBSZWFkb25seU1hcDxzdHJpbmcsIHN0cmluZ1tdPiA9IG5ldyBNYXAoW1xuICBbJ1BvaXNvbiBTbGltZScsIFsnTWF0dHJpY2sgU2xpbWUnXV0sXG4gIFsnTXVkIEdvbGVtJywgWydCZWFyJ11dLFxuICBbJ0F4ZSBXZXJlYm9hcicsIFsnVGhlIEF4ZW1hbiddXSxcbiAgWydQaWxsYnVnJywgWydUb21hdG8nXV0sXG4gIFsnSWNlIEdvbGVtJywgWydQb2xhciBCZWFyJ11dLFxuICBbJ0ZsYWlsIEd1eScsIFsnS2ZhbFxcJ3MgRHVkZSddXSxcbiAgWydGbGFpbCBLbmlnaHQnLCBbJ0tmYWxcXCdzIEtuaWdodCddXSxcbiAgWydGbHlpbmcgUGxhbnQnLCBbJ09ibm94aW91cyBUdXJuaXAnXV0sXG4gIFsnQmVob2xkZXInLCBbJ0Zsb2F0aW5nIEV5ZSddXSxcbiAgWydCdXJ0JywgWydCZXJ0JywgJ0JvcnQnLCAnU29yY2Vyb3InXV0sXG4gIFsnTXVtbXknLCBbJ1Rvcm5lbCBIdWdnZXInXV0sXG4gIFsnUm9ib3QgU2VudHJ5JywgWydDLTNQTycsICdULTEwMDAnLCAnSm9obm55IDUnXV0sXG4gIFsnUm9ib3QgRW5mb3JjZXInLCBbJ0VELTIwOScsICdSMi1EMicsICdBZ2VudCBTbWl0aCddXSxcbiAgWydSb2JvY29wdGVyJywgWydDeWxvbiBEcm9uZScsICdNZWdhdHJvbicsICdWaXNpb24nXV0sXG4gIFsnRFlOQScsIFsnR0xhRE9TJywgJ0hBTC05MDAwJywgJ011bHRpdmFjJ11dLFxuXSk7XG5cbmV4cG9ydCBmdW5jdGlvbiBtaXNzcGVsbChyb206IFJvbSwgZmxhZ3M6IEZsYWdTZXQsIHJhbmRvbTogUmFuZG9tKSB7XG4gIGlmICghZmxhZ3MuY29tbXVuaXR5Sm9rZXMoKSkgcmV0dXJuO1xuICBtaXNzcGVsbEl0ZW1zKHJvbSwgZmxhZ3MsIHJhbmRvbSk7XG4gIG1pc3NwZWxsQ2hhcmFjdGVycyhyb20sIHJhbmRvbSk7XG4gIG1pc3NwZWxsRW5lbWllcyhyb20sIHJhbmRvbSk7XG59XG5cbmZ1bmN0aW9uIG1pc3NwZWxsSXRlbXMocm9tOiBSb20sIGZsYWdzOiBGbGFnU2V0LCByYW5kb206IFJhbmRvbSkge1xuICBpZiAoZmxhZ3MudW5pZGVudGlmaWVkSXRlbXMoKSkgcmV0dXJuO1xuICBpZiAoJ3NwaGVyZUFuYWx5c2lzJyBpbiBnbG9iYWxUaGlzKSByZXR1cm47IC8vIHNraXAgdGhpcyB3aGVuIGFuYWx5emluZ1xuICAvLyBQaWNrIGEgc2luZ2xlIGl0ZW0gdG8gbWlzc3BlbGwuICA1JSBjaGFuY2Ugb2YgbWlzc3BlbGxpbmcgX2V2ZXJ5dGhpbmdfLlxuXG4gIC8vIFRPRE86IE1heWJlIHN3YXAgaXZvcnkgc3RhdHVlIGZvciBmbHV0ZSBvZiByZXB1biwgYW5kIGluc2VjdFxuICAvLyBmbHV0ZSBmb3IgaW5zZWN0IGZpZ3VyaW5lIChvciBtYXliZSBtb3NxdWl0byBoZXJiKT8gIFNob3VsZCB3ZVxuICAvLyBvbmx5IGRvIHRoaXMgaWYgd2UncmUgbm90IHNodWZmbGluZyB0cmFkZS1pbnM/XG5cbiAgY29uc3QgaXRlbXMgPSByYW5kb20ubmV4dCgpIDwgMC4wNSA/IHJvbS5pdGVtcyA6XG4gICAgICBbcm9tLml0ZW1zW3JhbmRvbS5uZXh0SW50KDB4NDgpXV07XG4gIGZvciAoY29uc3QgaXRlbSBvZiBpdGVtcykge1xuICAgIGlmICghaXRlbSkgY29udGludWU7XG4gICAgY29uc3QgbmV3TmFtZSA9IElURU1TLmdldChpdGVtLm1lc3NhZ2VOYW1lKSB8fCBbXTtcbiAgICAvLyBVc2UgY3VzdG9tIG1pc3NwZWxsaW5nIDN4IG1vcmUgb2Z0ZW4gdGhhbiBhIHJhbmRvbSBvbmVcbiAgICBjb25zdCBpbmRleCA9IE1hdGguZmxvb3IocmFuZG9tLm5leHRJbnQoMyAqIG5ld05hbWUubGVuZ3RoICsgMSkgLyAzKTtcbiAgICBpZiAoaW5kZXggPCBuZXdOYW1lLmxlbmd0aCkge1xuICAgICAgLy8gVXNlIG9uZSBvZiB0aGUgY3VzdG9tIG1pc3NwZWxsaW5nc1xuICAgICAgaXRlbS5tZXNzYWdlTmFtZSA9IGl0ZW0ubWVudU5hbWUgPSBuZXdOYW1lW2luZGV4XTtcbiAgICB9IGVsc2UgaWYgKGl0ZW0ubWVzc2FnZU5hbWUgPT09IGl0ZW0ubWVudU5hbWUpIHtcbiAgICAgIC8vIE1ha2UgYSByYW5kb20gZXJyb3IgYnkgc3dhcHBpbmcgdHdvIGxldHRlcnMgb3IgZGVsZXRpbmcgb25lIGxldHRlci5cbiAgICAgIGl0ZW0ubWVzc2FnZU5hbWUgPSBpdGVtLm1lbnVOYW1lID0gdHJhbnNwb3NlKGl0ZW0ubWVzc2FnZU5hbWUsIHJhbmRvbSk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHRyYW5zcG9zZShzdHI6IHN0cmluZywgcmFuZG9tOiBSYW5kb20pOiBzdHJpbmcge1xuICBjb25zdCBuYW1lID0gc3RyLnNwbGl0KCcnKTtcbiAgY29uc3QgcG9zID0gcmFuZG9tLm5leHRJbnQobmFtZS5sZW5ndGggLSAxKTtcbiAgaWYgKG5hbWVbcG9zXSA9PT0gJyAnIHx8IG5hbWVbcG9zICsgMV0gPT09ICcgJykge1xuICAgIC8vIE5vdCBtdWNoIHdlIGNhbiBkbyB3aXRoIGEgc3BhY2UsIHNvIGp1c3QgZ2l2ZSB1cC5cbiAgICByZXR1cm4gc3RyO1xuICB9IGVsc2UgaWYgKG5hbWVbcG9zXS50b1VwcGVyQ2FzZSgpID09PSBuYW1lW3Bvc10pIHtcbiAgICAvLyBEb24ndCBzd2FwIHVwcGVyY2FzZSBsZXR0ZXJzIHdpdGggdGhlIG9uZSBhZnRlcjogaW5zdGVhZCBkZWxldGUgbmV4dFxuICAgIG5hbWUuc3BsaWNlKHBvcyArIDEsIDEpO1xuICB9IGVsc2Uge1xuICAgIC8vIFN3YXAgdHdvIGFkamFjZW50IGxldHRlcnNcbiAgICBbbmFtZVtwb3NdLCBuYW1lW3BvcyArIDFdXSA9IFtuYW1lW3BvcyArIDFdLCBuYW1lW3Bvc11dO1xuICB9XG4gIHJldHVybiBuYW1lLmpvaW4oJycpO1xufVxuXG4vLyBUT0RPIC0gdXBkYXRlIHR5cGVzY3JpcHQgdmVyc2lvbi9jb25maWdcbmRlY2xhcmUgZ2xvYmFsIHtcbiAgaW50ZXJmYWNlIEFycmF5PFQ+IHtcbiAgICBmbGF0TWFwPFY+KGNiOiAodmFsdWU6IFQsIGluZGV4OiBudW1iZXIpID0+IHJlYWRvbmx5IFZbXSk6IFZbXTtcbiAgfVxufVxuXG50eXBlIFJlcGxhY2VGbiA9IChhcmc6IHN0cmluZykgPT4gc3RyaW5nO1xuZnVuY3Rpb24gcmVwbGFjZUNoYXJhY3Rlck5hbWUocm9tOiBSb20sIHJlcGxhY2VGbjogUmVwbGFjZUZuKSB7XG4gIGZvciAoY29uc3QgYmFuayBvZiByb20ubWVzc2FnZXMucGFydHMpIHtcbiAgICBmb3IgKGNvbnN0IG1zZyBvZiBiYW5rKSB7XG4gICAgICBtc2cudGV4dCA9IHJlcGxhY2VGbihtc2cudGV4dCk7XG4gICAgfVxuICB9XG4gIHJvbS5tZXNzYWdlcy5wZXJzb25OYW1lcyA9IHJvbS5tZXNzYWdlcy5wZXJzb25OYW1lcy5tYXAocmVwbGFjZUZuKTtcbiAgcmVwbGFjZUVuZW15TmFtZShyb20sIHJlcGxhY2VGbik7XG59XG5cbmZ1bmN0aW9uIHJlcGxhY2Uob3JpZzogc3RyaW5nLCBuZXdOYW1lOiBzdHJpbmcpOiBSZXBsYWNlRm4ge1xuICByZXR1cm4gKHRleHQ6IHN0cmluZykgPT4ge1xuICAgIGlmICghdGV4dC5pbmNsdWRlcyhvcmlnKSkgcmV0dXJuIHRleHQ7XG4gICAgcmV0dXJuIHRleHQuc3BsaXQob3JpZykuam9pbihuZXdOYW1lKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gcmVwbGFjZUVuZW15TmFtZShyb206IFJvbSwgcmVwbGFjZUZuOiBSZXBsYWNlRm4pIHtcbiAgZm9yIChjb25zdCBvYmogb2Ygcm9tLm9iamVjdHMpIHtcbiAgICBpZiAob2JqLmRpc3BsYXlOYW1lKSBvYmouZGlzcGxheU5hbWUgPSByZXBsYWNlRm4ob2JqLmRpc3BsYXlOYW1lKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBtaXNzcGVsbENoYXJhY3RlcnMocm9tOiBSb20sIHJhbmRvbTogUmFuZG9tKSB7XG4gIC8vIEZsYXR0ZW4gdGhlIG1hcCBzbyB0aGF0IGNoYXJhY3RlcnMgd2l0aCBtb3JlIG9wdGlvbnMgZ2V0XG4gIC8vIG92ZXJyZXByZXNlbnRlZC4gIEFsc28gYWRkIGEgXCJyYW5kb20gdHJhbnNwb3NpdGlvblwiIG9wdGlvbi5cbiAgY29uc3QgY2hvaWNlczogW3N0cmluZywgc3RyaW5nXVtdID1cbiAgICAgIFsuLi5DSEFSQUNURVJTXS5mbGF0TWFwKChbaywgdnNdKSA9PiBbJycsIC4uLnZzLCAuLi52c10ubWFwKHYgPT4gW2ssIHZdKSk7XG4gIGNvbnN0IFtvcmlnLCBuZXh0XSA9IHJhbmRvbS5waWNrKGNob2ljZXMpO1xuICBjb25zdCBuZXdOYW1lID0gbmV4dCB8fCB0cmFuc3Bvc2Uob3JpZywgcmFuZG9tKTtcbiAgaWYgKG5ld05hbWUgPT09IG9yaWcpIHJldHVybjtcbiAgcmVwbGFjZUNoYXJhY3Rlck5hbWUocm9tLCByZXBsYWNlKG9yaWcsIG5ld05hbWUpKTtcbn1cblxuZnVuY3Rpb24gbWlzc3BlbGxFbmVtaWVzKHJvbTogUm9tLCByYW5kb206IFJhbmRvbSkge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAvLyBQaWNrIGFuIGVuZW15IGZpcnN0XG4gICAgY29uc3QgW29yaWdOYW1lLCBjaG9pY2VzXSA9IHJhbmRvbS5waWNrKFsuLi5NT05TVEVSU10pO1xuICAgIGNvbnN0IG5leHQgPSByYW5kb20ucGljayhbJycsIC4uLmNob2ljZXMsIC4uLmNob2ljZXMsIC4uLmNob2ljZXNdKTtcbiAgICBjb25zdCBuZXdOYW1lID0gbmV4dCB8fCB0cmFuc3Bvc2Uob3JpZ05hbWUsIHJhbmRvbSk7XG4gICAgaWYgKG5ld05hbWUgPT09IG9yaWdOYW1lKSBjb250aW51ZTtcbiAgICByZXBsYWNlQ2hhcmFjdGVyTmFtZShyb20sIHJlcGxhY2Uob3JpZ05hbWUsIG5ld05hbWUpKTtcbiAgfVxufVxuXG4vLyBUT0RPOiBtaXNzcGVsbCBtb25zdGVycyAoZS5nLiBmbGFpbHMgLT4ga2ZhbCdzIHBlb3BsZSlcbi8vIFRPRE86IHJlbmFtZSBjaGFyYWN0ZXJzIChlLmcuIHRvIFN0ZXZlKVxuIl19