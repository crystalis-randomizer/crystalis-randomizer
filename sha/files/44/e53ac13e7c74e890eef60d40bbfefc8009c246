import{a as P}from"./chunk-3BY7ATHC.js";import{a as S}from"./chunk-H553SJBW.js";import"./chunk-YWD7IXCK.js";import{b as x,k as C,l as b}from"./chunk-VPOH3XOT.js";import"./chunk-PIDEUWOP.js";b();window.show=function(o){console.log(Array.from({length:15},(e,r)=>o.slice(16*r,16*r+16).map(a=>a.toString(16).padStart(2,0)).join(" ")).join(`
`))};function k(...o){let e=0;for(let r=0;r<o.length;r++)e*=256,e+=o[r];return e}function p(o,e,r=document.body){let a=document.createElement(o);return e&&(a.textContent=e),r.appendChild(a),a}var A=async()=>{let o=await S(),e=new P(o,256,256),r=[],a=new x(()=>new Map);for(let t of o.locations)!t||!t.used||a.get(t.meta.tileset).set(k(...t.tilePatterns,...t.tilePalettes),t);for(let t of o.metatilesets){p("h1",`Tileset ${u(t.tilesetId)} ${t.name}`);let n=p("div");n.style.display="none";let{tileset:s}=t;for(let g of t){p("h2",`Screen ${C(g.sid,3)} ${g.name}`,n);let{screen:w}=g,E=p("div","",n);for(let c of a.get(t).values()){let h=0;for(let f=0;f===h;f++){e.clear(c.tilePalettes[0]);for(let d=0;d<15;d++)for(let m=0;m<16;m++){let l=w.tiles[d<<4|m];l<32&&l!=s.alternates[l]&&(h=1,f&&(l=s.alternates[l])),e.metatile(m<<4,d<<4,l,c.id)}e.text(0,240,`PAT ${Array.from(c.tilePatterns,u).join(" ")} PAL ${Array.from(c.tilePalettes,u).join(" ")} ${f?"*":""}`),e.render();let v=document.createElement("img");v.src=e.toDataUrl(),E.appendChild(v)}}}}document.body.addEventListener("mousemove",t=>{if(t.target.tagName.toLowerCase()!=="img")return;let n=t.offsetX>>>4&15,s=t.offsetY>>>4&15;document.getElementById("coord").textContent=s.toString(16)+n.toString(16)}),document.body.addEventListener("click",t=>{if(t.target.tagName!=="H1")return;let n=t.target.nextElementSibling;n.style.display==="none"?n.style.display="block":n.style.display="none"});let y=0;for(let t=e.patternCoverage.length-1;t>=0;t--)if(e.patternCoverage[t]){y=t>>>7<<1;break}let i=[],$=y+1<<6;for(let t=0;t<$;t++)e.patternCoverage[t]||(i[t>>>7]||(i[t>>>7]=[]),i[t>>>7].push(t&127));for(let t=0;t<i.length;t++){let n=document.createElement("div");if(n.textContent=`Unused Pat ${(t<<1).toString(16).padStart(2,0)}:`,document.body.appendChild(n),!!i[t])for(let s of i[t])n.textContent+=` ${s.toString(16).padStart(2,0)}`}},u=o=>o.toString(16).padStart(2,0);A();
